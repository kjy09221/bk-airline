!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.NAVER_MOBILE_VIEWER=n():t.NAVER_MOBILE_VIEWER=n()}(this,function(){return function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="../../dist/",n(n.s=34)}([function(t,n,e){(function(i){var o,r;!function(a){var s="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i;o=[e(26),e(1),n],void 0!==(r=function(t,n,e){s.Backbone=a(s,e,t,n)}.apply(n,o))&&(t.exports=r)}(function(t,n,e,i){var o=t.Backbone,r=Array.prototype.slice;n.VERSION="1.4.0",n.$=i,n.noConflict=function(){return t.Backbone=o,this},n.emulateHTTP=!1,n.emulateJSON=!1;var a,s=n.Events={},l=/\s+/,c=function(t,n,i,o,r){var a,s=0;if(i&&"object"==typeof i){void 0!==o&&"context"in r&&void 0===r.context&&(r.context=o);for(a=e.keys(i);s<a.length;s++)n=c(t,n,a[s],i[a[s]],r)}else if(i&&l.test(i))for(a=i.split(l);s<a.length;s++)n=t(n,a[s],o,r);else n=t(n,i,o,r);return n};s.on=function(t,n,e){if(this._events=c(h,this._events||{},t,n,{context:e,ctx:this,listening:a}),a){(this._listeners||(this._listeners={}))[a.id]=a,a.interop=!1}return this},s.listenTo=function(t,n,i){if(!t)return this;var o=t._listenId||(t._listenId=e.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),s=a=r[o];s||(this._listenId||(this._listenId=e.uniqueId("l")),s=a=r[o]=new g(this,t));var l=u(t,n,i,this);if(a=void 0,l)throw l;return s.interop&&s.on(n,i),this};var h=function(t,n,e,i){if(e){var o=t[n]||(t[n]=[]),r=i.context,a=i.ctx,s=i.listening;s&&s.count++,o.push({callback:e,context:r,ctx:r||a,listening:s})}return t},u=function(t,n,e,i){try{t.on(n,e,i)}catch(t){return t}};s.off=function(t,n,e){return this._events?(this._events=c(d,this._events,t,n,{context:e,listeners:this._listeners}),this):this},s.stopListening=function(t,n,i){var o=this._listeningTo;if(!o)return this;for(var r=t?[t._listenId]:e.keys(o),a=0;a<r.length;a++){var s=o[r[a]];if(!s)break;s.obj.off(n,i,this),s.interop&&s.off(n,i)}return e.isEmpty(o)&&(this._listeningTo=void 0),this};var d=function(t,n,i,o){if(t){var r,a=o.context,s=o.listeners,l=0;if(n||a||i){for(r=n?[n]:e.keys(t);l<r.length;l++){n=r[l];var c=t[n];if(!c)break;for(var h=[],u=0;u<c.length;u++){var d=c[u];if(i&&i!==d.callback&&i!==d.callback._callback||a&&a!==d.context)h.push(d);else{var f=d.listening;f&&f.off(n,i)}}h.length?t[n]=h:delete t[n]}return t}for(r=e.keys(s);l<r.length;l++)s[r[l]].cleanup()}};s.once=function(t,n,e){var i=c(f,{},t,n,this.off.bind(this));return"string"==typeof t&&null==e&&(n=void 0),this.on(i,n,e)},s.listenToOnce=function(t,n,e){var i=c(f,{},n,e,this.stopListening.bind(this,t));return this.listenTo(t,i)};var f=function(t,n,i,o){if(i){var r=t[n]=e.once(function(){o(n,r),i.apply(this,arguments)});r._callback=i}return t};s.trigger=function(t){if(!this._events)return this;for(var n=Math.max(0,arguments.length-1),e=Array(n),i=0;i<n;i++)e[i]=arguments[i+1];return c(p,this._events,t,void 0,e),this};var p=function(t,n,e,i){if(t){var o=t[n],r=t.all;o&&r&&(r=r.slice()),o&&m(o,i),r&&m(r,[n].concat(i))}return t},m=function(t,n){var e,i=-1,o=t.length,r=n[0],a=n[1],s=n[2];switch(n.length){case 0:for(;++i<o;)(e=t[i]).callback.call(e.ctx);return;case 1:for(;++i<o;)(e=t[i]).callback.call(e.ctx,r);return;case 2:for(;++i<o;)(e=t[i]).callback.call(e.ctx,r,a);return;case 3:for(;++i<o;)(e=t[i]).callback.call(e.ctx,r,a,s);return;default:for(;++i<o;)(e=t[i]).callback.apply(e.ctx,n);return}},g=function(t,n){this.id=t._listenId,this.listener=t,this.obj=n,this.interop=!0,this.count=0,this._events=void 0};g.prototype.on=s.on,g.prototype.off=function(t,n){var e;this.interop?(this._events=c(d,this._events,t,n,{context:void 0,listeners:void 0}),e=!this._events):(this.count--,e=0===this.count),e&&this.cleanup()},g.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},s.bind=s.on,s.unbind=s.off,e.extend(n,s);var v=n.Model=function(t,n){var i=t||{};n||(n={}),this.preinitialize.apply(this,arguments),this.cid=e.uniqueId(this.cidPrefix),this.attributes={},n.collection&&(this.collection=n.collection),n.parse&&(i=this.parse(i,n)||{});var o=e.result(this,"defaults");i=e.defaults(e.extend({},o,i),o),this.set(i,n),this.changed={},this.initialize.apply(this,arguments)};e.extend(v.prototype,s,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return e.clone(this.attributes)},sync:function(){return n.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return e.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!e.iteratee(t,this)(this.attributes)},set:function(t,n,i){if(null==t)return this;var o;if("object"==typeof t?(o=t,i=n):(o={})[t]=n,i||(i={}),!this._validate(o,i))return!1;var r=i.unset,a=i.silent,s=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=e.clone(this.attributes),this.changed={});var c=this.attributes,h=this.changed,u=this._previousAttributes;for(var d in o)n=o[d],e.isEqual(c[d],n)||s.push(d),e.isEqual(u[d],n)?delete h[d]:h[d]=n,r?delete c[d]:c[d]=n;if(this.idAttribute in o&&(this.id=this.get(this.idAttribute)),!a){s.length&&(this._pending=i);for(var f=0;f<s.length;f++)this.trigger("change:"+s[f],this,c[s[f]],i)}if(l)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,n){return this.set(t,void 0,e.extend({},n,{unset:!0}))},clear:function(t){var n={};for(var i in this.attributes)n[i]=void 0;return this.set(n,e.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!e.isEmpty(this.changed):e.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&e.clone(this.changed);var n,i=this._changing?this._previousAttributes:this.attributes,o={};for(var r in t){var a=t[r];e.isEqual(i[r],a)||(o[r]=a,n=!0)}return!!n&&o},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return e.clone(this._previousAttributes)},fetch:function(t){t=e.extend({parse:!0},t);var n=this,i=t.success;return t.success=function(e){var o=t.parse?n.parse(e,t):e;if(!n.set(o,t))return!1;i&&i.call(t.context,n,e,t),n.trigger("sync",n,e,t)},G(this,t),this.sync("read",this,t)},save:function(t,n,i){var o;null==t||"object"==typeof t?(o=t,i=n):(o={})[t]=n,i=e.extend({validate:!0,parse:!0},i);var r=i.wait;if(o&&!r){if(!this.set(o,i))return!1}else if(!this._validate(o,i))return!1;var a=this,s=i.success,l=this.attributes;i.success=function(t){a.attributes=l;var n=i.parse?a.parse(t,i):t;if(r&&(n=e.extend({},o,n)),n&&!a.set(n,i))return!1;s&&s.call(i.context,a,t,i),a.trigger("sync",a,t,i)},G(this,i),o&&r&&(this.attributes=e.extend({},l,o));var c=this.isNew()?"create":i.patch?"patch":"update";"patch"!==c||i.attrs||(i.attrs=o);var h=this.sync(c,this,i);return this.attributes=l,h},destroy:function(t){t=t?e.clone(t):{};var n=this,i=t.success,o=t.wait,r=function(){n.stopListening(),n.trigger("destroy",n,n.collection,t)};t.success=function(e){o&&r(),i&&i.call(t.context,n,e,t),n.isNew()||n.trigger("sync",n,e,t)};var a=!1;return this.isNew()?e.defer(t.success):(G(this,t),a=this.sync("delete",this,t)),o||r(),a},url:function(){var t=e.result(this,"urlRoot")||e.result(this.collection,"url")||Y();if(this.isNew())return t;var n=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(n)},parse:function(t,n){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},e.extend({},t,{validate:!0}))},_validate:function(t,n){if(!n.validate||!this.validate)return!0;t=e.extend({},this.attributes,t);var i=this.validationError=this.validate(t,n)||null;return!i||(this.trigger("invalid",this,i,e.extend(n,{validationError:i})),!1)}});var w=n.Collection=function(t,n){n||(n={}),this.preinitialize.apply(this,arguments),n.model&&(this.model=n.model),void 0!==n.comparator&&(this.comparator=n.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,e.extend({silent:!0},n))},_={add:!0,remove:!0,merge:!0},b={add:!0,remove:!1},x=function(t,n,e){e=Math.min(Math.max(e,0),t.length);var i,o=Array(t.length-e),r=n.length;for(i=0;i<o.length;i++)o[i]=t[i+e];for(i=0;i<r;i++)t[i+e]=n[i];for(i=0;i<o.length;i++)t[i+r+e]=o[i]};e.extend(w.prototype,s,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map(function(n){return n.toJSON(t)})},sync:function(){return n.sync.apply(this,arguments)},add:function(t,n){return this.set(t,e.extend({merge:!1},n,b))},remove:function(t,n){n=e.extend({},n);var i=!e.isArray(t);t=i?[t]:t.slice();var o=this._removeModels(t,n);return!n.silent&&o.length&&(n.changes={added:[],merged:[],removed:o},this.trigger("update",this,n)),i?o[0]:o},set:function(t,n){if(null!=t){n=e.extend({},_,n),n.parse&&!this._isModel(t)&&(t=this.parse(t,n)||[]);var i=!e.isArray(t);t=i?[t]:t.slice();var o=n.at;null!=o&&(o=+o),o>this.length&&(o=this.length),o<0&&(o+=this.length+1);var r,a,s=[],l=[],c=[],h=[],u={},d=n.add,f=n.merge,p=n.remove,m=!1,g=this.comparator&&null==o&&!1!==n.sort,v=e.isString(this.comparator)?this.comparator:null;for(a=0;a<t.length;a++){r=t[a];var w=this.get(r);if(w){if(f&&r!==w){var b=this._isModel(r)?r.attributes:r;n.parse&&(b=w.parse(b,n)),w.set(b,n),c.push(w),g&&!m&&(m=w.hasChanged(v))}u[w.cid]||(u[w.cid]=!0,s.push(w)),t[a]=w}else d&&(r=t[a]=this._prepareModel(r,n))&&(l.push(r),this._addReference(r,n),u[r.cid]=!0,s.push(r))}if(p){for(a=0;a<this.length;a++)r=this.models[a],u[r.cid]||h.push(r);h.length&&this._removeModels(h,n)}var y=!1,E=!g&&d&&p;if(s.length&&E?(y=this.length!==s.length||e.some(this.models,function(t,n){return t!==s[n]}),this.models.length=0,x(this.models,s,0),this.length=this.models.length):l.length&&(g&&(m=!0),x(this.models,l,null==o?this.length:o),this.length=this.models.length),m&&this.sort({silent:!0}),!n.silent){for(a=0;a<l.length;a++)null!=o&&(n.index=o+a),r=l[a],r.trigger("add",r,this,n);(m||y)&&this.trigger("sort",this,n),(l.length||h.length||c.length)&&(n.changes={added:l,removed:h,merged:c},this.trigger("update",this,n))}return i?t[0]:t}},reset:function(t,n){n=n?e.clone(n):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],n);return n.previousModels=this.models,this._reset(),t=this.add(t,e.extend({silent:!0},n)),n.silent||this.trigger("reset",this,n),t},push:function(t,n){return this.add(t,e.extend({at:this.length},n))},pop:function(t){var n=this.at(this.length-1);return this.remove(n,t)},unshift:function(t,n){return this.add(t,e.extend({at:0},n))},shift:function(t){var n=this.at(0);return this.remove(n,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,n){return this[n?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var n=this.comparator;if(!n)throw new Error("Cannot sort a set without a comparator");t||(t={});var i=n.length;return e.isFunction(n)&&(n=n.bind(this)),1===i||e.isString(n)?this.models=this.sortBy(n):this.models.sort(n),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){t=e.extend({parse:!0},t);var n=t.success,i=this;return t.success=function(e){var o=t.reset?"reset":"set";i[o](e,t),n&&n.call(t.context,i,e,t),i.trigger("sync",i,e,t)},G(this,t),this.sync("read",this,t)},create:function(t,n){n=n?e.clone(n):{};var i=n.wait;if(!(t=this._prepareModel(t,n)))return!1;i||this.add(t,n);var o=this,r=n.success;return n.success=function(t,n,e){i&&o.add(t,e),r&&r.call(e.context,t,n,e)},t.save(null,n),t},parse:function(t,n){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new E(this,A)},keys:function(){return new E(this,S)},entries:function(){return new E(this,C)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,n){if(this._isModel(t))return t.collection||(t.collection=this),t;n=n?e.clone(n):{},n.collection=this;var i=new this.model(t,n);return i.validationError?(this.trigger("invalid",this,i.validationError,n),!1):i},_removeModels:function(t,n){for(var e=[],i=0;i<t.length;i++){var o=this.get(t[i]);if(o){var r=this.indexOf(o);this.models.splice(r,1),this.length--,delete this._byId[o.cid];var a=this.modelId(o.attributes);null!=a&&delete this._byId[a],n.silent||(n.index=r,o.trigger("remove",o,this,n)),e.push(o),this._removeReference(o,n)}}return e},_isModel:function(t){return t instanceof v},_addReference:function(t,n){this._byId[t.cid]=t;var e=this.modelId(t.attributes);null!=e&&(this._byId[e]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,n){delete this._byId[t.cid];var e=this.modelId(t.attributes);null!=e&&delete this._byId[e],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,n,e,i){if(n){if(("add"===t||"remove"===t)&&e!==this)return;if("destroy"===t&&this.remove(n,i),"change"===t){var o=this.modelId(n.previousAttributes()),r=this.modelId(n.attributes);o!==r&&(null!=o&&delete this._byId[o],null!=r&&(this._byId[r]=n))}}this.trigger.apply(this,arguments)}});var y="function"==typeof Symbol&&Symbol.iterator;y&&(w.prototype[y]=w.prototype.values);var E=function(t,n){this._collection=t,this._kind=n,this._index=0},A=1,S=2,C=3;y&&(E.prototype[y]=function(){return this}),E.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t=this._collection.at(this._index);this._index++;var n;if(this._kind===A)n=t;else{var e=this._collection.modelId(t.attributes);n=this._kind===S?e:[e,t]}return{value:n,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var T=n.View=function(t){this.cid=e.uniqueId("view"),this.preinitialize.apply(this,arguments),e.extend(this,e.pick(t,R)),this._ensureElement(),this.initialize.apply(this,arguments)},O=/^(\S+)\s*(.*)$/,R=["model","collection","el","id","attributes","className","tagName","events"];e.extend(T.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof n.$?t:n.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=e.result(this,"events")),!t)return this;this.undelegateEvents();for(var n in t){var i=t[n];if(e.isFunction(i)||(i=this[i]),i){var o=n.match(O);this.delegate(o[1],o[2],i.bind(this))}}return this},delegate:function(t,n,e){return this.$el.on(t+".delegateEvents"+this.cid,n,e),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,n,e){return this.$el.off(t+".delegateEvents"+this.cid,n,e),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(e.result(this,"el"));else{var t=e.extend({},e.result(this,"attributes"));this.id&&(t.id=e.result(this,"id")),this.className&&(t.class=e.result(this,"className")),this.setElement(this._createElement(e.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var M=function(t,n,e,i){switch(n){case 1:return function(){return t[e](this[i])};case 2:return function(n){return t[e](this[i],n)};case 3:return function(n,o){return t[e](this[i],I(n,this),o)};case 4:return function(n,o,r){return t[e](this[i],I(n,this),o,r)};default:return function(){var n=r.call(arguments);return n.unshift(this[i]),t[e].apply(t,n)}}},P=function(t,n,i,o){e.each(i,function(e,i){n[i]&&(t.prototype[i]=M(n,e,i,o))})},I=function(t,n){return e.isFunction(t)?t:e.isObject(t)&&!n._isModel(t)?V(t):e.isString(t)?function(n){return n.get(t)}:t},V=function(t){var n=e.matches(t);return function(t){return n(t.attributes)}},N={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},z={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};e.each([[w,N,"models"],[v,z,"attributes"]],function(t){var n=t[0],i=t[1],o=t[2];n.mixin=function(t){var i=e.reduce(e.functions(t),function(t,n){return t[n]=0,t},{});P(n,t,i,o)},P(n,e,i,o)}),n.sync=function(t,i,o){var r=q[t];e.defaults(o||(o={}),{emulateHTTP:n.emulateHTTP,emulateJSON:n.emulateJSON});var a={type:r,dataType:"json"};if(o.url||(a.url=e.result(i,"url")||Y()),null!=o.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(o.attrs||i.toJSON(o))),o.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",o.emulateJSON&&(a.data._method=r);var s=o.beforeSend;o.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),s)return s.apply(this,arguments)}}"GET"===a.type||o.emulateJSON||(a.processData=!1);var l=o.error;o.error=function(t,n,e){o.textStatus=n,o.errorThrown=e,l&&l.call(o.context,t,n,e)};var c=o.xhr=n.ajax(e.extend(a,o));return i.trigger("request",i,c,o),c};var q={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};n.ajax=function(){return n.$.ajax.apply(n.$,arguments)};var F=n.Router=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},L=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,D=/\*\w+/g,U=/[\-{}\[\]+?.,\\\^$|#\s]/g;e.extend(F.prototype,s,{preinitialize:function(){},initialize:function(){},route:function(t,i,o){e.isRegExp(t)||(t=this._routeToRegExp(t)),e.isFunction(i)&&(o=i,i=""),o||(o=this[i]);var r=this;return n.history.route(t,function(e){var a=r._extractParameters(t,e);!1!==r.execute(o,a,i)&&(r.trigger.apply(r,["route:"+i].concat(a)),r.trigger("route",i,a),n.history.trigger("route",r,i,a))}),this},execute:function(t,n,e){t&&t.apply(this,n)},navigate:function(t,e){return n.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=e.result(this,"routes");for(var t,n=e.keys(this.routes);null!=(t=n.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(U,"\\$&").replace(L,"(?:$1)?").replace(k,function(t,n){return n?t:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,n){var i=t.exec(n).slice(1);return e.map(i,function(t,n){return n===i.length-1?t||null:t?decodeURIComponent(t):null})}});var j=n.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,W=/^\/+|\/+$/g,H=/#.*$/;j.started=!1,e.extend(j.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var n=(t||this).location.href.match(/#(.*)$/);return n?n[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(B,"")},start:function(t){if(j.started)throw new Error("Backbone.history has already been started");if(j.started=!0,this.options=e.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(W,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var n=this.root.slice(0,-1)||"/";return this.location.replace(n+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,o=i.insertBefore(this.iframe,i.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,n){return attachEvent("on"+t,n)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,n){return detachEvent("on"+t,n)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),j.started=!1},route:function(t,n){this.handlers.unshift({route:t,callback:n})},checkUrl:function(t){var n=this.getFragment();if(n===this.fragment&&this.iframe&&(n=this.getHash(this.iframe.contentWindow)),n===this.fragment)return!1;this.iframe&&this.navigate(n),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),e.some(this.handlers,function(n){if(n.route.test(t))return n.callback(t),!0}))},navigate:function(t,n){if(!j.started)return!1;n&&!0!==n||(n={trigger:!!n}),t=this.getFragment(t||"");var e=this.root;""!==t&&"?"!==t.charAt(0)||(e=e.slice(0,-1)||"/");var i=e+t;t=t.replace(H,"");var o=this.decodeFragment(t);if(this.fragment!==o){if(this.fragment=o,this._usePushState)this.history[n.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,n.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;n.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,n.replace)}}return n.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,n,e){if(e){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+n)}else t.hash="#"+n}}),n.history=new j;var Q=function(t,n){var i,o=this;return i=t&&e.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},e.extend(i,o,n),i.prototype=e.create(o.prototype,t),i.prototype.constructor=i,i.__super__=o.prototype,i};v.extend=w.extend=F.extend=T.extend=j.extend=Q;var Y=function(){throw new Error('A "url" property or function must be specified')},G=function(t,n){var e=n.error;n.error=function(i){e&&e.call(n.context,t,i,n),t.trigger("error",t,i,n)}};return n})}).call(n,e(5))},function(t,n){function e(){function t(n,e){return new t.fn.init(n,e)}window.jQuery.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(e,i){var o=window.jQuery.fn.init.call(this,e,i,n);return o instanceof t?o:t(o)},t.fn.init.prototype=t.fn;var n=t(document);return t}t.exports=e.call(window.jQuery)},function(t,n,e){/*!
 * Copyright (c) 2017 NAVER Corp.
 * @egjs/rotate project is licensed under the MIT <https://naver.github.io/egjs/license.txt> license
 * 
 * @egjs/rotate JavaScript library
 * https://github.com/naver/egjs-rotate
 * 
 * @version 2.1.0
 */
!function(n,e){t.exports=e()}(window,function(){return function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=0)}([function(t,n,e){"use strict";var i=e(1),o=function(t){return t&&t.__esModule?t:{default:t}}(i);o.default.VERSION="2.1.0",t.exports=o.default},function(t,n,e){"use strict";n.__esModule=!0;var i=e(2);n.default=function(){function t(){var t=void 0,n=void 0,e=void 0;return"resize"===h?(t=i.document.documentElement.clientWidth,e=-1===o?t<i.document.documentElement.clientHeight:t<o||t===o&&r):(n=i.window.orientation,0===n||180===n?e=!0:90!==n&&-90!==n||(e=!1)),e}function n(n){var e=t();l&&r!==e&&(r=e,o=i.document.documentElement.clientWidth,a.forEach(function(t){return t(n,{isVertical:r})}))}function e(t){var r=null;if("resize"===h)i.window.setTimeout(function(){return n(t)},0);else{if("android"===s.os){var a=i.document.documentElement.clientWidth;if("orientationchange"===t.type&&a===o)return i.window.setTimeout(function(){return e(t)},500),!1}r&&i.window.clearTimeout(r),r=i.window.setTimeout(function(){return n(t)},300)}}var o=-1,r=null,a=[],s=function(){var t=i.window.navigator.userAgent,n=t.match(/(iPhone OS|CPU OS|Android)\s([^\s;-]+)/),e={os:"",version:"",ua:t};return n&&(e.os=n[1].replace(/(?:CPU|iPhone)\sOS/,"ios").toLowerCase(),e.version=n[2].replace(/\D/g,".")),e}(),l=/android|ios/.test(s.os)||/Mobi/.test(s.ua);if(!l){var c=function(){return!1};return{on:c,off:c,isVertical:c}}var h=function(){return"android"===s.os&&"2.1"===s.version?"resize":"onorientationchange"in i.window?"orientationchange":"resize"}();return{on:function(n){"function"==typeof n&&(r=t(),o=i.document.documentElement.clientWidth,a.push(n),1===a.length&&i.window.addEventListener(h,e))},off:function(t){if("function"==typeof t)for(var n,o=0;n=a[o];o++)if(n===t){a.splice(o,1);break}t&&0!==a.length||(a.splice(0),i.window.removeEventListener(h,e))},orientationChange:h,isVertical:t,triggerRotate:n,handler:e}}(),t.exports=n.default},function(t,n,e){"use strict";n.__esModule=!0;var i="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")(),o=i.document;n.window=i,n.document=o}])})},function(t,n){function e(t,n){var e=t[1]||"",o=t[3];if(!o)return e;if(n&&"function"==typeof btoa){var r=i(o);return[e].concat(o.sources.map(function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"})).concat([r]).join("\n")}return[e].join("\n")}function i(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var n=[];return n.toString=function(){return this.map(function(n){var i=e(n,t);return n[2]?"@media "+n[2]+"{"+i+"}":i}).join("")},n.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(i[r]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&i[a[0]]||(e&&!a[2]?a[2]=e:e&&(a[2]="("+a[2]+") and ("+e+")"),n.push(a))}},n}},function(t,n,e){function i(t,n){for(var e=0;e<t.length;e++){var i=t[e],o=p[i.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(h(i.parts[r],n))}else{for(var a=[],r=0;r<i.parts.length;r++)a.push(h(i.parts[r],n));p[i.id]={id:i.id,refs:1,parts:a}}}}function o(t){for(var n=[],e={},i=0;i<t.length;i++){var o=t[i],r=o[0],a=o[1],s=o[2],l=o[3],c={css:a,media:s,sourceMap:l};e[r]?e[r].parts.push(c):n.push(e[r]={id:r,parts:[c]})}return n}function r(t,n){var e=g(t.insertInto);if(!e)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=_[_.length-1];if("top"===t.insertAt)i?i.nextSibling?e.insertBefore(n,i.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),_.push(n);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");e.appendChild(n)}}function a(t){t.parentNode.removeChild(t);var n=_.indexOf(t);n>=0&&_.splice(n,1)}function s(t){var n=document.createElement("style");return t.attrs.type="text/css",c(n,t.attrs),r(t,n),n}function l(t){var n=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",c(n,t.attrs),r(t,n),n}function c(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function h(t,n){var e,i,o;if(n.singleton){var r=w++;e=v||(v=s(n)),i=u.bind(null,e,r,!1),o=u.bind(null,e,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=l(n),i=f.bind(null,e,n),o=function(){a(e),e.href&&URL.revokeObjectURL(e.href)}):(e=s(n),i=d.bind(null,e),o=function(){a(e)});return i(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;i(t=n)}else o()}}function u(t,n,e,i){var o=e?"":i.css;if(t.styleSheet)t.styleSheet.cssText=x(n,o);else{var r=document.createTextNode(o),a=t.childNodes;a[n]&&t.removeChild(a[n]),a.length?t.insertBefore(r,a[n]):t.appendChild(r)}}function d(t,n){var e=n.css,i=n.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}function f(t,n,e){var i=e.css,o=e.sourceMap,r=void 0===n.convertToAbsoluteUrls&&o;(n.convertToAbsoluteUrls||r)&&(i=b(i)),o&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}var p={},m=function(t){var n;return function(){return void 0===n&&(n=t.apply(this,arguments)),n}}(function(){return window&&document&&document.all&&!window.atob}),g=function(t){var n={};return function(e){return void 0===n[e]&&(n[e]=t.call(this,e)),n[e]}}(function(t){return document.querySelector(t)}),v=null,w=0,_=[],b=e(25);t.exports=function(t,n){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");n=n||{},n.attrs="object"==typeof n.attrs?n.attrs:{},void 0===n.singleton&&(n.singleton=m()),void 0===n.insertInto&&(n.insertInto="head"),void 0===n.insertAt&&(n.insertAt="bottom");var e=o(t);return i(e,n),function(t){for(var r=[],a=0;a<e.length;a++){var s=e[a],l=p[s.id];l.refs--,r.push(l)}if(t){i(o(t),n)}for(var a=0;a<r.length;a++){var l=r[a];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete p[l.id]}}}};var x=function(){var t=[];return function(n,e){return t[n]=e,t.filter(Boolean).join("\n")}}()},function(t,n){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(1),e(0),e(17),e(13),e(10),e(11),e(12),e(19),e(20),e(8),e(7),e(29),e(31),e(24),e(32),e(33)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e,i,o,r,a,s,l,c,h,u,d,f){"use strict";function p(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var m=p(e),g=p(i),v=p(o),w=p(r),_=p(a),b=p(s),x=p(l),y=p(c),E=p(h),A=p(u),S=p(d),C=p(f);n.default=g.default.View.extend({el:C.default,initialize:function(t){var n=this;this.$el.appendTo((0,m.default)("body")).css("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)"),this.model=new A.default(t),this.toolbar=new v.default({model:this.model,el:this.$(".group_info")}),this.navigator=new w.default({model:this.model,el:this.$(".btn_area")}),this.image=new _.default({model:this.model,el:this.$(".flick_view"),naverapp_sizeChange_response:t.naverapp_sizeChange_response}),this.imageCover=new b.default({model:this.model,el:this.$(".btn_view_video")}),this.message=new x.default({model:this.model,el:this.$(".view_notice")}),this.vrViewer=new y.default({model:this.model,el:this.$(".image360_wrapper")}),this.vrToggle=new E.default({model:this.model,el:this.$("._vr-toggle")}),["relatedopen","relatedclose","relatedimg","taskopen","taskclose","prev","next","swipe","back","beforeshow","show","beforehide","hide","like","social","outlink","original"].forEach(function(t){return n.listenTo(n.model,t,n.trigger.bind(n,t))}),this.listenTo(this.model,"change:index",this.onChangeIndex).listenTo(this.model,"change:isActive",this.onChangeState).listenTo(this.model,"change:toolbarVisible",this.onChangeToobarVisible).listenTo(this.model,"outlink",function(){return n.toggleNaverAppFullscreen(!0)}).listenTo(this.model,"change",this.resizeContainer).listenTo(this.model,"beforeshow",function(){return n.toggleNaverAppFullscreen(!0)}).listenTo(this.model,"beforeshow",function(){return n.model.set("relatedVisible",!1)}).listenTo(this.model,"show",function(){return n.model.set("toolbarVisible",!0)}).listenTo(this.model,"beforehide",function(){return n.toggleNaverAppFullscreen(!1)}),this.$el.on("click",".flick_view img",function(t){return n.onImgClick(t)}).on("click",function(t){return n.onClick(t)})},onImgClick:function(t){var n=this.model.get("selectedItem"),e=n.type,i=n.originalUrl;"video"===e&&(this.model.trigger("videoplay",t),location.href=i)},onClick:function(t){(0,m.default)(t.target).closest(".btn_area, .group_info").length||this.model.set("toolbarVisible",!this.model.get("toolbarVisible"))},show:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=m.default.extend(!0,{validate:!0},n);this.image.collection.reset(n.list,{parse:!0}),this.listenToOnce(this.model,"change:selectedItem",function(n,e){e.is360&&t.model.set("vrActive",!0)}),delete e.list,this.model.set("index",n.index,e)},hide:function(){this.model.set({index:-1,is360:!1})},reset:function(t){this.image.collection.reset(t)},related:function(t,n){if(this.toolbar.relatedView){var e=this.toolbar.relatedView.collection;e.reset(t);var i=n&&e.get(n);i&&this.model.set({relatedVisible:!0,relatedIndex:e.indexOf(i)},{scrollIntoView:!0})}},getItem:function(){var t=this.image.collection.at(this.model.get("index"));return t&&t.toJSON()||{}},getRelatedItem:function(){return this.model.get("relatedItem")},onChangeIndex:function(){var t=this.model.get("index");this.trigger("change",{index:t})},onChangeState:function(t,n,e){n?this._show(e):this._hide(e)},onChangeToobarVisible:function(t,n,e){this.trigger("tools"+(n?"on":"off"))},_show:function(t){var n=this;this.model.trigger("beforeshow"),this.$el.css({position:"absolute",top:0,left:0,height:window.innerHeight+"px",display:""});var e=t&&t.from,i=m.default.Deferred();this.model.get("animationEnabled")&&e?S.default.animateToViewer(e,this.image.el,this.model.get("animationAlign")).then(i.resolve):i.resolve(),i.promise().then(function(){return n.model.trigger("transitionEnd")})},_hide:function(){var t=this;this.model.trigger("beforehide");var n={position:"fixed",display:"none"};if(this.model.get("animationEnabled")){var e=this.model.get("itemSelector"),i=this.model.get("selectedItem"),o=(0,m.default)(e.replace("{id}",i.id)).get(0);if(o)return void m.default.Deferred(function(t){return window.setTimeout(t.resolve,10)}).promise().then(function(){return t.updateScrollPosition(o)}).then(function(){return t.$el.css(n),S.default.animateToList(o,t.image.currentImage,t.model.get("animationAlign"))}).then(function(){return t.model.trigger("transitionEnd")}).then(function(){return t.model.trigger("hide")})}this.$el.css(n),this.model.trigger("hide")},resizeContainer:function(t){var n=t.changed,e=n.viewerWidth,i=n.viewerHeight;(e||i)&&this.$el.css({width:t.get("viewerWidth")+"px",height:t.get("viewerHeight")+"px"})},updateScrollPosition:function(t){var n=m.default.Deferred(),e=t.getBoundingClientRect();return e.top>=0&&e.bottom<=window.innerHeight?n.resolve():(t.scrollIntoView(),window.setTimeout(n.resolve,30)),n.promise()},toggleNaverAppFullscreen:function(t){if(this.model.get("isNaverApp")){var n="naverapp://setstatusbar?"+(t?"color=000000&style=1":"cancel=true"),e="naverapp://fullscreen"+(t?"":"?top=show&bottom=show");location.href=n,window.setTimeout(function(){return location.href=e},50)}}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(1)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(t){var n=window.innerWidth,e=window.innerHeight,i=parseFloat(t.attr("data-width")),o=parseFloat(t.attr("data-height")),r=i,a=o;return r>n&&(r=n,a=r*(o/i)),a>e&&(a=e,r=a*(i/o)),{top:(e-a)/2,left:(n-r)/2,width:r,height:a}},r=function(t,n){return{top:t.top-n.top,left:t.left-n.left,sx:t.width/n.width,sy:t.height/n.height}},a=function(t){var n=[];return(t.ty||t.tx)&&n.push("translate3d(\n\t\t\t"+(t.tx||0)+"px,\n\t\t\t"+(t.ty||0)+"px,\n\t\t\t0)"),(t.sx||t.sy)&&n.push("scale3d(\n\t\t\t"+(t.sx||0)+",\n\t\t\t"+(t.sy||0)+",\n\t\t\t1)"),n.join(" ")};n.default={animateToViewer:function(t,n,e){var s=i.default.Deferred(),l=(0,i.default)(t),c=l.find("._img"),h=(0,i.default)(n),u=t.getBoundingClientRect(),d=c.get(0).getBoundingClientRect(),f=o(c),p=r(u,f),m=r(d,f),g=a({tx:p.left,ty:p.top,sx:p.sx,sy:p.sy}),v=a({sx:m.sx/p.sx,sy:m.sy/p.sy}),w=(0,i.default)("<div></div>"),_=(0,i.default)("<img>").attr("src",c.attr("src")),b=void 0;return l&&l.css("visibility","hidden"),h&&h.css("visibility","hidden"),"center"===e?_.css({position:"absolute",top:0,left:0,width:f.width+"px",height:f.height+"px",margin:"auto","transform-origin":"50% 50%",transform:v}).appendTo(w):_.css({position:"absolute",top:0,left:0,width:f.width+"px",height:f.height+"px",transform:v}).appendTo(w),w.css({position:"fixed",overflow:"hidden",top:f.top+"px",left:f.left+"px",width:f.width+"px",height:f.height+"px",transform:g}).on("transitionend",function(t){(0,i.default)(t.currentTarget).off("transitionend"),"number"==typeof b&&clearTimeout(b),b=null,setTimeout(s.resolve,0)}).addClass("_hero_animating").appendTo((0,i.default)("body")),b=setTimeout(s.resolve,400),setTimeout(function(){w.css("transform",""),_.css("transform","")},50),s.promise().done(function(){l&&l.css("visibility",""),h&&h.css("visibility",""),w.remove()})},animateToList:function(t,n,e){var s=i.default.Deferred(),l=s.promise(),c=(0,i.default)(t),h=c.find("._img");if(!h)return l;var u=(0,i.default)(n),d=t.getBoundingClientRect(),f=h.get(0).getBoundingClientRect(),p=o(h),m=r(p,d),g=r(p,f),v=a({tx:m.left,ty:m.top,sx:m.sx,sy:m.sy}),w=a({sx:g.sx/m.sx,sy:g.sy/m.sy}),_=(0,i.default)("<div></div>"),b=(0,i.default)("<img>").attr("src",u.attr("src")),x=void 0;return c&&c.css("visibility","hidden"),u&&u.css("visibility","hidden"),"center"===e?b.css({position:"absolute",top:(d.height-f.height)/2+"px",left:(d.width-f.width)/2+"px",width:f.width+"px",height:f.height+"px",margin:"auto",transform:w,"transform-origin":"50% 50%","-webkit-transition-duration":"200ms","transition-duration":"200ms"}).appendTo(_):b.css({position:"absolute",top:0,left:0,width:f.width+"px",height:f.height+"px",transform:w,"-webkit-transition-duration":"200ms","transition-duration":"200ms"}).appendTo(_),_.css({position:"fixed",overflow:"hidden",top:d.top+"px",left:d.left+"px",width:d.width+"px",height:d.height+"px",transform:v,"-webkit-transition-duration":"200ms","transition-duration":"200ms"}).on("transitionend",function(t){(0,i.default)(t.currentTarget).off("transitionend"),"number"==typeof x&&clearTimeout(x),x=null,s.resolve()}).addClass("_hero_animating").appendTo((0,i.default)("body")),x=setTimeout(s.resolve,400),setTimeout(function(){_.css("transform",""),b.css("transform","")},50),l.done(function(){c&&c.css("visibility",""),u&&u.css("visibility",""),_.remove()})}},t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.Model.extend({defaults:{animationAlign:"center",itemSelector:"._item[data-id='{id}']",related:!1,vr360ControlMode:"",vr360FieldOfView:65,blankgif:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",isNaverApp:function(){return/NAVER\((?:[^;)]+;?){1,}\)/.test(navigator.userAgent)}(),animationEnabled:/local\./.test(location.host)||function(){var t=navigator.userAgent,n=/iP(?:[ao]d|hone)/.test(t),e=/Android (\d+\.\d+)/.exec(t),i=e&&Number(e[1])>4.5;return n||i}(),relatedVisible:!1,toolbarVisible:!1,vrActive:!1,navigatorTimeout:2500,toolbarShowClassName:"is_show",toolbarType:"details",toolbarTransitionClassName:"_toobar-hide",index:-1,isActive:!1},initialize:function(){this.on("change:index",function(t,n,e){e=e||{},e.autoHide=!0,t.set({isActive:-1!==n,toolbarType:"details",message:"",vrError:""},e)})},validate:function(t,n){var e=t.index,i=n.list;return void 0===e||i&&i[e]}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.Collection.extend({parse:function(t){return t.map(function(t){var n=t.originalUrl,e=t.like,i=t.like_cid,o=t.like_sid,r=t.like_did,a=t.social,s=t.social_title,l=/PM-1\.P-eq/.test(n),c=e||i||o||r,h=a||s,u=!l&&n;return t.is360=l,t.likeEnabled=c,t.socialEnabled=h,t.originalUrlEnabled=u,t.taskEnabled=c||h||u,t})}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(1),e(0),e(9),e(21),e(2)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e,i,o,r,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var l=s(e),c=s(i),h=s(o),u=s(a),d=function(){function t(t,n){var e=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(e.push(a.value),!n||e.length!==n);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n.default=c.default.View.extend({PANELS:["getPrevElement","getElement","getNextElement"],collection:new h.default,initialize:function(t){var n=this;this.prevTapTime=0,this.naverappSizeChangeResponse=t.naverapp_sizeChange_response||this.naverappSizeChangeResponse.bind(this),(0,l.default)(window).on("resize",function(){return n.updateContainerSize()}),u.default&&u.default.on(function(){return n.updateContainerSize()}),this.listenTo(this.collection,"reset add remove",this.onCollectionChange).listenTo(this.model,"change:index",this.onChangeIndex).listenTo(this.model,"change:vrActive",this.toggleFlicking).listenTo(this.model,"change",this.resizeContainer).listenTo(this.model,"hide",this.onHide),this.model.get("related")&&this.listenTo(this.model,"change:relatedItem",this.onChangeRelatedItem),this.updateContainerSize()},naverappSizeChangeResponse:function(t,n,e,i){var o=this;window.setTimeout(function(){naverInapp&&naverInapp.scrollTop&&naverInapp.scrollTop(),e&&i&&(t=t-i-e),o.updateContainerSize(t,n)},50)},assignNaverAppSizeChangeResponse:function(){window.naverapp_sizeChange_response||(this.definedByMe=!0,window.naverapp_sizeChange_response=this.naverappSizeChangeResponse)},removeNaverAppSizeChangeResponse:function(){window.naverapp_sizeChange_response&&this.definedByMe&&(window.naverapp_sizeChange_response=null)},createFlicking:function(){!this.flicking&&(this.flicking=new eg.Flicking(this.$el,{defaultIndex:1,prefix:"f",horizontal:!0,circular:!0,threshold:40,duration:200}).on({beforeFlickStart:this.onBeforeFlickStart.bind(this),flickEnd:this.onFlickEnd.bind(this)})),this.currentImage=this.flicking.getElement().find("img").get(0)},destroyFlicking:function(){this.flicking&&this.flicking.destroy(),this.flicking=null},createPanzoom:function(){this.assignTransformPropertyTojQueryCSSProps(),!this.panzoom&&this.$el.find(".panzoom").panzoom({minScale:.7,maxScale:3,increment:.5,exponential:!0,disablePan:!0}).on("panzoomzoom",this.onPanzoomZoom.bind(this)).on("panzoomstart",this.onPanzoomStart.bind(this)).on("panzoomend",this.invertToolbarVisible.bind(this)).on("panzoomend",this.resetPanzoom.bind(this)).on("panzoomend",this.onPanzoomEnd.bind(this)).on("click",this.onClick.bind(this)),this.panzoom=!0},destroyPanzoom:function(){this.$el.find(".panzoom").panzoom("destroy").off(),this.panzoom=!1},assignTransformPropertyTojQueryCSSProps:function(){l.default.cssProps.transform||(l.default.cssProps=l.default.extend(!0,{},window.jQuery.cssProps))},onClick:function(t){var n=(0,l.default)(t.currentTarget);+new Date-this.prevTapTime<r.DOUBLE_TAP_INTERVAL&&n.panzoom("zoom",n.panzoom("option","maxScale"),{animate:!0,focal:t}),this.prevTapTime=+new Date},onPanzoomZoom:function(t,n,e,i){n.options.disablePan=!1},onPanzoomStart:function(t,n,e,i){1===n.scale&&2===i.length&&this.model.set("toolbarVisible",!1)},invertToolbarVisible:function(t,n,e,i){i||this.model.set("toolbarVisible",!this.model.get("toolbarVisible"))},resetPanzoom:function(t,n,e,i){(n.scale<=1||!i&&+new Date-this.prevTapTime<r.DOUBLE_TAP_INTERVAL)&&(n.reset(),n.options.disablePan=!0),this.prevTapTime=+new Date},onPanzoomEnd:function(t,n,e,i){var o=n.$elem.find("img").get(0).getBoundingClientRect(),r=Math.max(o.width-document.documentElement.clientWidth,0),a=Math.max(o.height-document.documentElement.clientHeight,0),s=r/2,l=-s,c=a/2,h=-c,u=parseFloat(e[4]),d=parseFloat(e[5]);n.scale>1&&(u=Math.max(l,Math.min(u,s)),d=Math.max(h,Math.min(d,c)),n.pan(u,d,{animate:!0,silent:!0}))},onHide:function(){this.destroyFlicking(),this.destroyPanzoom(),this.removeNaverAppSizeChangeResponse()},toggleFlicking:function(t,n){n?this.destroyFlicking():(this.createFlicking(),this.onChangeIndex(this.model,this.model.get("index")))},onCollectionChange:function(){this.model.set("length",this.collection.length)},onChangeIndex:function(t,n){var e=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=null;if(t.set("relatedItem",null),-1===n)return void this.collection.reset();if(o=this.collection.at(n)){if(o=o.toJSON(),t.set("selectedItem",o),this.assignNaverAppSizeChangeResponse(),t.get("vrActive"))return t.trigger("show",o),void this.triggerResize();this.createFlicking(),this.createPanzoom(),i.hasOwnProperty("isNext")?[[n-1,0],[n+1,2]].forEach(function(t){var n=d(t,2),i=n[0],o=n[1],r=i<0||i>e.collection.length-1;e.renderPanel(r?-1:i,o)}):([n-1,n,n+1].forEach(this.renderPanel.bind(this)),this.updateContainerSize()),t.trigger("show",o)}},onFlickEnd:function(t){this.currentImage=this.flicking.getElement().find("img").get(0),this.model.set("index",this.flicking.getElement().data("index"),{isNext:t.direction===eg.MovableCoord.DIRECTION_LEFT}).trigger("swipe",t)},onBeforeFlickStart:function(t){var n=this.flicking.getElement().data("index"),e=t.direction===eg.MovableCoord.DIRECTION_LEFT;(0===n&&!e||n===this.collection.length-1&&e)&&(t.stop(),this.flicking.restore())},onChangeRelatedItem:function(t,n){t.get("isActive")&&n&&this.renderPanel(void 0,1)},renderPanel:function(t,n){var e=this,i=this.collection,o=this.model.get("blankgif"),r=this.model.get("related")&&this.model.get("relatedItem")||(t<0||t>i.length-1?null:i.at(t)),a=r&&(r.get("width")||r.get("temp_width")),s=r&&(r.get("height")||r.get("temp_height")),c=".img-status-"+Math.random().toString().slice(2,8),h=function(t){var n=t.currentTarget,i=n.naturalWidth,h=n.naturalHeight,u=(0,l.default)(n);u.off(c).toggleClass("_load","load"===t.type&&n.src!==o).toggleClass("_err","error"===t.type).css("visibility",""),a&&s||i<=1||h<=1||(r&&r.set({temp_width:i,temp_height:h}),u.css(e.resizeImage(i,h)),e.triggerResize())},u=this.flicking[this.PANELS[n]]().data("index",void 0===t?this.model.get("index"):t).find("img").removeClass("_load _err").attr({src:r&&r.get("imgUrl")||o,alt:r&&r.get("alt")||""}).css(this.resizeImage(a||120,s||100)).css("visibility","hidden").one("load"+c,h.bind(this)).one("error"+c,h.bind(this)).get(0);u.complete&&(h.call(this,{currentTarget:u}),this.triggerResize())},resizeImage:function(t,n){var e=this.model.get("viewerWidth"),i=this.model.get("viewerHeight"),o=t,r=n;return t>e&&(o=e,r=e*(n/t)),r>i&&(r=i,o=i*(t/n)),{left:Math.round(.5*(e-o))+"px",top:Math.round(.5*(i-r))+"px",width:o+"px",height:r+"px"}},updateContainerSize:function(t,n){this.model.set({viewerWidth:t||window.innerWidth,viewerHeight:n||window.innerHeight})},resizeContainer:function(t){var n=this,e=t.changed,i=e.viewerWidth,o=e.viewerHeight;if((i||o)&&(this.$el.css({width:t.get("viewerWidth")+"px",height:t.get("viewerHeight")+"px"}),this.flicking&&this.flicking.resize)){var r=this.flicking.resize();this.PANELS.forEach(function(t,e){var i=r[t](),o=1===e&&n.model.get("related")&&n.model.get("relatedItem")||n.collection.at(i.data("index"));i.find("img").css(n.resizeImage(o&&(o.get("width")||o.get("temp_width"))||120,o&&(o.get("height")||o.get("temp_height"))||100))}),this.triggerResize()}},triggerResize:function(){this.model.trigger("imageResized",this.flicking&&this.flicking.getElement&&this.flicking.getElement().find("img").get(0))}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({initialize:function(){this.listenTo(this.model,"change:selectedItem",this.render)},render:function(){var t=this.model.get("selectedItem")||{},n=t.type,e=t.originalUrl;this.$el.attr("href",e).css("display","video"===n?"":"none")}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({initialize:function(){this.$text=this.$(".notice_txt"),this.listenTo(this.model,"change:message",this.render)},render:function(t,n){this.$text.text(n||""),this.$el.css("display",n?"":"none")}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({initialize:function(){this.$prev=this.$(".btn_prev"),this.$next=this.$(".btn_next"),this.$el.on("click",".btn_prev",this.onClickButton.bind(this,-1)).on("click",".btn_next",this.onClickButton.bind(this,1)),this.listenTo(this.model,"change:toolbarVisible",this.onVisibilityChange).listenTo(this.model,"change:index",this.onChangeIndex)},onVisibilityChange:function(t,n){var e=!t.get("vrActive")&&n;if(this.toggle(e),e){var i=t.get("index"),o=t.get("length");this.$prev.toggle(i>0),this.$next.toggle(i<o-1)}},onChangeIndex:function(t){this.onVisibilityChange(t,t.get("toolbarVisible"))},onClickButton:function(t,n){n.preventDefault();var e=this.model.get("index"),i=-1===e?-1:e+t;this.model.set("index",i).trigger(-1===t?"prev":"next",n),this.autoHide()},toggle:function(t){this.$el.toggleClass(this.model.get("toolbarShowClassName"),!!t),t&&this.autoHide()},autoHide:function(){this.model.get("isActive")&&("number"==typeof this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(this.toggle.bind(this,!1),this.model.get("navigatorTimeout")))}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({el:'<div class="img_count">\n\t\t<span class="blind"> </span><span class="current_img"></span>\n\t\t<span class="blind"> </span><span class="total_img"></span>\n\t</div>',initialize:function(){var t=this;this.$no=this.$(".current_img"),this.$total=this.$(".total_img");var n=this.model;this.listenTo(n,"change:length",function(n,e){return t.$total.text(e||"")}).listenTo(n,"show",function(n){var e=n.no;return t.$no.text(e||"")})}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(1),e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}Object.defineProperty(n,"__esModule",{value:!0});var a=o(e),s=o(i);n.default=s.default.View.extend({collection:new s.default.Collection,className:"view_relation_list",events:{"click .thumb":"onClickThumb"},initialize:function(){this.isActive=!1,this.$el.html('<div class="relation_inner"><ul class="thumb_list"></ul></div>'),this.$scroller=this.$(".relation_inner"),this.$list=this.$(".thumb_list"),this.listenTo(this.collection,"reset",this.render).listenTo(this.model,"transitionEnd",this.onTransitionEnd).listenTo(this.model,"change:index",this.onChangeMain).listenTo(this.model,"change:relatedIndex",this.onChangeRelatedIndex).listenTo(this.model,"change:relatedItem",this.onChangeRelatedItem).listenTo(this.model,"change:relatedVisible",this.onChangeRelated)},onTransitionEnd:function(){this.isActive=this.model.get("isActive"),this.isActive&&this.render()},onChangeMain:function(){this.collection.reset()},render:function(){var t=this,n=this.isActive&&this.model.get("isActive");if(this.$list.html(n?this.collection.map(function(t,n){var e=t.toJSON();return'\n\t\t\t\t<li id="thumb-'+t.cid+'"'+(0===n?' class="on"':"")+'>\n\t\t\t\t\t<a href="#" class="thumb" data-index="'+n+'">\n\t\t\t\t\t\t<img alt="'+e.alt+'"\n\t\t\t\t\t\t\tsrc="'+(e.thumbUrl||e.imgUrl)+'">\n\t\t\t\t\t</a>\n\t\t\t\t</li>'}).join(""):""),this.collection.length){this.toggleList(!1);var e=this.$list.css("visibility","hidden").find("img").map(function(t,n){var e=a.default.Deferred();return(0,a.default)(n).one("load error",e.resolve),e.promise()}).get();a.default.when.apply(a.default,r(e)).then(function(){return t.toggleList(!0)}),window.setTimeout(function(){return t.toggleList(!0)},200)}return this.$scroller.scrollLeft(0),this.model.set({relatedIndex:-1,relatedItem:null}),this},toggleList:function(t){this.$list.css("visibility",t?"":"hidden"),this.trigger("relatedElementVisible",t)},onChangeRelated:function(t,n){this.$el.css("display",n?"block":"none")},onChangeRelatedIndex:function(t,n,e){var i=t.get("relatedVisible")&&n>-1?this.collection.at(n):null;t.set({relatedItem:i,toolbarType:"details"},e)},onChangeRelatedItem:function(t,n,e){var i=this;if(this.$(".on").removeClass("on"),n&&n.cid){var o=this.$("#thumb-"+n.cid).addClass("on");e&&e.scrollIntoView&&this.once("relatedElementVisible",function(){o.get(0).scrollIntoView();var t=i.$scroller.scrollLeft()+20;i.$scroller.scrollLeft(0),i.$scroller.animate({scrollLeft:t},500)})}},onClickThumb:function(t){t.preventDefault(),this.model.set("relatedIndex",(0,a.default)(t.currentTarget).data("index")).trigger("relatedimg",t)}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({events:{"click .btn_relation":"onClickRelated","click a.view_desc":"onClickLink"},initialize:function(){this.$desc=this.$(".view_desc"),this.$desc_link=this.$("a.view_desc"),this.$desc_nolink=this.$("div.view_desc"),this.$etc=this.$("._etc"),this.$title=this.$(".tit"),this.$descText=this.$(".desc"),this.$bottom=this.$(".detail"),this.$source=this.$("._source"),this.$dimension=this.$("._dimension"),this.$width=this.$("._width"),this.$height=this.$("._height"),this.$timestamp=this.$("._timestamp"),this.listenTo(this.model,"change:toolbarType",this.onChangeToolbarType).listenTo(this.model,"show",this.render);var t=this.model.get("related");this.classList=["view_basic"].concat(t?"view_relation":[]),t&&(this.$el.prepend('<a href="#" class="btn_relation">\n\t\t\t\t\t<span class="spcv_af ico_relation"></span>\n\t\t\t\t</a>'),this.$related=this.$(".btn_relation"),this.$relatedText=this.$(".ico_relation"),this.listenTo(this.model,"change:selectedItem",this.renderRelatedText).listenTo(this.model,"change:relatedVisible",this.onChangeRelated).listenTo(this.model,"change:relatedItem",this.onChangeRelatedItem))},render:function(t){var n=!!t.link;this.$desc_link.attr({href:t.link||"#","data-id":t.id}).css("display",n?"":"none"),this.$desc_nolink.css("display",n?"none":"");var e=t.timeline?"view_timeline":t.hashtag?"view_summery":t.desc?"view_content":"";this.el.className=this.classList.concat(e||[]).join(" "),this.$etc.text(t.hashtag||t.timeline).css("display",e?"":"none"),this.$title.html(t.title||"&nbsp;"),this.$descText.html(t.desc||"").css("display",t.desc?"":"none"),this.$source.text(t.source||""),this.$width.text(t.width||""),this.$height.text(t.height||""),this.$timestamp.text(t.timestamp||"").css("display",t.timestamp?"":"none"),this.$dimension.css("display",t.width&&t.height?"":"none"),this.$desc.toggleClass("no-dot",!t.source||!t.width||!t.height),this.$bottom.css("display",t.source||t.width&&t.height||t.timestamp?"":"none")},renderRelatedText:function(t,n){var e=n.relatedText,i=void 0===e?"":e;this.$relatedText.text(i)},onClickLink:function(t){if("#"===t.currentTarget.getAttribute("href"))return void t.preventDefault();this.model.trigger("outlink",t)},onChangeToolbarType:function(t,n){this.$el.toggleClass(t.get("toolbarTransitionClassName"),"details"!==n)},onClickRelated:function(t){t.preventDefault();var n=!this.model.get("relatedVisible");this.model.set("relatedVisible",n).trigger("related"+(n?"open":"close"),t)},onChangeRelated:function(t,n){this.$related.toggleClass("on",n)},onChangeRelatedItem:function(t,n){n&&this.render(n.toJSON())}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(1),e(0),e(14),e(16),e(18),e(15),e(2)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e,i,o,r,a,s,l){"use strict";function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var h=c(e),u=c(i),d=c(o),f=c(r),p=c(a),m=c(s),g=c(l);n.default=u.default.View.extend({events:{"click .go_total":"onClickClose","click ._toolbar-toggle":"onClickToolbarToggle"},initialize:function(){var t=this;this.$toggle=this.$("._toolbar-toggle");var n=this.model;this.detailsView=new f.default({model:n,el:this.$(".view_basic")}),this.taskbarView=new p.default({model:n,el:this.$(".view_function")}),this.paginationView=new d.default({model:n}),this.$(".header_info").append(this.paginationView.el),n.get("related")&&(this.relatedView=new m.default({model:n}),this.$(".content_info").append(this.relatedView.el)),(0,h.default)(window).on("resize",this.setContentInfoHeight.bind(this,!1)),g.default&&g.default.on(this.setContentInfoHeight.bind(this,!1)),this.listenTo(n,"change:toolbarVisible",function(n,e){return t.toggle(e)}).listenTo(n,"show",function(n){var e=n.taskEnabled;return t.$toggle.css("display",e?"":"none")}),this.$el.on("touchmove",function(n){return t.onTouchMove(n)})},onClickClose:function(t){t.preventDefault();var n=this.model;if(n.get("vrActive"))return void n.set("vrActive",!1);n.set("index",-1).trigger("back",t)},onTouchMove:function(t){t.originalEvent.touches.length>1&&t.preventDefault()},onClickToolbarToggle:function(t){t.preventDefault();var n=t.currentTarget.getAttribute("data-type");this.model.set("toolbarType",n).trigger("task"+("task"===n?"open":"close"),t)},setContentInfoHeight:function(t){if("details"===this.model.get("toolbarType")&&!t){var n=this.$(".content_info"),e=n.get(0).getBoundingClientRect(),i=e.height;n.css("bottom","-"+i+"px")}},toggle:function(t){this.setContentInfoHeight(!!t),this.$el.toggleClass(this.model.get("toolbarShowClassName"),!!t)}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({events:{"click ._original":"onClickOriginal"},initialize:function(){this.$like=this.$("._like"),this.$social=this.$("._social"),this.$original=this.$("._original"),this.listenTo(this.model,"change:toolbarType",this.onChangeToolbarType).listenTo(this.model,"show",this.render).listenTo(this.model,"change:relatedItem",this.onChangeRelatedItem)},render:function(t){var n=t.likeEnabled,e=t.socialEnabled,i=t.originalUrlEnabled;this.model.trigger("like",this.$like.css("display",n?"":"none")).trigger("social",this.$social.css("display",e?"":"none")),this.$original.attr("href",i||"#").css("display",i?"":"none")},onChangeRelatedItem:function(t,n){n&&this.render(n.toJSON())},onClickOriginal:function(t){this.model.trigger("original",t)},onChangeToolbarType:function(t,n){this.$el.toggleClass(t.get("toolbarTransitionClassName"),"task"!==n)}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(e);n.default=i.default.View.extend({initialize:function(t){this._isImage360Support="notyet",this.$preview=this.$(".image360_preview"),this.listenTo(this.model,"change:vrActive",this.render).listenTo(this.model,"change:selectedItem",this.renderError).listenTo(this.model,"imageResized",this.renderPreview)},isImage360Support:function(){return"notyet"===this._isImage360Support&&(this._isImage360Support=Image360Service.isSupported()),this._isImage360Support},renderError:function(t,n){var e="  360VR   ";n&&n.is360&&!this.isImage360Support()&&t.set({message:e,vrActive:!1,vrError:e})},render:function(t,n){if(this.destroy(),n&&this.isImage360Support()){var e=t.get("selectedItem"),i=e.originalUrl,o=e.imgUrl,r=(""+Math.random()).slice(2),a=i+"?type=cube1024&"+r,s=t.get("vr360ControlMode"),l=t.get("vr360FieldOfView");this.viewer=new Image360Service(this.el,{image:a,controlMode:s,fieldOfView:l}),this.$preview.css("background-image","url("+o+")"),this.renderPreview()}},renderPreview:function(){var t=window.innerWidth>window.innerHeight;this.$preview.css({"background-size":t?"contain":"cover","background-repeat":t?"no-repeat":""})},destroy:function(){this.viewer&&(this.$preview.css("background-image","none"),this.viewer.destroy(),this.viewer=null)}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(a,s){o=[t,n,e(1),e(0)],i=s,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t,n,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r=o(e),a=o(i);n.default=a.default.View.extend({initialize:function(){var t=this;this.$root=(0,r.default)(".api_common_viewer"),this.listenTo(this.model,"\n\t\t\tchange:selectedItem\n\t\t\tchange:vrActive\n\t\t\tchange:vrError\n\t\t\t",this.render).listenTo(this.model,"imageResized",function(n){return window.setTimeout(t.align.bind(t,n),10)}),this.$el.on("click",function(){t.model.set("vrActive",!t.model.get("vrActive"))})},render:function(t){var n=t.get("vrError"),e=t.get("vrActive"),i=t.get("selectedItem")||{},o=i.is360;this.$el.prop("disabled",!o).css("display",!o||e||n?"none":""),this.align(this.img)},align:function(t){if(this.img=t,t&&this.model.get("isActive")){!this.diff&&this.el.getBoundingClientRect().height&&(this.diff=this.el.getBoundingClientRect().height+20);var n=this.diff,e=window.innerHeight,i=t.getBoundingClientRect().bottom-n,o=this.$root.find(".view_desc:visible"),r=o.length?o.get(0).getBoundingClientRect().top-n:e,a=this.$root.find(".notice_txt:visible"),s=a.length?a.get(0).getBoundingClientRect().top-n:e;this.$el.css("top",Math.min(i,r,s)+"px")}}}),t.exports=n.default})},function(t,n,e){var i,o,r;!function(e,a){o=[n],i=a,void 0!==(r="function"==typeof i?i.apply(n,o):i)&&(t.exports=r)}(0,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DOUBLE_TAP_INTERVAL=300})},function(t,n,e){n=t.exports=e(3)(!1),n.push([t.i,"@charset \"UTF-8\";\n.api_common_viewer .header_info .go_total .spcv {\n\toverflow: hidden;\n\twhite-space: nowrap;\n\ttext-indent: 100%;\n}\n\n.api_common_viewer .btn_view_video, .api_common_viewer .btn_view_360, .api_common_viewer .btn_area .btn .spcv, .api_common_viewer .btn_area .btn_next .spcv, .api_common_viewer .header_info .go_total .spcv, .api_common_viewer .content_info .view_basic .btn_more .ico_more, .api_common_viewer .content_info .view_basic .btn_relation .ico_relation:after, .api_common_viewer .content_info .function_list .item .like, .api_common_viewer .content_info .function_list .item.f_heart .like, .api_common_viewer .content_info .function_list .item.share:after, .api_common_viewer .content_info .function_list .item .original, .api_common_viewer .content_info .function_list .item .close, .image360_loading:before, .image360_icon:before {\n\tbackground-image: url(https://ssl.pstatic.net/static/m/common/viewer/sp_viewer_3acf4853.png);\n\t-webkit-background-size: 183px 159px;\n\t        background-size: 183px 159px;\n}\n\n.api_common_viewer {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tleft: 0;\n\tz-index: 7000;\n\tbackground-color: #000;\n\tfont-family: HelveticaNeue, Helvetica, -apple-system, BlinkMacSystemFont, Apple SD Gothic Neo, sans-serif;\n\tfont-size: 16px;\n\tline-height: 20px;\n}\n\n.api_common_viewer .blind {\n\toverflow: hidden !important;\n\tposition: absolute !important;\n\twidth: 1px !important;\n\theight: 1px !important;\n\tmargin: -1px !important;\n\tclip: rect(0 0 0 0) !important;\n}\n\n.api_common_viewer a {\n\tcolor: inherit;\n\ttext-decoration: none;\n}\n\n.api_common_viewer i, .api_common_viewer em, .api_common_viewer address, .api_common_viewer cite, .api_common_viewer dfn {\n\tfont-style: normal;\n}\n\n.api_common_viewer .bg_nimg3 {\n\tbackground: #f5f7f8 url(https://ssl.pstatic.net/static/m/common/viewer/bg_img.png) no-repeat 50% 50%;\n\t-webkit-background-size: 66px 52px;\n\t        background-size: 66px 52px;\n}\n\n.api_common_viewer .spcv, .api_common_viewer .spcv_bf:before, .api_common_viewer .spcv_af:after {\n\tdisplay: inline-block;\n\toverflow: hidden;\n\tcolor: transparent;\n\twhite-space: nowrap;\n}\n\n.api_common_viewer .spcv_bf:before, .api_common_viewer .spcv_af:after {\n\tcontent: '';\n}\n\n.api_common_viewer .scroll_wrap {\n\tposition: relative;\n\toverflow: hidden;\n\theight: 100%;\n}\n\n.api_common_viewer .flick_view {\n\toverflow: hidden;\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n}\n\n.api_common_viewer .flick_view .flick-ct {\n\tfloat: left;\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n}\n\n.api_common_viewer .flick_view .thumb {\n\tposition: absolute;\n\tbackground: url(https://ssl.pstatic.net/static/m/common/viewer/bg_pattern.png) 0 0 repeat;\n\t-webkit-background-size: 12px 12px;\n\t        background-size: 12px 12px;\n}\n\n.api_common_viewer .flick_view .bg_nimg3 {\n\tposition: absolute;\n}\n\n.api_common_viewer .btn_view_video {\n\tbackground-position: 0px -124px;\n\twidth: 35px;\n\theight: 35px;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin: -17px 0 0 -17px;\n}\n\n.api_common_viewer .btn_view_360 {\n\tbackground-position: 0px -90px;\n\twidth: 82px;\n\theight: 32px;\n\tposition: absolute;\n\tleft: 50%;\n\tmargin-left: -41px;\n\tbackground-color: transparent;\n\tborder: 0;\n}\n\n.api_common_viewer .btn_area {\n\tdisplay: none;\n}\n\n.api_common_viewer .btn_area.is_show {\n\tdisplay: block;\n}\n\n.api_common_viewer .btn_area .btn {\n\tposition: absolute;\n\ttop: 0;\n\tbottom: 0;\n\tz-index: 7100;\n\twidth: 60px;\n\theight: 60px;\n\tmargin: auto;\n\tbackground-color: rgba(0, 0, 0, 0.2);\n}\n\n.api_common_viewer .btn_area .btn .spcv {\n\tbackground-position: -84px -90px;\n\twidth: 16px;\n\theight: 31px;\n\toverflow: hidden;\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: auto;\n\tmargin-left: 20px;\n}\n\n.api_common_viewer .btn_area .btn_prev {\n\tleft: 0;\n}\n\n.api_common_viewer .btn_area .btn_next {\n\tright: 0;\n}\n\n.api_common_viewer .btn_area .btn_next .spcv {\n\tbackground-position: -84px -90px;\n\twidth: 16px;\n\theight: 31px;\n\tmargin: auto;\n\tmargin-right: 20px;\n\t-webkit-transform: rotate(180deg);\n\t        transform: rotate(180deg);\n}\n\n.api_common_viewer .group_info {\n\tdisplay: none;\n}\n\n.api_common_viewer .group_info.is_show {\n\tdisplay: block;\n}\n\n.api_common_viewer .header_info {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tz-index: 7100;\n\theight: 48px;\n\tbackground-color: rgba(0, 0, 0, 0.2);\n\tline-height: 48px;\n}\n\n.api_common_viewer .header_info .go_total {\n\tdisplay: block;\n\toverflow: hidden;\n\tfloat: left;\n\tposition: relative;\n\twidth: 49px;\n\theight: 48px;\n}\n\n.api_common_viewer .header_info .go_total .spcv {\n\tbackground-position: -59px -124px;\n\twidth: 21px;\n\theight: 18px;\n\tdisplay: block;\n\tmargin: 15px 0 0 15px;\n}\n\n.api_common_viewer .img_count {\n\tfloat: right;\n\tmargin-right: 15px;\n\tfont-size: 14px;\n\tcolor: #fff;\n\ttext-shadow: 0 1px 0 rgba(0, 0, 0, 0.2);\n}\n\n.api_common_viewer .img_count .current_img {\n\tfont-weight: 700;\n}\n\n.api_common_viewer .img_count .total_img:before {\n\tcontent: '/';\n\tmargin: 0 3px;\n}\n\n.api_common_viewer .img_count .total_img {\n\topacity: 0.7;\n}\n\n.api_common_viewer .view_notice {\n\toverflow: hidden;\n\tposition: absolute;\n\ttop: -13px;\n\tleft: 0;\n\tright: 0;\n\tmargin: 0 20px;\n\tfont-size: 13px;\n\ttext-align: center;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n}\n\n.api_common_viewer .view_notice .notice_link {\n\tcolor: #00c73c;\n\ttext-decoration: underline;\n}\n\n.api_common_viewer .content_info {\n\tposition: absolute;\n\tbottom: 0;\n\tleft: 0;\n\tright: 0;\n\tz-index: 7000;\n\tfont-size: 15px;\n\tcolor: #fff;\n\tline-height: 21px;\n\ttext-shadow: 0 1px 0 rgba(0, 0, 0, 0.2);\n\tbackground: -webkit-linear-gradient(transparent 0%, transparent 0%, transparent 0%, rgba(0, 0, 0, 0.7) 75px, rgba(0, 0, 0, 0.7) 100%);\n\tbackground: linear-gradient(transparent 0%, transparent 0%, transparent 0%, rgba(0, 0, 0, 0.7) 75px, rgba(0, 0, 0, 0.7) 100%);\n}\n\n.api_common_viewer .content_info .view_basic {\n\tposition: relative;\n\tz-index: 1;\n\tpadding: 21px 52px 15px 20px;\n}\n\n.api_common_viewer .content_info .view_basic .btn_more {\n\tposition: absolute;\n\tright: 0;\n\tbottom: 16px;\n\twidth: 43px;\n\theight: 42px;\n}\n\n.api_common_viewer .content_info .view_basic .btn_more .ico_more {\n\tbackground-position: -180px 0px;\n\twidth: 3px;\n\theight: 19px;\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tmargin: auto;\n\ttext-shadow: none;\n}\n\n.api_common_viewer .content_info .view_basic .btn_relation {\n\tposition: absolute;\n\tbottom: 26px;\n\tright: 43px;\n\theight: 21px;\n\tpadding: 0 22px 0 9px;\n\tborder: 1px solid #fff;\n\t-webkit-border-radius: 12px;\n\t        border-radius: 12px;\n\tfont-size: 13px;\n\tline-height: 21px;\n\tvertical-align: top;\n}\n\n.api_common_viewer .content_info .view_basic .btn_relation .ico_relation:after {\n\tbackground-position: -102px -112px;\n\twidth: 10px;\n\theight: 7px;\n\tposition: absolute;\n\ttop: 50%;\n\tright: 9px;\n\tmargin-top: -3px;\n}\n\n.api_common_viewer .content_info .view_basic .btn_relation.on .ico_relation:after {\n\tbackground-position: -114px -112px;\n}\n\n.api_common_viewer .content_info .view_basic .view_desc {\n\tdisplay: block;\n}\n\n.api_common_viewer .content_info .view_basic .view_desc .tit {\n\tdisplay: block;\n\toverflow: hidden;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\tfont-size: 17px;\n}\n\n.api_common_viewer .content_info .view_basic .view_desc .txt_etc {\n\tdisplay: block;\n\tmargin-bottom: 3px;\n\tfont-size: 14px;\n\tfont-weight: bold;\n}\n\n.api_common_viewer .content_info .view_basic .view_desc .detail {\n\tdisplay: block;\n\toverflow: hidden;\n\theight: 21px;\n\tmargin-top: 1px;\n\tfont-size: 13px;\n\tcolor: rgba(255, 255, 255, 0.7);\n}\n\n.api_common_viewer .content_info .view_basic .view_desc .detail .txt {\n\tdisplay: inline-block;\n}\n\n.api_common_viewer .content_info .view_basic .view_desc .detail .txt + .txt:before {\n\tdisplay: inline-block;\n\twidth: 2px;\n\theight: 2px;\n\tmargin-right: 4px;\n\t-webkit-border-radius: 50%;\n\t        border-radius: 50%;\n\tbackground: rgba(255, 255, 255, 0.7);\n\tvertical-align: 3px;\n\tcontent: '';\n}\n\n.api_common_viewer .content_info .view_basic.view_relation {\n\tpadding-right: 118px;\n}\n\n.api_common_viewer .content_info .view_basic.view_timeline .view_desc .tit {\n\tdisplay: -webkit-box;\n\tmax-height: 42px;\n\t-webkit-box-orient: vertical;\n\t-webkit-line-clamp: 2;\n\tfont-size: 15px;\n\twhite-space: initial;\n}\n\n.api_common_viewer .content_info .view_basic.view_summery .view_desc .tit {\n\tdisplay: -webkit-box;\n\tmax-height: 42px;\n\t-webkit-box-orient: vertical;\n\t-webkit-line-clamp: 2;\n\tfont-size: 15px;\n\twhite-space: initial;\n}\n\n.api_common_viewer .content_info .view_basic.view_summery .view_desc .txt_etc {\n\tmargin-bottom: 4px;\n}\n\n.api_common_viewer .content_info .view_content .view_desc .tit {\n\tmargin-bottom: 4px;\n\tfont-weight: bold;\n}\n\n.api_common_viewer .content_info .view_function {\n\tposition: relative;\n\tz-index: 1;\n\tmargin-top: 16px;\n}\n\n.api_common_viewer .content_info .function_list {\n\tdisplay: table;\n\twidth: 100%;\n\ttable-layout: fixed;\n}\n\n.api_common_viewer .content_info .function_list .item {\n\tdisplay: table-cell;\n\theight: 48px;\n\tpadding-top: 15px;\n\ttext-align: center;\n\tcolor: transparent;\n}\n\n.api_common_viewer .content_info .function_list .item .like_box {\n\tdisplay: block;\n}\n\n.api_common_viewer .content_info .function_list .item .ico {\n\tdisplay: inline-block;\n\tcolor: transparent;\n\ttext-shadow: none;\n\tvertical-align: top;\n}\n\n.api_common_viewer .content_info .function_list .item .like {\n\tbackground-position: -127px -90px;\n\twidth: 23px;\n\theight: 20px;\n\tmargin-top: 2px;\n}\n\n.api_common_viewer .content_info .function_list .item.f_heart .like {\n\tbackground-position: -102px -90px;\n\twidth: 23px;\n\theight: 20px;\n}\n\n.api_common_viewer .content_info .function_list .item.share:after {\n\tbackground-position: -152px -90px;\n\twidth: 23px;\n\theight: 20px;\n\tvertical-align: top;\n}\n\n.api_common_viewer .content_info .function_list .item.share:before {\n\tcontent: '\\ACF5\\C720\\D558\\AE30';\n\tposition: absolute;\n\toverflow: hidden;\n\twidth: 1px;\n\theight: 1px;\n\tmargin: -1px;\n\tclip: rect(0 0 0 0);\n}\n\n.api_common_viewer .content_info .function_list .item .num {\n\tdisplay: block;\n\toverflow: hidden;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\tfont-size: 12px;\n\tline-height: 15px;\n\tcolor: #ff323c;\n}\n\n.api_common_viewer .content_info .function_list .item .original {\n\tbackground-position: -37px -124px;\n\twidth: 20px;\n\theight: 20px;\n\tmargin-top: 1px;\n}\n\n.api_common_viewer .content_info .function_list .item .close {\n\tbackground-position: -82px -124px;\n\twidth: 18px;\n\theight: 18px;\n\tmargin-top: 1px;\n}\n\n.api_common_viewer .content_info .title {\n\tdisplay: block;\n\toverflow: hidden;\n\tfont-size: 13px;\n\tcolor: #00c73c;\n\tline-height: 20px;\n\ttext-shadow: 0 1px 0 rgba(0, 0, 0, 0.2);\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\tfont-weight: 600;\n}\n\n.api_common_viewer .content_info .view_relation_list {\n\tdisplay: none;\n\toverflow: hidden;\n\tposition: relative;\n\theight: 101px;\n}\n\n.api_common_viewer .content_info .view_relation_list .relation_inner {\n\toverflow-x: auto;\n\theight: 100%;\n\t-webkit-overflow-scrolling: touch;\n}\n\n.api_common_viewer .content_info .view_relation_list:before {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 20px;\n\tright: 20px;\n\theight: 1px;\n\tbackground: rgba(255, 255, 255, 0.2);\n\tcontent: '';\n}\n\n.api_common_viewer .content_info .view_relation_list .thumb_list {\n\tpadding: 0 0 5px 20px;\n\tfont-size: 0;\n\twhite-space: nowrap;\n}\n\n.api_common_viewer .content_info .view_relation_list .thumb_list li {\n\tdisplay: inline-block;\n\tposition: relative;\n\tpadding: 11px 0 5px;\n\tmargin-right: 5px;\n\tvertical-align: top;\n}\n\n.api_common_viewer .content_info .view_relation_list .thumb_list li.on {\n\tpadding-bottom: 3px;\n\tborder-bottom: 2px solid #0abe15;\n}\n\n.api_common_viewer .content_info .view_relation_list .thumb_list .thumb {\n\tdisplay: block;\n\toverflow: hidden;\n}\n\n.api_common_viewer .content_info .view_relation_list .thumb_list .thumb img {\n\theight: 80px;\n\tvertical-align: top;\n}\n\n.api_common_viewer.animation .group_info {\n\tdisplay: block;\n}\n\n.api_common_viewer.animation .header_info {\n\ttop: -48px;\n\t-webkit-transition: top 0.3s ease-out;\n\ttransition: top 0.3s ease-out;\n}\n\n.api_common_viewer.animation .header_info .layer_wrap {\n\ttop: -26px;\n\topacity: 0.01;\n\t-webkit-transition: top 0.3s ease-out, opacity 1s ease-out;\n\ttransition: top 0.3s ease-out, opacity 1s ease-out;\n}\n\n.api_common_viewer.animation .content_info {\n\tbottom: -190px;\n\t-webkit-transition: bottom 0.3s ease-out;\n\ttransition: bottom 0.3s ease-out;\n}\n\n.api_common_viewer.animation .btn_area .btn_prev {\n\tleft: -60px;\n\t-webkit-transition: left 0.3s ease-out;\n\ttransition: left 0.3s ease-out;\n}\n\n.api_common_viewer.animation .btn_area .btn_next {\n\tright: -60px;\n\t-webkit-transition: right 0.3s ease-out;\n\ttransition: right 0.3s ease-out;\n}\n\n.api_common_viewer.animation .group_info.is_show .header_info {\n\ttop: 0;\n}\n\n.api_common_viewer.animation .group_info.is_show .header_info .layer_wrap {\n\ttop: 47px;\n\topacity: 1;\n}\n\n.api_common_viewer.animation .group_info.is_show .content_info {\n\tbottom: 0 !important;\n}\n\n.api_common_viewer.animation .btn_area {\n\tdisplay: block;\n}\n\n.api_common_viewer.animation .btn_area.is_show .btn_prev {\n\tleft: 0;\n}\n\n.api_common_viewer.animation .btn_area.is_show .btn_next {\n\tright: 0;\n}\n\n/*  AU */\n._hero_animating {\n\tposition: fixed;\n\t-webkit-transform-origin: 0 0 0;\n\ttransform-origin: 0 0 0;\n\t-webkit-transition: -webkit-transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\ttransition: -webkit-transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\ttransition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\ttransition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, -webkit-transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\t-webkit-transform: translate3d(0, 0, 0) scale3d(1, 1, 1);\n\ttransform: translate3d(0, 0, 0) scale3d(1, 1, 1);\n\tz-index: 20020;\n}\n\n._hero_animating img {\n\t-webkit-transform-origin: 0 0 0;\n\ttransform-origin: 0 0 0;\n\t-webkit-transition: -webkit-transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\ttransition: -webkit-transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\ttransition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\ttransition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, -webkit-transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n\t-webkit-transform: translate3d(0, 0, 0) scale3d(1, 1, 1);\n\ttransform: translate3d(0, 0, 0) scale3d(1, 1, 1);\n}\n\n.css_ani .ani_slideup, .css_ani .ani_slidedown {\n\topacity: .001;\n}\n\n.css_ani .ani_slideup {\n\t-webkit-animation: slide-up-cards 300ms cubic-bezier(0.4, 0, 0.2, 1);\n\t-webkit-animation-fill-mode: both;\n}\n\n.css_ani .ani_slidedown {\n\t-webkit-animation: slide-down-cards 300ms cubic-bezier(0.4, 0, 0.2, 1);\n\t-webkit-animation-fill-mode: both;\n}\n\n@-webkit-keyframes slide-up-cards {\n\t0% {\n\t\topacity: .001;\n\t\t-webkit-transform: translate3d(0, 20px, 0);\n\t\t        transform: translate3d(0, 20px, 0);\n\t}\n\t99% {\n\t\t-webkit-transform: translate3d(0, 0, 0);\n\t\t        transform: translate3d(0, 0, 0);\n\t}\n\t100% {\n\t\topacity: 1;\n\t}\n}\n\n@keyframes slide-up-cards {\n\t0% {\n\t\topacity: .001;\n\t\t-webkit-transform: translate3d(0, 20px, 0);\n\t\t        transform: translate3d(0, 20px, 0);\n\t}\n\t99% {\n\t\t-webkit-transform: translate3d(0, 0, 0);\n\t\t        transform: translate3d(0, 0, 0);\n\t}\n\t100% {\n\t\topacity: 1;\n\t}\n}\n\n@-webkit-keyframes slide-down-cards {\n\t0% {\n\t\topacity: .001;\n\t\t-webkit-transform: translate3d(0, -20px, 0);\n\t\t        transform: translate3d(0, -20px, 0);\n\t}\n\t99% {\n\t\t-webkit-transform: translate3d(0, 0, 0);\n\t\t        transform: translate3d(0, 0, 0);\n\t}\n\t100% {\n\t\topacity: 1;\n\t}\n}\n\n@keyframes slide-down-cards {\n\t0% {\n\t\topacity: .001;\n\t\t-webkit-transform: translate3d(0, -20px, 0);\n\t\t        transform: translate3d(0, -20px, 0);\n\t}\n\t99% {\n\t\t-webkit-transform: translate3d(0, 0, 0);\n\t\t        transform: translate3d(0, 0, 0);\n\t}\n\t100% {\n\t\topacity: 1;\n\t}\n}\n\n.image360_fs_toggle:before {\n\tdisplay: none;\n}\n\n.image360_navigation {\n\tposition: absolute;\n\ttop: 0;\n\tbottom: 0;\n\tleft: auto;\n\tmargin: auto;\n}\n\n.image360_icon:before,\n.image360_loading,\n.image360_loading:before {\n\tcontent: \"\";\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: auto;\n}\n\n.image360_container {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n}\n\n.image360_preview {\n\tvertical-align: top;\n\theight: 100%;\n\twidth: 100%;\n\tbackground-color: #000;\n\t-webkit-background-size: cover;\n\t        background-size: cover;\n\tbackground-position: 50%;\n}\n\n.image360_wrapper .image360_container.is-default .image360_icon,\n.image360_wrapper .image360_container.is-loading .image360_loading,\n.image360_wrapper .image360_container.is-ready .image360_navigation {\n\tdisplay: block;\n}\n\n.image360_navigation {\n\tdisplay: none;\n\tright: 10px;\n\theight: 33px;\n\tz-index: 1;\n\tcursor: pointer;\n}\n\n/*  */\n.image360_navPie {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n}\n\n.image360_loading {\n\tdisplay: none;\n\twidth: 92px;\n\theight: 92px;\n\tz-index: 1;\n}\n\n.image360_loading .image360_loadingBar {\n\tdisplay: inline-block;\n\tposition: absolute;\n\tleft: 0;\n\tright: 0;\n\ttop: 64px;\n\twidth: 32px;\n\theight: 8px;\n\tmargin: auto;\n\tbackground-image: url(https://ssl.pstatic.net/static/m/common/viewer/common_loading_mo_white.gif);\n\tbackground-repeat: no-repeat;\n\t-webkit-background-size: 32px 8px;\n\t        background-size: 32px 8px;\n}\n\n.image360_loading:before {\n\tbackground-position: -90px 0px;\n\twidth: 88px;\n\theight: 88px;\n\tdisplay: inline-block;\n}\n\n.image360_icon {\n\tdisplay: none;\n\tz-index: 1;\n}\n\n.image360_icon:before {\n\tbackground-position: 0px 0px;\n\twidth: 88px;\n\theight: 88px;\n\tz-index: 1;\n\tdisplay: inline-block;\n}\n\n.image360_wrapper {\n\tposition: relative;\n}\n\n.image360_container > canvas {\n\tmargin: 0;\n}\n",""])},function(t,n,e){n=t.exports=e(3)(!1),n.push([t.i,".view_basic,\n.view_function{\n    position:absolute;\n    opacity:1;\n    transition-duration:200ms;\n    transition-property:opacity;\n    transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)\n}\n._toobar-hide{opacity:0;display:none}\n\n.f-panel .panzoom {\n    /*\n    jquery.panzoom \n    panzoom  width, height\n     width, height \n        panning.\n    */\n    width: 100%;\n    height: 100%;\n}\n.f-panel img{\n    /*\n    jquery.panzoom img div   div \n     'position: absolute'   'relative' .\n    */\n    position: relative;\n    max-width:100%;\n    max-height:100%;\n}\n.f-panel img._load{\n    -webkit-background-size:12px 12px;\n    background-size:12px 12px;\n    background:url(https://ssl.pstatic.net/static/m/common/viewer/bg_pattern.png) 0 0 repeat;\n}\n.f-panel img._err{\n    background:#f5f7f8 url(https://ssl.pstatic.net/sstatic/search/mobile/2015/bg_noimg_v1.png) no-repeat 50% 50%;\n    background-size:30px 25px;\n    -webkit-background-size:30px 25px\n}\n\n.api_common_viewer .content_info .view_basic .view_desc.no-dot .detail .txt + .txt:before,\n.api_common_viewer .content_info .view_basic.view_timeline .view_desc .detail{display:none}\n",""])},function(t,n,e){var i,o;/**
 * @license jquery.panzoom.js v3.2.2
 * Updated: Wed May 08 2019
 * Add pan and zoom functionality to any element
 * Copyright (c) timmy willison
 * Released under the MIT license
 * https://github.com/timmywil/jquery.panzoom/blob/master/MIT-License.txt
 */
!function(r,a){i=[e(1)],void 0!==(o=function(t){return a(r,t)}.apply(n,i))&&(t.exports=o)}("undefined"!=typeof window?window:this,function(t,n){"use strict";function e(t,n){for(var e=t.length;--e;)if(Math.round(+t[e])!==Math.round(+n[e]))return!1;return!0}function i(t){var e={range:!0,animate:!0};return"boolean"==typeof t?e.animate=t:n.extend(e,t),e}function o(t,e,i,o,r,a,s,l,c){"array"===n.type(t)?this.elements=[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]:this.elements=[t,e,i,o,r,a,s||0,l||0,c||1]}function r(t,n,e){this.elements=[t,n,e]}function a(t,e){if(!(this instanceof a))return new a(t,e);1!==t.nodeType&&n.error("Panzoom called on non-Element node"),n.contains(s,t)||n.error("Panzoom element must be attached to the document");var i=n.data(t,l);if(i)return i;this.options=e=n.extend({},a.defaults,e),this.elem=t;var o=this.$elem=n(t);this.$set=e.$set&&e.$set.length?e.$set:o,this.$doc=n(t.ownerDocument||s),this.$parent=o.parent(),this.parent=this.$parent[0],this.isSVG=f.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase(),this.panning=!1,this._buildTransform(),this._transform=n.cssProps.transform?n.cssProps.transform.replace(d,"-$1").toLowerCase():"transform",this._buildTransition(),this.resetDimensions();var r=n(),c=this;n.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,n){c[n]=e[n]||r}),this.enable(),this.scale=this.getMatrix()[0],this._checkPanWhenZoomed(),n.data(t,l,this)}var s=t.document,l="__pz__",c=Array.prototype.slice,h=/trident\/7./i,u=function(){if(h.test(navigator.userAgent))return!1;var t=s.createElement("input");return t.setAttribute("oninput","return"),"function"==typeof t.oninput}(),d=/([A-Z])/g,f=/^http:[\w\.\/]+svg$/,p="(\\-?\\d[\\d\\.e-]*)",m=new RegExp("^matrix\\("+p+"\\,?\\s*"+p+"\\,?\\s*"+p+"\\,?\\s*"+p+"\\,?\\s*"+p+"\\,?\\s*"+p+"\\)$");return o.prototype={x:function(t){var n=t instanceof r,e=this.elements,i=t.elements;return n&&3===i.length?new r(e[0]*i[0]+e[1]*i[1]+e[2]*i[2],e[3]*i[0]+e[4]*i[1]+e[5]*i[2],e[6]*i[0]+e[7]*i[1]+e[8]*i[2]):i.length===e.length&&new o(e[0]*i[0]+e[1]*i[3]+e[2]*i[6],e[0]*i[1]+e[1]*i[4]+e[2]*i[7],e[0]*i[2]+e[1]*i[5]+e[2]*i[8],e[3]*i[0]+e[4]*i[3]+e[5]*i[6],e[3]*i[1]+e[4]*i[4]+e[5]*i[7],e[3]*i[2]+e[4]*i[5]+e[5]*i[8],e[6]*i[0]+e[7]*i[3]+e[8]*i[6],e[6]*i[1]+e[7]*i[4]+e[8]*i[7],e[6]*i[2]+e[7]*i[5]+e[8]*i[8])},inverse:function(){var t=1/this.determinant(),n=this.elements;return new o(t*(n[8]*n[4]-n[7]*n[5]),t*-(n[8]*n[1]-n[7]*n[2]),t*(n[5]*n[1]-n[4]*n[2]),t*-(n[8]*n[3]-n[6]*n[5]),t*(n[8]*n[0]-n[6]*n[2]),t*-(n[5]*n[0]-n[3]*n[2]),t*(n[7]*n[3]-n[6]*n[4]),t*-(n[7]*n[0]-n[6]*n[1]),t*(n[4]*n[0]-n[3]*n[1]))},determinant:function(){var t=this.elements;return t[0]*(t[8]*t[4]-t[7]*t[5])-t[3]*(t[8]*t[1]-t[7]*t[2])+t[6]*(t[5]*t[1]-t[4]*t[2])}},r.prototype.e=o.prototype.e=function(t){return this.elements[t]},a.rmatrix=m,a.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,which:1,increment:.3,linearZoom:!1,panOnlyWhenZoomed:!1,minScale:.3,maxScale:6,rangeStep:.05,duration:200,easing:"ease-in-out",contain:!1},a.prototype={constructor:a,instance:function(){return this},enable:function(){this._initStyle(),this._bind(),this.disabled=!1},disable:function(){this.disabled=!0,this._resetStyle(),this._unbind()},isDisabled:function(){return this.disabled},destroy:function(){this.disable(),n.removeData(this.elem,l)},resetDimensions:function(){this.container=this.parent.getBoundingClientRect();var t=this.elem,e=t.getBoundingClientRect(),i=Math.abs(this.scale);this.dimensions={width:e.width,height:e.height,left:n.css(t,"left",!0)||0,top:n.css(t,"top",!0)||0,border:{top:n.css(t,"borderTopWidth",!0)*i||0,bottom:n.css(t,"borderBottomWidth",!0)*i||0,left:n.css(t,"borderLeftWidth",!0)*i||0,right:n.css(t,"borderRightWidth",!0)*i||0},margin:{top:n.css(t,"marginTop",!0)*i||0,left:n.css(t,"marginLeft",!0)*i||0}}},reset:function(t){t=i(t);var n=this.setMatrix(this._origTransform,t);t.silent||this._trigger("reset",n)},resetZoom:function(t){t=i(t);var n=this.getMatrix(this._origTransform);t.dValue=n[3],this.zoom(n[0],t)},resetPan:function(t){var n=this.getMatrix(this._origTransform);this.pan(n[4],n[5],i(t))},setTransform:function(t){for(var e=this.$set,i=e.length;i--;)n.style(e[i],"transform",t),this.isSVG&&e[i].setAttribute("transform",t)},getTransform:function(t){var e=this.$set,i=e[0];return t?this.setTransform(t):(t=n.style(i,"transform"),!this.isSVG||t&&"none"!==t||(t=n.attr(i,"transform")||"none")),"none"===t||m.test(t)||this.setTransform(t=n.css(i,"transform")),t||"none"},getMatrix:function(t){var n=m.exec(t||this.getTransform());return n&&n.shift(),n||[1,0,0,1,0,0]},getScale:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},setMatrix:function(t,e){if(!this.disabled){e||(e={}),"string"==typeof t&&(t=this.getMatrix(t));var i=this.getScale(t),o=void 0!==e.contain?e.contain:this.options.contain;if(o){var r=e.dims;r||(this.resetDimensions(),r=this.dimensions);var a,s,l,c=this.container,h=r.width,u=r.height,d=c.width,f=c.height,p=d/h,m=f/u;"center"!==this.$parent.css("textAlign")||"inline"!==n.css(this.elem,"display")?(l=(h-this.elem.offsetWidth)/2,a=l-r.border.left,s=h-d-l+r.border.right):a=s=(h-d)/2;var g=(u-f)/2+r.border.top,v=(u-f)/2-r.border.top-r.border.bottom;t[4]="invert"===o||"automatic"===o&&p<1.01?Math.max(Math.min(t[4],a-r.border.left),-s):Math.min(Math.max(t[4],a),-s),t[5]="invert"===o||"automatic"===o&&m<1.01?Math.max(Math.min(t[5],g-r.border.top),-v):Math.min(Math.max(t[5],g),-v)}if("skip"!==e.animate&&this.transition(!e.animate),e.range&&this.$zoomRange.val(i),this.options.disableXAxis||this.options.disableYAxis){var w=this.getMatrix();this.options.disableXAxis&&(t[4]=w[4]),this.options.disableYAxis&&(t[5]=w[5])}return this.setTransform("matrix("+t.join(",")+")"),this.scale=i,this._checkPanWhenZoomed(i),e.silent||this._trigger("change",t),t}},isPanning:function(){return this.panning},transition:function(t){if(this._transition)for(var e=t||!this.options.transition?"none":this._transition,i=this.$set,o=i.length;o--;)n.style(i[o],"transition")!==e&&n.style(i[o],"transition",e)},pan:function(t,n,e){if(!this.options.disablePan){e||(e={});var i=e.matrix;i||(i=this.getMatrix()),e.relative&&(t+=+i[4],n+=+i[5]),i[4]=t,i[5]=n,this.setMatrix(i,e),e.silent||this._trigger("pan",i[4],i[5])}},zoom:function(t,e){"object"==typeof t?(e=t,t=null):e||(e={});var i=n.extend({},this.options,e);if(!i.disableZoom){var a=!1,s=i.matrix||this.getMatrix(),l=new o(s),c=this.getScale(s);"number"!=typeof t?(t=i.linearZoom?1+i.increment*(t?-1:1)/c:t?1/(1+i.increment):1+i.increment,a=!0):t=1/c,t=Math.max(Math.min(t,i.maxScale/c),i.minScale/c);var h=l.x(new o(t,0,0,0,"number"==typeof i.dValue?i.dValue/c:t,0)),u=i.focal;if(u&&!i.disablePan){this.resetDimensions();var d=i.dims=this.dimensions,f=u.clientX,p=u.clientY;this.isSVG||(f-=d.width/c/2,p-=d.height/c/2);var m=new r(f,p,1),g=this.parentOffset||this.$parent.offset(),v=new o(1,0,g.left-this.$doc.scrollLeft(),0,1,g.top-this.$doc.scrollTop()),w=l.inverse().x(v.inverse().x(m));l=l.x(new o([t,0,0,t,0,0])),m=v.x(l.x(w)),s[4]=+s[4]+(f-m.e(0)),s[5]=+s[5]+(p-m.e(1))}s[0]=h.e(0),s[1]=h.e(3),s[2]=h.e(1),s[3]=h.e(4),this.setMatrix(s,{animate:void 0!==i.animate?i.animate:a,range:!i.noSetRange}),i.silent||this._trigger("zoom",t,i)}},option:function(t,e){var i;if(!t)return n.extend({},this.options);if("string"==typeof t){if(1===arguments.length)return void 0!==this.options[t]?this.options[t]:null;i={},i[t]=e}else i=t;this._setOptions(i)},_setOptions:function(t){n.each(t,n.proxy(function(t,e){switch(t){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind()}switch(this.options[t]=e,t){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[t]=e;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();break;case"cursor":n.style(this.elem,"cursor",e);break;case"minScale":this.$zoomRange.attr("min",e);break;case"maxScale":this.$zoomRange.attr("max",e);break;case"rangeStep":this.$zoomRange.attr("step",e);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();case"transition":this.transition();break;case"panOnlyWhenZoomed":this._checkPanWhenZoomed();break;case"$set":e instanceof n&&e.length&&(this.$set=e,this._initStyle(),this._buildTransform())}},this))},_checkPanWhenZoomed:function(t){var n=this.options;if(n.panOnlyWhenZoomed){t||(t=this.getMatrix()[0]);var e=t<=n.minScale;n.disablePan!==e&&this.option("disablePan",e)}},_initStyle:function(){var t={"transform-origin":this.isSVG?"0 0":"50% 50%"};this.options.disablePan||(t.cursor=this.options.cursor),this.$set.css(t);var e=this.$parent;e.length&&!n.nodeName(this.parent,"body")&&(t={overflow:"hidden"},"static"===e.css("position")&&(t.position="relative"),e.css(t))},_resetStyle:function(){this.$elem.css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this,e=this.options,i=e.eventNamespace,o="mousedown"+i+" pointerdown"+i+" MSPointerDown"+i,r="touchstart"+i+" "+o,s="touchend"+i+" click"+i+" pointerup"+i+" MSPointerUp"+i,l={},c=this.$reset,h=this.$zoomRange;if(n.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=e["on"+this];n.isFunction(t)&&(l["panzoom"+this.toLowerCase()+i]=t)}),e.disablePan&&e.disableZoom||(l[r]=function(n){var i;("touchstart"===n.type?!(i=n.touches||n.originalEvent.touches)||(1!==i.length||e.disablePan)&&2!==i.length:e.disablePan||(n.which||n.originalEvent.which)!==e.which)||(n.preventDefault(),n.stopPropagation(),t._startMove(n,i))},3===e.which&&(l.contextmenu=!1)),this.$elem.on(l),c.length&&c.on(s,function(n){n.preventDefault(),t.reset()}),h.length&&h.attr({step:e.rangeStep===a.defaults.rangeStep&&h.attr("step")||e.rangeStep,min:e.minScale,max:e.maxScale}).prop({value:this.getMatrix()[0]}),!e.disableZoom){var d=this.$zoomIn,f=this.$zoomOut;d.length&&f.length&&(d.on(s,function(n){n.preventDefault(),t.zoom()}),f.on(s,function(n){n.preventDefault(),t.zoom(!0)})),h.length&&(l={},l[o]=function(){t.transition(!0)},l[(u?"input":"change")+i]=function(){t.zoom(+this.value,{noSetRange:!0})},h.on(l))}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){if(this._transform){var t=this.options;this._transition=this._transform+" "+t.duration+"ms "+t.easing}},_getDistance:function(t){var n=t[0],e=t[1];return Math.sqrt(Math.pow(Math.abs(e.clientX-n.clientX),2)+Math.pow(Math.abs(e.clientY-n.clientY),2))},_getMiddle:function(t){var n=t[0],e=t[1];return{clientX:(e.clientX-n.clientX)/2+n.clientX,clientY:(e.clientY-n.clientY)/2+n.clientY}},_trigger:function(t){"string"==typeof t&&(t="panzoom"+t),this.$elem.triggerHandler(t,[this].concat(c.call(arguments,1)))},_startMove:function(t,i){if(!this.panning){var o,r,a,l,c,h,u,d,f=this,p=this.options,m=p.eventNamespace,g=this.getMatrix(),v=g.slice(0),w=+v[4],_=+v[5],b={matrix:g,animate:"skip"},x=t.type;"pointerdown"===x?(o="pointermove",r="pointerup"):"touchstart"===x?(o="touchmove",r="touchend"):"MSPointerDown"===x?(o="MSPointerMove",r="MSPointerUp"):(o="mousemove",r="mouseup"),o+=m,r+=m,this.transition(!0),this.panning=!0,this._trigger("start",t,i);var y=function(t,n){if(n){if(2===n.length){if(null!=a)return;return a=f._getDistance(n),l=f.getScale(g),void(c=f._getMiddle(n))}if(null!=h)return;(d=n[0])&&(h=d.pageX,u=d.pageY)}null==h&&(h=t.pageX,u=t.pageY)};y(t,i);var E=function(t){var n;if(t.preventDefault(),i=t.touches||t.originalEvent.touches,y(t,i),i){if(2===i.length){var e=f._getMiddle(i),o=f._getDistance(i)-a;return f.zoom(o*(p.increment/100)+l,{focal:e,matrix:g,animate:"skip"}),f.pan(+g[4]+e.clientX-c.clientX,+g[5]+e.clientY-c.clientY,b),void(c=e)}n=i[0]||{pageX:0,pageY:0}}n||(n=t),f.pan(w+n.pageX-h,_+n.pageY-u,b)};n(s).off(m).on(o,E).on(r,function(t){t.preventDefault(),n(this).off(m),f.panning=!1,t.type="panzoomend",f._trigger(t,g,!e(g,v))})}}},n.Panzoom=a,n.fn.panzoom=function(t){var e,i,o,r;return"string"==typeof t?(r=[],i=c.call(arguments,1),this.each(function(){e=n.data(this,l),e?"_"!==t.charAt(0)&&"function"==typeof(o=e[t])&&void 0!==(o=o.apply(e,i))&&r.push(o):r.push(void 0)}),r.length?1===r.length?r[0]:r:this):this.each(function(){new a(this,t)})},a})},function(t,n){t.exports=function(t){var n="undefined"!=typeof window&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var e=n.protocol+"//"+n.host,i=e+n.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,n){var o=n.trim().replace(/^"(.*)"$/,function(t,n){return n}).replace(/^'(.*)'$/,function(t,n){return n});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o))return t;var r;return r=0===o.indexOf("//")?o:0===o.indexOf("/")?e+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")"})}},function(t,n,e){(function(t,e){var i,o;!function(){var r="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},a=r._,s=Array.prototype,l=Object.prototype,c="undefined"!=typeof Symbol?Symbol.prototype:null,h=s.push,u=s.slice,d=l.toString,f=l.hasOwnProperty,p=Array.isArray,m=Object.keys,g=Object.create,v=function(){},w=function(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)};void 0===n||n.nodeType?r._=w:(void 0!==e&&!e.nodeType&&e.exports&&(n=e.exports=w),n._=w),w.VERSION="1.9.2";var _,b=function(t,n,e){if(void 0===n)return t;switch(null==e?3:e){case 1:return function(e){return t.call(n,e)};case 3:return function(e,i,o){return t.call(n,e,i,o)};case 4:return function(e,i,o,r){return t.call(n,e,i,o,r)}}return function(){return t.apply(n,arguments)}},x=function(t,n,e){return w.iteratee!==_?w.iteratee(t,n):null==t?w.identity:w.isFunction(t)?b(t,n,e):w.isObject(t)&&!w.isArray(t)?w.matcher(t):w.property(t)};w.iteratee=_=function(t,n){return x(t,n,1/0)};var y=function(t,n){return n=null==n?t.length-1:+n,function(){for(var e=Math.max(arguments.length-n,0),i=Array(e),o=0;o<e;o++)i[o]=arguments[o+n];switch(n){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var r=Array(n+1);for(o=0;o<n;o++)r[o]=arguments[o];return r[n]=i,t.apply(this,r)}},E=function(t){if(!w.isObject(t))return{};if(g)return g(t);v.prototype=t;var n=new v;return v.prototype=null,n},A=function(t){return function(n){return null==n?void 0:n[t]}},S=function(t,n){return null!=t&&f.call(t,n)},C=function(t,n){for(var e=n.length,i=0;i<e;i++){if(null==t)return;t=t[n[i]]}return e?t:void 0},T=Math.pow(2,53)-1,O=A("length"),R=function(t){var n=O(t);return"number"==typeof n&&n>=0&&n<=T};w.each=w.forEach=function(t,n,e){n=b(n,e);var i,o;if(R(t))for(i=0,o=t.length;i<o;i++)n(t[i],i,t);else{var r=w.keys(t);for(i=0,o=r.length;i<o;i++)n(t[r[i]],r[i],t)}return t},w.map=w.collect=function(t,n,e){n=x(n,e);for(var i=!R(t)&&w.keys(t),o=(i||t).length,r=Array(o),a=0;a<o;a++){var s=i?i[a]:a;r[a]=n(t[s],s,t)}return r};var M=function(t){var n=function(n,e,i,o){var r=!R(n)&&w.keys(n),a=(r||n).length,s=t>0?0:a-1;for(o||(i=n[r?r[s]:s],s+=t);s>=0&&s<a;s+=t){var l=r?r[s]:s;i=e(i,n[l],l,n)}return i};return function(t,e,i,o){var r=arguments.length>=3;return n(t,b(e,o,4),i,r)}};w.reduce=w.foldl=w.inject=M(1),w.reduceRight=w.foldr=M(-1),w.find=w.detect=function(t,n,e){var i=R(t)?w.findIndex:w.findKey,o=i(t,n,e);if(void 0!==o&&-1!==o)return t[o]},w.filter=w.select=function(t,n,e){var i=[];return n=x(n,e),w.each(t,function(t,e,o){n(t,e,o)&&i.push(t)}),i},w.reject=function(t,n,e){return w.filter(t,w.negate(x(n)),e)},w.every=w.all=function(t,n,e){n=x(n,e);for(var i=!R(t)&&w.keys(t),o=(i||t).length,r=0;r<o;r++){var a=i?i[r]:r;if(!n(t[a],a,t))return!1}return!0},w.some=w.any=function(t,n,e){n=x(n,e);for(var i=!R(t)&&w.keys(t),o=(i||t).length,r=0;r<o;r++){var a=i?i[r]:r;if(n(t[a],a,t))return!0}return!1},w.contains=w.includes=w.include=function(t,n,e,i){return R(t)||(t=w.values(t)),("number"!=typeof e||i)&&(e=0),w.indexOf(t,n,e)>=0},w.invoke=y(function(t,n,e){var i,o;return w.isFunction(n)?o=n:w.isArray(n)&&(i=n.slice(0,-1),n=n[n.length-1]),w.map(t,function(t){var r=o;if(!r){if(i&&i.length&&(t=C(t,i)),null==t)return;r=t[n]}return null==r?r:r.apply(t,e)})}),w.pluck=function(t,n){return w.map(t,w.property(n))},w.where=function(t,n){return w.filter(t,w.matcher(n))},w.findWhere=function(t,n){return w.find(t,w.matcher(n))},w.max=function(t,n,e){var i,o,r=-1/0,a=-1/0;if(null==n||"number"==typeof n&&"object"!=typeof t[0]&&null!=t){t=R(t)?t:w.values(t);for(var s=0,l=t.length;s<l;s++)null!=(i=t[s])&&i>r&&(r=i)}else n=x(n,e),w.each(t,function(t,e,i){((o=n(t,e,i))>a||o===-1/0&&r===-1/0)&&(r=t,a=o)});return r},w.min=function(t,n,e){var i,o,r=1/0,a=1/0;if(null==n||"number"==typeof n&&"object"!=typeof t[0]&&null!=t){t=R(t)?t:w.values(t);for(var s=0,l=t.length;s<l;s++)null!=(i=t[s])&&i<r&&(r=i)}else n=x(n,e),w.each(t,function(t,e,i){((o=n(t,e,i))<a||o===1/0&&r===1/0)&&(r=t,a=o)});return r},w.shuffle=function(t){return w.sample(t,1/0)},w.sample=function(t,n,e){if(null==n||e)return R(t)||(t=w.values(t)),t[w.random(t.length-1)];var i=R(t)?w.clone(t):w.values(t),o=O(i);n=Math.max(Math.min(n,o),0);for(var r=o-1,a=0;a<n;a++){var s=w.random(a,r),l=i[a];i[a]=i[s],i[s]=l}return i.slice(0,n)},w.sortBy=function(t,n,e){var i=0;return n=x(n,e),w.pluck(w.map(t,function(t,e,o){return{value:t,index:i++,criteria:n(t,e,o)}}).sort(function(t,n){var e=t.criteria,i=n.criteria;if(e!==i){if(e>i||void 0===e)return 1;if(e<i||void 0===i)return-1}return t.index-n.index}),"value")};var P=function(t,n){return function(e,i,o){var r=n?[[],[]]:{};return i=x(i,o),w.each(e,function(n,o){var a=i(n,o,e);t(r,n,a)}),r}};w.groupBy=P(function(t,n,e){S(t,e)?t[e].push(n):t[e]=[n]}),w.indexBy=P(function(t,n,e){t[e]=n}),w.countBy=P(function(t,n,e){S(t,e)?t[e]++:t[e]=1});var I=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;w.toArray=function(t){return t?w.isArray(t)?u.call(t):w.isString(t)?t.match(I):R(t)?w.map(t,w.identity):w.values(t):[]},w.size=function(t){return null==t?0:R(t)?t.length:w.keys(t).length},w.partition=P(function(t,n,e){t[e?0:1].push(n)},!0),w.first=w.head=w.take=function(t,n,e){return null==t||t.length<1?null==n?void 0:[]:null==n||e?t[0]:w.initial(t,t.length-n)},w.initial=function(t,n,e){return u.call(t,0,Math.max(0,t.length-(null==n||e?1:n)))},w.last=function(t,n,e){return null==t||t.length<1?null==n?void 0:[]:null==n||e?t[t.length-1]:w.rest(t,Math.max(0,t.length-n))},w.rest=w.tail=w.drop=function(t,n,e){return u.call(t,null==n||e?1:n)},w.compact=function(t){return w.filter(t,Boolean)};var V=function(t,n,e,i){i=i||[];for(var o=i.length,r=0,a=O(t);r<a;r++){var s=t[r];if(R(s)&&(w.isArray(s)||w.isArguments(s)))if(n)for(var l=0,c=s.length;l<c;)i[o++]=s[l++];else V(s,n,e,i),o=i.length;else e||(i[o++]=s)}return i};w.flatten=function(t,n){return V(t,n,!1)},w.without=y(function(t,n){return w.difference(t,n)}),w.uniq=w.unique=function(t,n,e,i){w.isBoolean(n)||(i=e,e=n,n=!1),null!=e&&(e=x(e,i));for(var o=[],r=[],a=0,s=O(t);a<s;a++){var l=t[a],c=e?e(l,a,t):l;n&&!e?(a&&r===c||o.push(l),r=c):e?w.contains(r,c)||(r.push(c),o.push(l)):w.contains(o,l)||o.push(l)}return o},w.union=y(function(t){return w.uniq(V(t,!0,!0))}),w.intersection=function(t){for(var n=[],e=arguments.length,i=0,o=O(t);i<o;i++){var r=t[i];if(!w.contains(n,r)){var a;for(a=1;a<e&&w.contains(arguments[a],r);a++);a===e&&n.push(r)}}return n},w.difference=y(function(t,n){return n=V(n,!0,!0),w.filter(t,function(t){return!w.contains(n,t)})}),w.unzip=function(t){for(var n=t&&w.max(t,O).length||0,e=Array(n),i=0;i<n;i++)e[i]=w.pluck(t,i);return e},w.zip=y(w.unzip),w.object=function(t,n){for(var e={},i=0,o=O(t);i<o;i++)n?e[t[i]]=n[i]:e[t[i][0]]=t[i][1];return e};var N=function(t){return function(n,e,i){e=x(e,i);for(var o=O(n),r=t>0?0:o-1;r>=0&&r<o;r+=t)if(e(n[r],r,n))return r;return-1}};w.findIndex=N(1),w.findLastIndex=N(-1),w.sortedIndex=function(t,n,e,i){e=x(e,i,1);for(var o=e(n),r=0,a=O(t);r<a;){var s=Math.floor((r+a)/2);e(t[s])<o?r=s+1:a=s}return r};var z=function(t,n,e){return function(i,o,r){var a=0,s=O(i);if("number"==typeof r)t>0?a=r>=0?r:Math.max(r+s,a):s=r>=0?Math.min(r+1,s):r+s+1;else if(e&&r&&s)return r=e(i,o),i[r]===o?r:-1;if(o!==o)return r=n(u.call(i,a,s),w.isNaN),r>=0?r+a:-1;for(r=t>0?a:s-1;r>=0&&r<s;r+=t)if(i[r]===o)return r;return-1}};w.indexOf=z(1,w.findIndex,w.sortedIndex),w.lastIndexOf=z(-1,w.findLastIndex),w.range=function(t,n,e){null==n&&(n=t||0,t=0),e||(e=n<t?-1:1);for(var i=Math.max(Math.ceil((n-t)/e),0),o=Array(i),r=0;r<i;r++,t+=e)o[r]=t;return o},w.chunk=function(t,n){if(null==n||n<1)return[];for(var e=[],i=0,o=t.length;i<o;)e.push(u.call(t,i,i+=n));return e};var q=function(t,n,e,i,o){if(!(i instanceof n))return t.apply(e,o);var r=E(t.prototype),a=t.apply(r,o);return w.isObject(a)?a:r};w.bind=y(function(t,n,e){if(!w.isFunction(t))throw new TypeError("Bind must be called on a function");var i=y(function(o){return q(t,i,n,this,e.concat(o))});return i}),w.partial=y(function(t,n){var e=w.partial.placeholder,i=function(){for(var o=0,r=n.length,a=Array(r),s=0;s<r;s++)a[s]=n[s]===e?arguments[o++]:n[s];for(;o<arguments.length;)a.push(arguments[o++]);return q(t,i,this,this,a)};return i}),w.partial.placeholder=w,w.bindAll=y(function(t,n){n=V(n,!1,!1);var e=n.length;if(e<1)throw new Error("bindAll must be passed function names");for(;e--;){var i=n[e];t[i]=w.bind(t[i],t)}}),w.memoize=function(t,n){var e=function(i){var o=e.cache,r=""+(n?n.apply(this,arguments):i);return S(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return e.cache={},e},w.delay=y(function(t,n,e){return setTimeout(function(){return t.apply(null,e)},n)}),w.defer=w.partial(w.delay,w,1),w.throttle=function(t,n,e){var i,o,r,a,s=0;e||(e={});var l=function(){s=!1===e.leading?0:w.now(),i=null,a=t.apply(o,r),i||(o=r=null)},c=function(){var c=w.now();s||!1!==e.leading||(s=c);var h=n-(c-s);return o=this,r=arguments,h<=0||h>n?(i&&(clearTimeout(i),i=null),s=c,a=t.apply(o,r),i||(o=r=null)):i||!1===e.trailing||(i=setTimeout(l,h)),a};return c.cancel=function(){clearTimeout(i),s=0,i=o=r=null},c},w.debounce=function(t,n,e){var i,o,r=function(n,e){i=null,e&&(o=t.apply(n,e))},a=y(function(a){if(i&&clearTimeout(i),e){var s=!i;i=setTimeout(r,n),s&&(o=t.apply(this,a))}else i=w.delay(r,n,this,a);return o});return a.cancel=function(){clearTimeout(i),i=null},a},w.wrap=function(t,n){return w.partial(n,t)},w.negate=function(t){return function(){return!t.apply(this,arguments)}},w.compose=function(){var t=arguments,n=t.length-1;return function(){for(var e=n,i=t[n].apply(this,arguments);e--;)i=t[e].call(this,i);return i}},w.after=function(t,n){return function(){if(--t<1)return n.apply(this,arguments)}},w.before=function(t,n){var e;return function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=null),e}},w.once=w.partial(w.before,2),w.restArguments=y;var F=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],k=function(t,n){var e=L.length,i=t.constructor,o=w.isFunction(i)&&i.prototype||l,r="constructor";for(S(t,r)&&!w.contains(n,r)&&n.push(r);e--;)(r=L[e])in t&&t[r]!==o[r]&&!w.contains(n,r)&&n.push(r)};w.keys=function(t){if(!w.isObject(t))return[];if(m)return m(t);var n=[];for(var e in t)S(t,e)&&n.push(e);return F&&k(t,n),n},w.allKeys=function(t){if(!w.isObject(t))return[];var n=[];for(var e in t)n.push(e);return F&&k(t,n),n},w.values=function(t){for(var n=w.keys(t),e=n.length,i=Array(e),o=0;o<e;o++)i[o]=t[n[o]];return i},w.mapObject=function(t,n,e){n=x(n,e);for(var i=w.keys(t),o=i.length,r={},a=0;a<o;a++){var s=i[a];r[s]=n(t[s],s,t)}return r},w.pairs=function(t){for(var n=w.keys(t),e=n.length,i=Array(e),o=0;o<e;o++)i[o]=[n[o],t[n[o]]];return i},w.invert=function(t){for(var n={},e=w.keys(t),i=0,o=e.length;i<o;i++)n[t[e[i]]]=e[i];return n},w.functions=w.methods=function(t){var n=[];for(var e in t)w.isFunction(t[e])&&n.push(e);return n.sort()};var D=function(t,n){return function(e){var i=arguments.length;if(n&&(e=Object(e)),i<2||null==e)return e;for(var o=1;o<i;o++)for(var r=arguments[o],a=t(r),s=a.length,l=0;l<s;l++){var c=a[l];n&&void 0!==e[c]||(e[c]=r[c])}return e}};w.extend=D(w.allKeys),w.extendOwn=w.assign=D(w.keys),w.findKey=function(t,n,e){n=x(n,e);for(var i,o=w.keys(t),r=0,a=o.length;r<a;r++)if(i=o[r],n(t[i],i,t))return i};var U=function(t,n,e){return n in e};w.pick=y(function(t,n){var e={},i=n[0];if(null==t)return e;w.isFunction(i)?(n.length>1&&(i=b(i,n[1])),n=w.allKeys(t)):(i=U,n=V(n,!1,!1),t=Object(t));for(var o=0,r=n.length;o<r;o++){var a=n[o],s=t[a];i(s,a,t)&&(e[a]=s)}return e}),w.omit=y(function(t,n){var e,i=n[0];return w.isFunction(i)?(i=w.negate(i),n.length>1&&(e=n[1])):(n=w.map(V(n,!1,!1),String),i=function(t,e){return!w.contains(n,e)}),w.pick(t,i,e)}),w.defaults=D(w.allKeys,!0),w.create=function(t,n){var e=E(t);return n&&w.extendOwn(e,n),e},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,n){return n(t),t},w.isMatch=function(t,n){var e=w.keys(n),i=e.length;if(null==t)return!i;for(var o=Object(t),r=0;r<i;r++){var a=e[r];if(n[a]!==o[a]||!(a in o))return!1}return!0};var j,B;j=function(t,n,e,i){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return!1;if(t!==t)return n!==n;var o=typeof t;return("function"===o||"object"===o||"object"==typeof n)&&B(t,n,e,i)},B=function(t,n,e,i){t instanceof w&&(t=t._wrapped),n instanceof w&&(n=n._wrapped);var o=d.call(t);if(o!==d.call(n))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return c.valueOf.call(t)===c.valueOf.call(n)}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof n)return!1;var a=t.constructor,s=n.constructor;if(a!==s&&!(w.isFunction(a)&&a instanceof a&&w.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in n)return!1}e=e||[],i=i||[];for(var l=e.length;l--;)if(e[l]===t)return i[l]===n;if(e.push(t),i.push(n),r){if((l=t.length)!==n.length)return!1;for(;l--;)if(!j(t[l],n[l],e,i))return!1}else{var h,u=w.keys(t);if(l=u.length,w.keys(n).length!==l)return!1;for(;l--;)if(h=u[l],!S(n,h)||!j(t[h],n[h],e,i))return!1}return e.pop(),i.pop(),!0},w.isEqual=function(t,n){return j(t,n)},w.isEmpty=function(t){return null==t||(R(t)&&(w.isArray(t)||w.isString(t)||w.isArguments(t))?0===t.length:0===w.keys(t).length)},w.isElement=function(t){return!(!t||1!==t.nodeType)},w.isArray=p||function(t){return"[object Array]"===d.call(t)},w.isObject=function(t){var n=typeof t;return"function"===n||"object"===n&&!!t},w.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){w["is"+t]=function(n){return d.call(n)==="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(t){return S(t,"callee")});var W=r.document&&r.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof W&&(w.isFunction=function(t){return"function"==typeof t||!1}),w.isFinite=function(t){return!w.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},w.isNaN=function(t){return w.isNumber(t)&&isNaN(t)},w.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===d.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,n){if(!w.isArray(n))return S(t,n);for(var e=n.length,i=0;i<e;i++){var o=n[i];if(null==t||!f.call(t,o))return!1;t=t[o]}return!!e},w.noConflict=function(){return r._=a,this},w.identity=function(t){return t},w.constant=function(t){return function(){return t}},w.noop=function(){},w.property=function(t){return w.isArray(t)?function(n){return C(n,t)}:A(t)},w.propertyOf=function(t){return null==t?function(){}:function(n){return w.isArray(n)?C(t,n):t[n]}},w.matcher=w.matches=function(t){return t=w.extendOwn({},t),function(n){return w.isMatch(n,t)}},w.times=function(t,n,e){var i=Array(Math.max(0,t));n=b(n,e,1);for(var o=0;o<t;o++)i[o]=n(o);return i},w.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))},w.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Q=w.invert(H),Y=function(t){var n=function(n){return t[n]},e="(?:"+w.keys(t).join("|")+")",i=RegExp(e),o=RegExp(e,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(o,n):t}};w.escape=Y(H),w.unescape=Y(Q),w.result=function(t,n,e){w.isArray(n)||(n=[n]);var i=n.length;if(!i)return w.isFunction(e)?e.call(t):e;for(var o=0;o<i;o++){var r=null==t?void 0:t[n[o]];void 0===r&&(r=e,o=i),t=w.isFunction(r)?r.call(t):r}return t};var G=0;w.uniqueId=function(t){var n=++G+"";return t?t+n:n},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var $=/(.)^/,X={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Z=/\\|'|\r|\n|\u2028|\u2029/g,K=function(t){return"\\"+X[t]};w.template=function(t,n,e){!n&&e&&(n=e),n=w.defaults({},n,w.templateSettings);var i=RegExp([(n.escape||$).source,(n.interpolate||$).source,(n.evaluate||$).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(i,function(n,e,i,a,s){return r+=t.slice(o,s).replace(Z,K),o=s+n.length,e?r+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(r+="';\n"+a+"\n__p+='"),n}),r+="';\n",n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";var a;try{a=new Function(n.variable||"obj","_",r)}catch(t){throw t.source=r,t}var s=function(t){return a.call(this,t,w)};return s.source="function("+(n.variable||"obj")+"){\n"+r+"}",s},w.chain=function(t){var n=w(t);return n._chain=!0,n};var J=function(t,n){return t._chain?w(n).chain():n};w.mixin=function(t){return w.each(w.functions(t),function(n){var e=w[n]=t[n];w.prototype[n]=function(){var t=[this._wrapped];return h.apply(t,arguments),J(this,e.apply(w,t))}}),w},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=s[t];w.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],J(this,e)}}),w.each(["concat","join","slice"],function(t){var n=s[t];w.prototype[t]=function(){return J(this,n.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return String(this._wrapped)},i=[],void 0!==(o=function(){return w}.apply(n,i))&&(e.exports=o)}()}).call(n,e(5),e(27)(t))},function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,n){t.exports='(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module \'"+o+"\'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\nif (typeof Object.create === \'function\') {\n  // implementation from standard node.js \'util\' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n},{}],2:[function(_dereq_,module,exports){\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n\'use strict\';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError(\'Object.assign cannot be called with null or undefined\');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String(\'abc\');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = \'de\';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === \'5\') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2[\'_\' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join(\'\') !== \'0123456789\') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t\'abcdefghijklmnopqrst\'.split(\'\').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join(\'\') !==\n\t\t\t\t\'abcdefghijklmnopqrst\') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don\'t expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],3:[function(_dereq_,module,exports){\n/*!\n* screenfull\n* v3.0.2 - 2017-03-13\n* (c) Sindre Sorhus; MIT License\n*/\n(function () {\n\t\'use strict\';\n\n\tvar isCommonjs = typeof module !== \'undefined\' && module.exports;\n\tvar keyboardAllowed = typeof Element !== \'undefined\' && \'ALLOW_KEYBOARD_INPUT\' in Element;\n\n\tvar fn = (function () {\n\t\tvar val;\n\n\t\tvar fnMap = [\n\t\t\t[\n\t\t\t\t\'requestFullscreen\',\n\t\t\t\t\'exitFullscreen\',\n\t\t\t\t\'fullscreenElement\',\n\t\t\t\t\'fullscreenEnabled\',\n\t\t\t\t\'fullscreenchange\',\n\t\t\t\t\'fullscreenerror\'\n\t\t\t],\n\t\t\t// new WebKit\n\t\t\t[\n\t\t\t\t\'webkitRequestFullscreen\',\n\t\t\t\t\'webkitExitFullscreen\',\n\t\t\t\t\'webkitFullscreenElement\',\n\t\t\t\t\'webkitFullscreenEnabled\',\n\t\t\t\t\'webkitfullscreenchange\',\n\t\t\t\t\'webkitfullscreenerror\'\n\n\t\t\t],\n\t\t\t// old WebKit (Safari 5.1)\n\t\t\t[\n\t\t\t\t\'webkitRequestFullScreen\',\n\t\t\t\t\'webkitCancelFullScreen\',\n\t\t\t\t\'webkitCurrentFullScreenElement\',\n\t\t\t\t\'webkitCancelFullScreen\',\n\t\t\t\t\'webkitfullscreenchange\',\n\t\t\t\t\'webkitfullscreenerror\'\n\n\t\t\t],\n\t\t\t[\n\t\t\t\t\'mozRequestFullScreen\',\n\t\t\t\t\'mozCancelFullScreen\',\n\t\t\t\t\'mozFullScreenElement\',\n\t\t\t\t\'mozFullScreenEnabled\',\n\t\t\t\t\'mozfullscreenchange\',\n\t\t\t\t\'mozfullscreenerror\'\n\t\t\t],\n\t\t\t[\n\t\t\t\t\'msRequestFullscreen\',\n\t\t\t\t\'msExitFullscreen\',\n\t\t\t\t\'msFullscreenElement\',\n\t\t\t\t\'msFullscreenEnabled\',\n\t\t\t\t\'MSFullscreenChange\',\n\t\t\t\t\'MSFullscreenError\'\n\t\t\t]\n\t\t];\n\n\t\tvar i = 0;\n\t\tvar l = fnMap.length;\n\t\tvar ret = {};\n\n\t\tfor (; i < l; i++) {\n\t\t\tval = fnMap[i];\n\t\t\tif (val && val[1] in document) {\n\t\t\t\tfor (i = 0; i < val.length; i++) {\n\t\t\t\t\tret[fnMap[0][i]] = val[i];\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t})();\n\n\tvar screenfull = {\n\t\trequest: function (elem) {\n\t\t\tvar request = fn.requestFullscreen;\n\n\t\t\telem = elem || document.documentElement;\n\n\t\t\t// Work around Safari 5.1 bug: reports support for\n\t\t\t// keyboard in fullscreen even though it doesn\'t.\n\t\t\t// Browser sniffing, since the alternative with\n\t\t\t// setTimeout is even worse.\n\t\t\tif (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n\t\t\t\telem[request]();\n\t\t\t} else {\n\t\t\t\telem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n\t\t\t}\n\t\t},\n\t\texit: function () {\n\t\t\tdocument[fn.exitFullscreen]();\n\t\t},\n\t\ttoggle: function (elem) {\n\t\t\tif (this.isFullscreen) {\n\t\t\t\tthis.exit();\n\t\t\t} else {\n\t\t\t\tthis.request(elem);\n\t\t\t}\n\t\t},\n\t\tonchange: function (callback) {\n\t\t\tdocument.addEventListener(fn.fullscreenchange, callback, false);\n\t\t},\n\t\tonerror: function (callback) {\n\t\t\tdocument.addEventListener(fn.fullscreenerror, callback, false);\n\t\t},\n\t\traw: fn\n\t};\n\n\tif (!fn) {\n\t\tif (isCommonjs) {\n\t\t\tmodule.exports = false;\n\t\t} else {\n\t\t\twindow.screenfull = false;\n\t\t}\n\n\t\treturn;\n\t}\n\n\tObject.defineProperties(screenfull, {\n\t\tisFullscreen: {\n\t\t\tget: function () {\n\t\t\t\treturn Boolean(document[fn.fullscreenElement]);\n\t\t\t}\n\t\t},\n\t\telement: {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\treturn document[fn.fullscreenElement];\n\t\t\t}\n\t\t},\n\t\tenabled: {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\t// Coerce to boolean in case of old WebKit\n\t\t\t\treturn Boolean(document[fn.fullscreenEnabled]);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (isCommonjs) {\n\t\tmodule.exports = screenfull;\n\t} else {\n\t\twindow.screenfull = screenfull;\n\t}\n})();\n\n},{}],4:[function(_dereq_,module,exports){\n/*\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar MathUtil = window.MathUtil || {};\n\nMathUtil.degToRad = Math.PI / 180;\nMathUtil.radToDeg = 180 / Math.PI;\n\n// Some minimal math functionality borrowed from THREE.Math and stripped down\n// for the purposes of this library.\n\n\nMathUtil.Vector2 = function ( x, y ) {\n  this.x = x || 0;\n  this.y = y || 0;\n};\n\nMathUtil.Vector2.prototype = {\n  constructor: MathUtil.Vector2,\n\n  set: function ( x, y ) {\n    this.x = x;\n    this.y = y;\n\n    return this;\n  },\n\n  copy: function ( v ) {\n    this.x = v.x;\n    this.y = v.y;\n\n    return this;\n  },\n\n  subVectors: function ( a, b ) {\n    this.x = a.x - b.x;\n    this.y = a.y - b.y;\n\n    return this;\n  },\n};\n\nMathUtil.Vector3 = function ( x, y, z ) {\n  this.x = x || 0;\n  this.y = y || 0;\n  this.z = z || 0;\n};\n\nMathUtil.Vector3.prototype = {\n  constructor: MathUtil.Vector3,\n\n  set: function ( x, y, z ) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n\n    return this;\n  },\n\n  copy: function ( v ) {\n    this.x = v.x;\n    this.y = v.y;\n    this.z = v.z;\n\n    return this;\n  },\n\n  length: function () {\n    return Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n  },\n\n  normalize: function () {\n    var scalar = this.length();\n\n    if ( scalar !== 0 ) {\n      var invScalar = 1 / scalar;\n\n      this.multiplyScalar(invScalar);\n    } else {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n    }\n\n    return this;\n  },\n\n  multiplyScalar: function ( scalar ) {\n    this.x *= scalar;\n    this.y *= scalar;\n    this.z *= scalar;\n  },\n\n  applyQuaternion: function ( q ) {\n    var x = this.x;\n    var y = this.y;\n    var z = this.z;\n\n    var qx = q.x;\n    var qy = q.y;\n    var qz = q.z;\n    var qw = q.w;\n\n    // calculate quat * vector\n    var ix =  qw * x + qy * z - qz * y;\n    var iy =  qw * y + qz * x - qx * z;\n    var iz =  qw * z + qx * y - qy * x;\n    var iw = - qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    this.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n    this.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n    this.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n    return this;\n  },\n\n  dot: function ( v ) {\n    return this.x * v.x + this.y * v.y + this.z * v.z;\n  },\n\n  crossVectors: function ( a, b ) {\n    var ax = a.x, ay = a.y, az = a.z;\n    var bx = b.x, by = b.y, bz = b.z;\n\n    this.x = ay * bz - az * by;\n    this.y = az * bx - ax * bz;\n    this.z = ax * by - ay * bx;\n\n    return this;\n  },\n};\n\nMathUtil.Quaternion = function ( x, y, z, w ) {\n  this.x = x || 0;\n  this.y = y || 0;\n  this.z = z || 0;\n  this.w = ( w !== undefined ) ? w : 1;\n};\n\nMathUtil.Quaternion.prototype = {\n  constructor: MathUtil.Quaternion,\n\n  set: function ( x, y, z, w ) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.w = w;\n\n    return this;\n  },\n\n  copy: function ( quaternion ) {\n    this.x = quaternion.x;\n    this.y = quaternion.y;\n    this.z = quaternion.z;\n    this.w = quaternion.w;\n\n    return this;\n  },\n\n  setFromEulerXYZ: function( x, y, z ) {\n    var c1 = Math.cos( x / 2 );\n    var c2 = Math.cos( y / 2 );\n    var c3 = Math.cos( z / 2 );\n    var s1 = Math.sin( x / 2 );\n    var s2 = Math.sin( y / 2 );\n    var s3 = Math.sin( z / 2 );\n\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 + s1 * s2 * c3;\n    this.w = c1 * c2 * c3 - s1 * s2 * s3;\n\n    return this;\n  },\n\n  setFromEulerYXZ: function( x, y, z ) {\n    var c1 = Math.cos( x / 2 );\n    var c2 = Math.cos( y / 2 );\n    var c3 = Math.cos( z / 2 );\n    var s1 = Math.sin( x / 2 );\n    var s2 = Math.sin( y / 2 );\n    var s3 = Math.sin( z / 2 );\n\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 - s1 * s2 * c3;\n    this.w = c1 * c2 * c3 + s1 * s2 * s3;\n\n    return this;\n  },\n\n  setFromAxisAngle: function ( axis, angle ) {\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n    // assumes axis is normalized\n\n    var halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n    this.x = axis.x * s;\n    this.y = axis.y * s;\n    this.z = axis.z * s;\n    this.w = Math.cos( halfAngle );\n\n    return this;\n  },\n\n  multiply: function ( q ) {\n    return this.multiplyQuaternions( this, q );\n  },\n\n  multiplyQuaternions: function ( a, b ) {\n    // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n    var qax = a.x, qay = a.y, qaz = a.z, qaw = a.w;\n    var qbx = b.x, qby = b.y, qbz = b.z, qbw = b.w;\n\n    this.x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n    this.y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n    this.z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n    this.w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n    return this;\n  },\n\n  inverse: function () {\n    this.x *= -1;\n    this.y *= -1;\n    this.z *= -1;\n\n    this.normalize();\n\n    return this;\n  },\n\n  normalize: function () {\n    var l = Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n    if ( l === 0 ) {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n      this.w = 1;\n    } else {\n      l = 1 / l;\n\n      this.x = this.x * l;\n      this.y = this.y * l;\n      this.z = this.z * l;\n      this.w = this.w * l;\n    }\n\n    return this;\n  },\n\n  slerp: function ( qb, t ) {\n    if ( t === 0 ) return this;\n    if ( t === 1 ) return this.copy( qb );\n\n    var x = this.x, y = this.y, z = this.z, w = this.w;\n\n    // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n    var cosHalfTheta = w * qb.w + x * qb.x + y * qb.y + z * qb.z;\n\n    if ( cosHalfTheta < 0 ) {\n      this.w = - qb.w;\n      this.x = - qb.x;\n      this.y = - qb.y;\n      this.z = - qb.z;\n\n      cosHalfTheta = - cosHalfTheta;\n    } else {\n      this.copy( qb );\n    }\n\n    if ( cosHalfTheta >= 1.0 ) {\n      this.w = w;\n      this.x = x;\n      this.y = y;\n      this.z = z;\n\n      return this;\n    }\n\n    var halfTheta = Math.acos( cosHalfTheta );\n    var sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\n\n    if ( Math.abs( sinHalfTheta ) < 0.001 ) {\n      this.w = 0.5 * ( w + this.w );\n      this.x = 0.5 * ( x + this.x );\n      this.y = 0.5 * ( y + this.y );\n      this.z = 0.5 * ( z + this.z );\n\n      return this;\n    }\n\n    var ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n    ratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n    this.w = ( w * ratioA + this.w * ratioB );\n    this.x = ( x * ratioA + this.x * ratioB );\n    this.y = ( y * ratioA + this.y * ratioB );\n    this.z = ( z * ratioA + this.z * ratioB );\n\n    return this;\n  },\n\n  setFromUnitVectors: function () {\n    // http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\n    // assumes direction vectors vFrom and vTo are normalized\n\n    var v1, r;\n    var EPS = 0.000001;\n\n    return function ( vFrom, vTo ) {\n      if ( v1 === undefined ) v1 = new MathUtil.Vector3();\n\n      r = vFrom.dot( vTo ) + 1;\n\n      if ( r < EPS ) {\n        r = 0;\n\n        if ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n          v1.set( - vFrom.y, vFrom.x, 0 );\n        } else {\n          v1.set( 0, - vFrom.z, vFrom.y );\n        }\n      } else {\n        v1.crossVectors( vFrom, vTo );\n      }\n\n      this.x = v1.x;\n      this.y = v1.y;\n      this.z = v1.z;\n      this.w = r;\n\n      this.normalize();\n\n      return this;\n    }\n  }(),\n};\n\nmodule.exports = MathUtil;\n\n},{}],5:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar SensorSample = _dereq_(\'./sensor-sample.js\');\nvar MathUtil = _dereq_(\'../math-util.js\');\nvar Util = _dereq_(\'../util.js\');\n\n/**\n * An implementation of a simple complementary filter, which fuses gyroscope and\n * accelerometer data from the \'devicemotion\' event.\n *\n * Accelerometer data is very noisy, but stable over the long term.\n * Gyroscope data is smooth, but tends to drift over the long term.\n *\n * This fusion is relatively simple:\n * 1. Get orientation estimates from accelerometer by applying a low-pass filter\n *    on that data.\n * 2. Get orientation estimates from gyroscope by integrating over time.\n * 3. Combine the two estimates, weighing (1) in the long term, but (2) for the\n *    short term.\n */\nfunction ComplementaryFilter(kFilter) {\n  this.kFilter = kFilter;\n\n  // Raw sensor measurements.\n  this.currentAccelMeasurement = new SensorSample();\n  this.currentGyroMeasurement = new SensorSample();\n  this.previousGyroMeasurement = new SensorSample();\n\n  // Set default look direction to be in the correct direction.\n  if (Util.isIOS()) {\n    this.filterQ = new MathUtil.Quaternion(-1, 0, 0, 1);\n  } else {\n    this.filterQ = new MathUtil.Quaternion(1, 0, 0, 1);\n  }\n  this.previousFilterQ = new MathUtil.Quaternion();\n  this.previousFilterQ.copy(this.filterQ);\n\n  // Orientation based on the accelerometer.\n  this.accelQ = new MathUtil.Quaternion();\n  // Whether or not the orientation has been initialized.\n  this.isOrientationInitialized = false;\n  // Running estimate of gravity based on the current orientation.\n  this.estimatedGravity = new MathUtil.Vector3();\n  // Measured gravity based on accelerometer.\n  this.measuredGravity = new MathUtil.Vector3();\n\n  // Debug only quaternion of gyro-based orientation.\n  this.gyroIntegralQ = new MathUtil.Quaternion();\n}\n\nComplementaryFilter.prototype.addAccelMeasurement = function(vector, timestampS) {\n  this.currentAccelMeasurement.set(vector, timestampS);\n};\n\nComplementaryFilter.prototype.addGyroMeasurement = function(vector, timestampS) {\n  this.currentGyroMeasurement.set(vector, timestampS);\n\n  var deltaT = timestampS - this.previousGyroMeasurement.timestampS;\n  if (Util.isTimestampDeltaValid(deltaT)) {\n    this.run_();\n  }\n\n  this.previousGyroMeasurement.copy(this.currentGyroMeasurement);\n};\n\nComplementaryFilter.prototype.run_ = function() {\n\n  if (!this.isOrientationInitialized) {\n    this.accelQ = this.accelToQuaternion_(this.currentAccelMeasurement.sample);\n    this.previousFilterQ.copy(this.accelQ);\n    this.isOrientationInitialized = true;\n    return;\n  }\n  var deltaT = this.currentGyroMeasurement.timestampS -\n      this.previousGyroMeasurement.timestampS;\n\n  // Convert gyro rotation vector to a quaternion delta.\n  var gyroDeltaQ = this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample, deltaT);\n  this.gyroIntegralQ.multiply(gyroDeltaQ);\n\n  // filter_1 = K * (filter_0 + gyro * dT) + (1 - K) * accel.\n  this.filterQ.copy(this.previousFilterQ);\n  this.filterQ.multiply(gyroDeltaQ);\n\n  // Calculate the delta between the current estimated gravity and the real\n  // gravity vector from accelerometer.\n  var invFilterQ = new MathUtil.Quaternion();\n  invFilterQ.copy(this.filterQ);\n  invFilterQ.inverse();\n\n  this.estimatedGravity.set(0, 0, -1);\n  this.estimatedGravity.applyQuaternion(invFilterQ);\n  this.estimatedGravity.normalize();\n\n  this.measuredGravity.copy(this.currentAccelMeasurement.sample);\n  this.measuredGravity.normalize();\n\n  // Compare estimated gravity with measured gravity, get the delta quaternion\n  // between the two.\n  var deltaQ = new MathUtil.Quaternion();\n  deltaQ.setFromUnitVectors(this.estimatedGravity, this.measuredGravity);\n  deltaQ.inverse();\n\n  if (Util.isDebug()) {\n    console.log(\'Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)\',\n                MathUtil.radToDeg * Util.getQuaternionAngle(deltaQ),\n                (this.estimatedGravity.x).toFixed(1),\n                (this.estimatedGravity.y).toFixed(1),\n                (this.estimatedGravity.z).toFixed(1),\n                (this.measuredGravity.x).toFixed(1),\n                (this.measuredGravity.y).toFixed(1),\n                (this.measuredGravity.z).toFixed(1));\n  }\n\n  // Calculate the SLERP target: current orientation plus the measured-estimated\n  // quaternion delta.\n  var targetQ = new MathUtil.Quaternion();\n  targetQ.copy(this.filterQ);\n  targetQ.multiply(deltaQ);\n\n  // SLERP factor: 0 is pure gyro, 1 is pure accel.\n  this.filterQ.slerp(targetQ, 1 - this.kFilter);\n\n  this.previousFilterQ.copy(this.filterQ);\n};\n\nComplementaryFilter.prototype.getOrientation = function() {\n  return this.filterQ;\n};\n\nComplementaryFilter.prototype.accelToQuaternion_ = function(accel) {\n  var normAccel = new MathUtil.Vector3();\n  normAccel.copy(accel);\n  normAccel.normalize();\n  var quat = new MathUtil.Quaternion();\n  quat.setFromUnitVectors(new MathUtil.Vector3(0, 0, -1), normAccel);\n  quat.inverse();\n  return quat;\n};\n\nComplementaryFilter.prototype.gyroToQuaternionDelta_ = function(gyro, dt) {\n  // Extract axis and angle from the gyroscope data.\n  var quat = new MathUtil.Quaternion();\n  var axis = new MathUtil.Vector3();\n  axis.copy(gyro);\n  axis.normalize();\n  quat.setFromAxisAngle(axis, gyro.length() * dt);\n  return quat;\n};\n\n\nmodule.exports = ComplementaryFilter;\n\n},{"../math-util.js":4,"../util.js":8,"./sensor-sample.js":7}],6:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar MathUtil = _dereq_(\'../math-util\');\nvar Util = _dereq_(\'../util\');\n\n/**\n * Given an orientation and the gyroscope data, predicts the future orientation\n * of the head. This makes rendering appear faster.\n *\n * Also see: http://msl.cs.uiuc.edu/~lavalle/papers/LavYerKatAnt14.pdf\n *\n * @param {Number} predictionTimeS time from head movement to the appearance of\n * the corresponding image.\n */\nfunction PosePredictor(predictionTimeS) {\n  this.predictionTimeS = predictionTimeS;\n\n  // The quaternion corresponding to the previous state.\n  this.previousQ = new MathUtil.Quaternion();\n  // Previous time a prediction occurred.\n  this.previousTimestampS = null;\n\n  // The delta quaternion that adjusts the current pose.\n  this.deltaQ = new MathUtil.Quaternion();\n  // The output quaternion.\n  this.outQ = new MathUtil.Quaternion();\n}\n\nPosePredictor.prototype.getPrediction = function(currentQ, gyro, timestampS) {\n  if (!this.previousTimestampS) {\n    this.previousQ.copy(currentQ);\n    this.previousTimestampS = timestampS;\n    return currentQ;\n  }\n\n  // Calculate axis and angle based on gyroscope rotation rate data.\n  var axis = new MathUtil.Vector3();\n  axis.copy(gyro);\n  axis.normalize();\n\n  var angularSpeed = gyro.length();\n\n  // If we\'re rotating slowly, don\'t do prediction.\n  if (angularSpeed < MathUtil.degToRad * 20) {\n    if (Util.isDebug()) {\n      console.log(\'Moving slowly, at %s deg/s: no prediction\',\n                  (MathUtil.radToDeg * angularSpeed).toFixed(1));\n    }\n    this.outQ.copy(currentQ);\n    this.previousQ.copy(currentQ);\n    return this.outQ;\n  }\n\n  // Get the predicted angle based on the time delta and latency.\n  var deltaT = timestampS - this.previousTimestampS;\n  var predictAngle = angularSpeed * this.predictionTimeS;\n\n  this.deltaQ.setFromAxisAngle(axis, predictAngle);\n  this.outQ.copy(this.previousQ);\n  this.outQ.multiply(this.deltaQ);\n\n  this.previousQ.copy(currentQ);\n  this.previousTimestampS = timestampS;\n\n  return this.outQ;\n};\n\n\nmodule.exports = PosePredictor;\n\n},{"../math-util":4,"../util":8}],7:[function(_dereq_,module,exports){\nfunction SensorSample(sample, timestampS) {\n  this.set(sample, timestampS);\n};\n\nSensorSample.prototype.set = function(sample, timestampS) {\n  this.sample = sample;\n  this.timestampS = timestampS;\n};\n\nSensorSample.prototype.copy = function(sensorSample) {\n  this.set(sensorSample.sample, sensorSample.timestampS);\n};\n\nmodule.exports = SensorSample;\n\n},{}],8:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar objectAssign = _dereq_(\'object-assign\');\n\nvar Util = window.Util || {};\n\nUtil.MIN_TIMESTEP = 0.001;\nUtil.MAX_TIMESTEP = 1;\n\nUtil.base64 = function(mimeType, base64) {\n  return \'data:\' + mimeType + \';base64,\' + base64;\n};\n\nUtil.clamp = function(value, min, max) {\n  return Math.min(Math.max(min, value), max);\n};\n\nUtil.lerp = function(a, b, t) {\n  return a + ((b - a) * t);\n};\n\nUtil.isIOS = (function() {\n  var isIOS = /iPad|iPhone|iPod/.test(navigator.platform);\n  return function() {\n    return isIOS;\n  };\n})();\n\nUtil.isSafari = (function() {\n  var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  return function() {\n    return isSafari;\n  };\n})();\n\nUtil.isFirefoxAndroid = (function() {\n  var isFirefoxAndroid = navigator.userAgent.indexOf(\'Firefox\') !== -1 &&\n      navigator.userAgent.indexOf(\'Android\') !== -1;\n  return function() {\n    return isFirefoxAndroid;\n  };\n})();\n\nUtil.isLandscapeMode = function() {\n  return (window.orientation == 90 || window.orientation == -90);\n};\n\n// Helper method to validate the time steps of sensor timestamps.\nUtil.isTimestampDeltaValid = function(timestampDeltaS) {\n  if (isNaN(timestampDeltaS)) {\n    return false;\n  }\n  if (timestampDeltaS <= Util.MIN_TIMESTEP) {\n    return false;\n  }\n  if (timestampDeltaS > Util.MAX_TIMESTEP) {\n    return false;\n  }\n  return true;\n};\n\nUtil.getScreenWidth = function() {\n  return Math.max(window.screen.width, window.screen.height) *\n      window.devicePixelRatio;\n};\n\nUtil.getScreenHeight = function() {\n  return Math.min(window.screen.width, window.screen.height) *\n      window.devicePixelRatio;\n};\n\nUtil.requestFullscreen = function(element) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  } else {\n    return false;\n  }\n\n  return true;\n};\n\nUtil.exitFullscreen = function() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen();\n  } else {\n    return false;\n  }\n\n  return true;\n};\n\nUtil.getFullscreenElement = function() {\n  return document.fullscreenElement ||\n      document.webkitFullscreenElement ||\n      document.mozFullScreenElement ||\n      document.msFullscreenElement;\n};\n\nUtil.linkProgram = function(gl, vertexSource, fragmentSource, attribLocationMap) {\n  // No error checking for brevity.\n  var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(vertexShader, vertexSource);\n  gl.compileShader(vertexShader);\n\n  var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n  gl.shaderSource(fragmentShader, fragmentSource);\n  gl.compileShader(fragmentShader);\n\n  var program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n\n  for (var attribName in attribLocationMap)\n    gl.bindAttribLocation(program, attribLocationMap[attribName], attribName);\n\n  gl.linkProgram(program);\n\n  gl.deleteShader(vertexShader);\n  gl.deleteShader(fragmentShader);\n\n  return program;\n};\n\nUtil.getProgramUniforms = function(gl, program) {\n  var uniforms = {};\n  var uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  var uniformName = \'\';\n  for (var i = 0; i < uniformCount; i++) {\n    var uniformInfo = gl.getActiveUniform(program, i);\n    uniformName = uniformInfo.name.replace(\'[0]\', \'\');\n    uniforms[uniformName] = gl.getUniformLocation(program, uniformName);\n  }\n  return uniforms;\n};\n\nUtil.orthoMatrix = function (out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right),\n      bt = 1 / (bottom - top),\n      nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n};\n\nUtil.isMobile = function() {\n  var check = false;\n  (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);\n  return check;\n};\n\nUtil.extend = objectAssign;\n\nUtil.safariCssSizeWorkaround = function(canvas) {\n  // TODO(smus): Remove this workaround when Safari for iOS is fixed.\n  // iOS only workaround (for https://bugs.webkit.org/show_bug.cgi?id=152556).\n  //\n  // "To the last I grapple with thee;\n  //  from hell\'s heart I stab at thee;\n  //  for hate\'s sake I spit my last breath at thee."\n  // -- Moby Dick, by Herman Melville\n  if (Util.isIOS()) {\n    var width = canvas.style.width;\n    var height = canvas.style.height;\n    canvas.style.width = (parseInt(width) + 1) + \'px\';\n    canvas.style.height = (parseInt(height)) + \'px\';\n    setTimeout(function() {\n      canvas.style.width = width;\n      canvas.style.height = height;\n    }, 100);\n  }\n\n  // Debug only.\n  window.Util = Util;\n  window.canvas = canvas;\n};\n\nUtil.isDebug = function() {\n  return Util.getQueryParameter(\'debug\');\n};\n\nUtil.getQueryParameter = function(name) {\n  var name = name.replace(/[\\[]/, "\\\\[").replace(/[\\]]/, "\\\\]");\n  var regex = new RegExp("[\\\\?&]" + name + "=([^&#]*)"),\n      results = regex.exec(location.search);\n  return results === null ? "" : decodeURIComponent(results[1].replace(/\\+/g, " "));\n};\n\nUtil.frameDataFromPose = (function() {\n  var piOver180 = Math.PI / 180.0;\n  var rad45 = Math.PI * 0.25;\n\n  // Borrowed from glMatrix.\n  function mat4_perspectiveFromFieldOfView(out, fov, near, far) {\n    var upTan = Math.tan(fov ? (fov.upDegrees * piOver180) : rad45),\n    downTan = Math.tan(fov ? (fov.downDegrees * piOver180) : rad45),\n    leftTan = Math.tan(fov ? (fov.leftDegrees * piOver180) : rad45),\n    rightTan = Math.tan(fov ? (fov.rightDegrees * piOver180) : rad45),\n    xScale = 2.0 / (leftTan + rightTan),\n    yScale = 2.0 / (upTan + downTan);\n\n    out[0] = xScale;\n    out[1] = 0.0;\n    out[2] = 0.0;\n    out[3] = 0.0;\n    out[4] = 0.0;\n    out[5] = yScale;\n    out[6] = 0.0;\n    out[7] = 0.0;\n    out[8] = -((leftTan - rightTan) * xScale * 0.5);\n    out[9] = ((upTan - downTan) * yScale * 0.5);\n    out[10] = far / (near - far);\n    out[11] = -1.0;\n    out[12] = 0.0;\n    out[13] = 0.0;\n    out[14] = (far * near) / (near - far);\n    out[15] = 0.0;\n    return out;\n  }\n\n  function mat4_fromRotationTranslation(out, q, v) {\n    // Quaternion math\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        xy = x * y2,\n        xz = x * z2,\n        yy = y * y2,\n        yz = y * z2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    out[0] = 1 - (yy + zz);\n    out[1] = xy + wz;\n    out[2] = xz - wy;\n    out[3] = 0;\n    out[4] = xy - wz;\n    out[5] = 1 - (xx + zz);\n    out[6] = yz + wx;\n    out[7] = 0;\n    out[8] = xz + wy;\n    out[9] = yz - wx;\n    out[10] = 1 - (xx + yy);\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n\n    return out;\n  };\n\n  function mat4_translate(out, a, v) {\n    var x = v[0], y = v[1], z = v[2],\n        a00, a01, a02, a03,\n        a10, a11, a12, a13,\n        a20, a21, a22, a23;\n\n    if (a === out) {\n      out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n      out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n      out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n      out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n    } else {\n      a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\n      a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\n      a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\n\n      out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\n      out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\n      out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\n\n      out[12] = a00 * x + a10 * y + a20 * z + a[12];\n      out[13] = a01 * x + a11 * y + a21 * z + a[13];\n      out[14] = a02 * x + a12 * y + a22 * z + a[14];\n      out[15] = a03 * x + a13 * y + a23 * z + a[15];\n    }\n\n    return out;\n  };\n\n  function mat4_invert(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n      return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n  };\n\n  var defaultOrientation = new Float32Array([0, 0, 0, 1]);\n  var defaultPosition = new Float32Array([0, 0, 0]);\n\n  function updateEyeMatrices(projection, view, pose, parameters, vrDisplay) {\n    mat4_perspectiveFromFieldOfView(projection, parameters ? parameters.fieldOfView : null, vrDisplay.depthNear, vrDisplay.depthFar);\n\n    var orientation = pose.orientation || defaultOrientation;\n    var position = pose.position || defaultPosition;\n\n    mat4_fromRotationTranslation(view, orientation, position);\n    if (parameters)\n      mat4_translate(view, view, parameters.offset);\n    mat4_invert(view, view);\n  }\n\n  return function(frameData, pose, vrDisplay) {\n    if (!frameData || !pose)\n      return false;\n\n    frameData.pose = pose;\n    frameData.timestamp = pose.timestamp;\n\n    updateEyeMatrices(\n        frameData.leftProjectionMatrix, frameData.leftViewMatrix,\n        pose, vrDisplay.getEyeParameters("left"), vrDisplay);\n    updateEyeMatrices(\n        frameData.rightProjectionMatrix, frameData.rightViewMatrix,\n        pose, vrDisplay.getEyeParameters("right"), vrDisplay);\n\n    return true;\n  };\n})();\n\nUtil.isInsideCrossDomainIFrame = function() {\n  var isFramed = (window.self !== window.top);\n  var refDomain = Util.getDomainFromUrl(document.referrer);\n  var thisDomain = Util.getDomainFromUrl(window.location.href);\n\n  return isFramed && (refDomain !== thisDomain);\n};\n\n// From http://stackoverflow.com/a/23945027.\nUtil.getDomainFromUrl = function(url) {\n  var domain;\n  // Find & remove protocol (http, ftp, etc.) and get domain.\n  if (url.indexOf("://") > -1) {\n    domain = url.split(\'/\')[2];\n  }\n  else {\n    domain = url.split(\'/\')[0];\n  }\n\n  //find & remove port number\n  domain = domain.split(\':\')[0];\n\n  return domain;\n}\n\nmodule.exports = Util;\n\n},{"object-assign":2}],9:[function(_dereq_,module,exports){\nvar util = _dereq_("./utils/math-util.js").util;\nvar glMatrix = _dereq_("./utils/math-util.js").glMatrix;\nvar quat = _dereq_("./utils/math-util.js").quat;\nvar vec3 = _dereq_("./utils/math-util.js").vec3\nvar ns = _dereq_("./eg.js");\nvar eg = ns.eg;\nvar inherits = _dereq_("inherits");\n\nvar ControlMode = _dereq_("./ControlMode");\n\nvar DeviceOrientationControls = _dereq_(\'./controls/DeviceOrientationControls.js\');\nvar PointerControls = _dereq_("./controls/PointerControls.js");\n\ninherits(ControlComposer, eg.Component);\n\nvar DELTA_THRESHOLD = 0.0375; // 2 \n\n// define custom events name\nvar EVENTS = {\n\tCHANGE: "change",\n};\n\nfunction ControlComposer(\n\ttargetElement,\n\toptions\n) {\n/*\n\t    \tinitialYaw: options.yaw || 0,\n\t    \tinitialPitch: options.pitch || 0,\n\t    \tfieldOfView: this.verticalFieldOfView,\n\t    \tcenterPolePoint: options.centerPolePoint || false,\n\t    \tcontrolMode: this.controlMode,\n\t\t\tallowPinchZoom: this.allowPinchZoom,\n\t\t\tminFieldOfView: options.minFieldOfView || MIN_FOV,\n\t\t\tmaxFieldOfView: options.maxFieldOfView || MAX_FOV\n\t\t\thorizontalAngleOfImage: config.horizontalAngleOfImage || 360,\n\t\t\tverticalAngleOfImage: config.verticalAngleOfImage || 180\n*/\n\tControlComposer.super_.call(this);\n\n\tthis.targetElement = targetElement;\n\tthis.controlMode = options.controlMode;\n\n\tthis._needDeviceOrientationControl= isNeedDeviceOrientationControl(options.controlMode);\n\tthis._needPointerControl = true;\n\n\tthis._quaternion = quat.create(); // \n\n\tthis.initialConfig = {\n\t\tyaw: options.initialYaw || 0,\n\t\tpitch: options.initialPitch || 0,\n\t\tfieldOfView: options.fieldOfView || 65,\n\t\tminFieldOfView: options.minFieldOfView,\n\t\tmaxFieldOfView: options.maxFieldOfView,\n\t\thorizontalAngleOfImage: options.horizontalAngleOfImage || 360,\n\t\tverticalAngleOfImage: options.verticalAngleOfImage || 180,\n\t\taspectRatio: options.aspectRatio\n\t};\n\n\tthis._deviceOrientationQ = quat.create();\n\tthis._yaw = this.initialConfig.yaw;\n\tthis._pitch = this.initialConfig.pitch;\n\n\tthis.fieldOfView = this.initialConfig.fieldOfView;\n\tthis.aspectRatio = this.initialConfig.aspectRatio;\n\n\tthis.verticalAngleOfImage = this.initialConfig.verticalAngleOfImage;\n\tthis.horizontalAngleOfImage = this.initialConfig.horizontalAngleOfImage;\n\n\tthis._isFirstDeltaReached = false;\n\n\tthis._centerPolePoint = options.centerPolePoint;\n\tthis._pitchMax = 90;\n\tthis._pitchMin = -90;\n\n\tthis._updatePitchRange(this._centerPolePoint, this.fieldOfView, this.verticalAngleOfImage);\n\n\tthis._yawMax = null;\n\tthis._yawMin = null;\n\n\tthis._updateYawRange(this.fieldOfView, this.aspectRatio, this.horizontalAngleOfImage)\n\n\t// controlMode   ControlModule \n\tif(this._needDeviceOrientationControl) {\n\t\tthis.deviceOrientationControls = new DeviceOrientationControls( options.controlMode, {\n\t\t\tinitialYaw: this.initialConfig.yaw,\n\t\t\tinitialPitch:  this.initialConfig.pitch,\n\t\t\tinitialFieldOfView: this.initialConfig.fieldOfView\n\t\t});\n\t}\n\n\tif(this._needPointerControl) {\n\t\tthis.pointerControls = new PointerControls(\n\t\t\ttargetElement,\n\t\t\t{\n\t\t\t\tinitialYaw: this.initialConfig.yaw,\n\t\t\t\tinitialPitch:  this.initialConfig.pitch,\n\t\t\t\tinitialFieldOfView: this.initialConfig.fieldOfView,\n\t\t\t\tcontrolMode: options.controlMode,\n\t\t\t\tallowPinchZoom: options.allowPinchZoom,\n\t\t\t\tminFieldOfView: options.minFieldOfView,\n\t\t\t\tmaxFieldOfView: options.maxFieldOfView\n\t\t\t}\n\t\t);\n\t}\n\n\t// bind event handler to controlModule\n\tthis._bindChangeHandler();\n};\n\nControlComposer.prototype.getAngleOfImage = function() {\n\treturn {\n\t\tverticalAngleOfImage: this.verticalAngleOfImage,\n\t\thorizontalAngleOfImage: this.horizontalAngleOfImage\n\t};\n};\n\nfunction isNeedDeviceOrientationControl(controlMode) {\n\treturn\tcontrolMode === ControlMode.VR ||\n\t\tcontrolMode === ControlMode.VR_YAW ||\n\t\tcontrolMode === ControlMode.GALLERY ||\n\t\tcontrolMode === ControlMode.GALLERY_YAW ||\n\t\tcontrolMode === ControlMode.GALLERY_PITCH ||\n\t\tcontrolMode === ControlMode.GALLERY_YAW_PITCH;\n}\n\nfunction isNeedPointerControl(controlMode) {\n\treturn controlMode === ControlMode.YAW ||\n\t\tcontrolMode === ControlMode.YAW_PITCH ||\n\t\tcontrolMode === ControlMode.VR_YAW ||\n\t\tcontrolMode === ControlMode.GALLERY_YAW ||\n\t\tcontrolMode === ControlMode.GALLERY_PITCH ||\n\t\tcontrolMode === ControlMode.GALLERY_YAW_PITCH;\n}\n\nControlComposer.prototype.setFieldOfViewRange = function(minFieldOfView, maxFieldOfView) {\n\tthis.pointerControls.setFieldOfViewRange(minFieldOfView, maxFieldOfView);\n};\n\nControlComposer.prototype._bindChangeHandler = function() {\n\tthis.pointerControls && this.pointerControls.on("change", this._onPointerChange.bind(this));\n\tthis.pointerControls && this.pointerControls.on("animationEnd", function(){\n\t\tthis.trigger("animationEnd");\n\t}.bind(this));\n\n\tthis.deviceOrientationControls && this.deviceOrientationControls.on("change", this._onDeviceOrientationChange.bind(this) );\n};\n\nControlComposer.prototype._onDeviceOrientationChange = function(e) {\n\tquat.copy( this._deviceOrientationQ, e.quaternion );\n\n\t//    \n\tvar deltaYaw = 0;\n\tvar deltaPitch = 0;\n\n\tif( Math.abs(e.deltaYaw) > DELTA_THRESHOLD && Math.abs(e.deltaYaw) < 15 ) {\n\t\tdeltaYaw = e.deltaYaw;\n\t}\n\tif( Math.abs(e.deltaPitch) > DELTA_THRESHOLD && Math.abs(e.deltaPitch) < 15) {\n\t\tdeltaPitch = e.deltaPitch;\n\t}\n\n\tif(!this._isFirstDeltaReached) {\n\t\tthis._isFirstDeltaReached = true;\n\t\tdeltaYaw = 0;\n\t\tdeltaPitch = 0;\n\t}\n\n\t// Yaw \n\t// this._yaw = this._yaw + deltaYaw;\n\n\t// if(this._yaw > 180) {\n\t// \tthis._yaw = this._yaw - 360;\n\t// } else if(this._yaw < -180) {\n\t// \tthis._yaw = this._yaw + 360;\n\t// }\n\t// TODO : onPointerChange      .\n\t\tif(this._yawMax === null && this._yawMin === null) {\n\t\t\tthis._yaw = this._yaw + deltaYaw;\n\t\t\tif(this._yaw > 180) {\n\t\t\t\tthis._yaw = this._yaw - 360;\n\t\t\t} else if(this._yaw < -180) {\n\t\t\t\tthis._yaw = this._yaw + 360;\n\t\t\t}\t\t\t\n\t\t} else { // yaw    \n\n\t\t\tif( this._yaw + deltaYaw < this._yawMax\n\t\t\t\t&& this._yaw + deltaYaw > this._yawMin ) {\n\t\t\t\tthis._yaw = this._yaw + deltaYaw;\n\t\t\t} else if ( this._yaw + deltaYaw >= this._yawMax ) {\n\t\t\t\tif(deltaYaw < 0) {\n\t\t\t\t\tthis._yaw = this._yawMax;\n\t\t\t\t}\n\t\t\t} else if ( this._yaw + deltaYaw <= this._yawMin ) {\t\n\t\t\t\tif(deltaYaw > 0) {\n\t\t\t\t\tthis._yaw = this._yawMin;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t// Pitch \n\t// TODO : onPointerChange      .\n\tif( this._pitch + deltaPitch < this._pitchMax\n\t\t&& this._pitch + deltaPitch > this._pitchMin ) {\n\t\tthis._pitch = this._pitch + deltaPitch;\n\t} else if ( this._pitch + deltaPitch >= this._pitchMax ) {\n\t\tif(deltaPitch < 0) {\n\t\t\tthis._pitch = this._pitch + deltaPitch;\n\t\t}\n\t} else if ( this._pitch + deltaPitch <= this._pitchMin ) {\n\t\tif(deltaPitch > 0) {\n\t\t\tthis._pitch = this._pitch + deltaPitch;\n\t\t}\n\t}\n\n\t// TODO : onPointerChange      .\n\tthis._updatePitchRange(this._centerPolePoint, this.fieldOfView, this.verticalAngleOfImage);\n\tthis._updateYawRange(this.fieldOfView, this.aspectRatio, this.horizontalAngleOfImage)\n\n\tthis._triggerChange();\n};\n\nControlComposer.prototype._onPointerChange = function(e) {\n\tif(this._ignoreDelta) {\n\t\tthis._yaw = e.yaw;\n\t} else {\n\t\tif ( Math.abs( e.deltaYaw ) > 45 ) {\n\t\t\treturn;\n\t\t} \n\n\t\t// yaw  360   \n\t\tif(this._yawMax === null && this._yawMin === null) {\n\t\t\tthis._yaw = this._yaw + e.deltaYaw;\n\t\t\tif(this._yaw > 180) {\n\t\t\t\tthis._yaw = this._yaw - 360;\n\t\t\t} else if(this._yaw < -180) {\n\t\t\t\tthis._yaw = this._yaw + 360;\n\t\t\t}\t\t\t\n\t\t} else { // yaw    \n\n\t\t\tif( this._yaw + e.deltaYaw < this._yawMax\n\t\t\t\t&& this._yaw + e.deltaYaw > this._yawMin ) {\n\t\t\t\tthis._yaw = this._yaw + e.deltaYaw;\n\t\t\t} else if ( this._yaw + e.deltaYaw >= this._yawMax ) {\n\t\t\t\tthis._yaw = this._yawMax;\n\t\t\t} else if ( this._yaw + e.deltaYaw <= this._yawMin ) {\t\n\t\t\t\tthis._yaw = this._yawMin;\n\t\t\t}\n\n\t\t}\n\t}\n\n\t// TODO   pitch  \n\t// yaw    ,         \n\n\tif(this._ignoreDelta) {\n\t\tthis._pitch = e.pitch;\n\t} else {\n\t\tif ( Math.abs( e.deltaPitch ) > 45 ) {\n\n\t\t} else {\n\t\t\tif( this._pitch + e.deltaPitch < this._pitchMax\n\t\t\t\t&& this._pitch + e.deltaPitch > this._pitchMin ) {\n\t\t\t\tif( this._pitch >= this._pitchMax\n\t\t\t\t\t|| this._pitch <= this._pitchMin ) {\n\t\t\t\t\t// PT   \n\t\t\t\t}\n\t\t\t\tthis._pitch = this._pitch + e.deltaPitch;\n\t\t\t} else if ( this._pitch + e.deltaPitch >= this._pitchMax ) {\n\t\t\t\tthis._pitch = this._pitchMax;\n\t\t\t} else if ( this._pitch + e.deltaPitch <= this._pitchMin ) {\t\t\t\t\n\t\t\t\tthis._pitch = this._pitchMin;\n\t\t\t}\n\t\t}\n\t}\n\n\tvar angleOfImage = this.getAngleOfImage();\n\tthis.fieldOfView = e.fieldOfView;\n\tif( angleOfImage.verticalAngleOfImage < e.fieldOfView ) {\n\t\tthis.fieldOfView = angleOfImage.verticalAngleOfImage;\n\t}\n\n\tthis._updatePitchRange(this._centerPolePoint, this.fieldOfView, this.verticalAngleOfImage);\n\tthis._updateYawRange(this.fieldOfView, this.aspectRatio, this.horizontalAngleOfImage)\n\n\tthis._triggerChange();\n};\n\nControlComposer.prototype._updatePitchRange = function(centerPolePoint, fieldOfView, verticalAngleOfImage) {\n\t// TODO:      . \n\tif(!centerPolePoint) {\n\t\tthis._pitchMax = 90 - fieldOfView / 2;;\n\t\tthis._pitchMin = -90 + fieldOfView / 2;\n\t}\n\t\n\tif(verticalAngleOfImage < 180) { //    \n\t\tvar halfVerticalAngleOfImage = verticalAngleOfImage / 2;\n\t\tthis._pitchMax = halfVerticalAngleOfImage - fieldOfView / 2;;\n\t\tthis._pitchMin = -1 * halfVerticalAngleOfImage + fieldOfView / 2;\n\t}\n};\n\nControlComposer.prototype.setAspectRatio = function(aspectRatio) {\n\tthis.aspectRatio = aspectRatio;\n};\n\n//         . \n//      ,        .\n// TODO:       map  .\nfunction adjustAspectRatio(input) {\n\tvar inputRange =  [0.520, 0.540, 0.563, 0.570, 0.584, 0.590, 0.609, 0.670, 0.702, 0.720, 0.760, 0.780, 0.820, 0.920, 0.970, 1.00, 1.07, 1.14,\n\t\t1.19, 1.25, 1.32, 1.38, 1.40, 1.43, 1.53, 1.62, 1.76, 1.77, 1.86, 1.96, 2.26, 2.30, 2.60, 3.00, 5.00, 6.00\n\t];\n\tvar outputRange = [0.510, 0.540, 0.606, 0.560, 0.628, 0.630, 0.647, 0.710, 0.736, 0.757, 0.780, 0.770, 0.800, 0.890, 0.975, 1.00, 1.07, 1.10,\n\t\t1.15, 1.18, 1.22, 1.27, 1.30, 1.33, 1.39, 1.45, 1.54, 1.55, 1.58, 1.62, 1.72, 1.82, 1.92, 2.00, 2.24, 2.30\n\t];\n\n\tvar rangeIdx = -1\n\tfor(var i = 0; i < inputRange.length - 1 ; i++) {\n\t\tif(inputRange[i] <= input && inputRange[i+1] >= input) {\n\t\t\trangeIdx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(rangeIdx === -1) {\n\t\tif(inputRange[0] > input)\n\t\t\treturn outputRange[0];\n\t\telse return outputRange[outputRange[0].length - 1];    \n\t}\n\n\tvar inputA = inputRange[rangeIdx];\n\tvar inputB = inputRange[rangeIdx + 1];\n\tvar outputA = outputRange[rangeIdx];\n\tvar outputB = outputRange[rangeIdx + 1];\n\n\treturn lerp(outputA, outputB, (input - inputA) / (inputB - inputA));\n}\n\nfunction lerp(a,  b, fraction) {\n    return a + fraction * (b - a);\n}\n\nControlComposer.prototype._updateYawRange = function(verticalFieldOfView, aspectRatio, horizontalAngleOfImage) {\n\taspectRatio = adjustAspectRatio(aspectRatio);\n\t\n\tvar horizontalFieldOfView = verticalFieldOfView * aspectRatio;\n\n\tif(horizontalAngleOfImage < 360) { //    \n\t\t//   290    \n\t\tif(horizontalAngleOfImage > 290) {\n\t\t\thorizontalAngleOfImage = 286;\n\t\t} else if (horizontalAngleOfImage > 125) {\n\t\t\thorizontalAngleOfImage = horizontalAngleOfImage * .98;\n\t\t}\n\t\tvar halfHorizontalAngleOfImage = horizontalAngleOfImage / 2;\n\t\tthis._yawMax = halfHorizontalAngleOfImage - horizontalFieldOfView / 2;;\n\t\tthis._yawMin = -1 * halfHorizontalAngleOfImage + horizontalFieldOfView / 2;\n\t}\n};\n\nControlComposer.prototype.setControlMode = function(controlMode, allowPinchZoom) {\n\tthis.controlMode = controlMode;\n\n\tvar _yaw = this._yaw = glMatrix.toDegree(util.extractYawFromQuat(this._quaternion));\n\tvar _pitch = this._pitch = glMatrix.toDegree(util.extractPitchFromQuat(this._quaternion));\n\n\tvar _fov = this.fieldOfView;\n\n\tthis._quaternion = quat.create();\n\n\tthis._deviceOrientationQ = quat.create();\n\n\tthis._needDeviceOrientationControl = isNeedDeviceOrientationControl(controlMode);\n\tthis._needPointerControl = isNeedPointerControl(controlMode);\n\n\t//  controlMode   control  destroy;\n\tif(this.deviceOrientationControls) {\n\t\tthis.deviceOrientationControls.disconnect();\n\t\tthis.deviceOrientationControls.destroy();\n\t\tthis.deviceOrientationControls = null;\n\t}\n\tif(this.pointerControls) {\n\t\tthis.pointerControls.destroy();\n\t\tthis.pointerControls = null;\n\t}\n\n\t//   \n\tif(this._needDeviceOrientationControl) {\n\t\tthis.deviceOrientationControls = new DeviceOrientationControls(controlMode, {\n\t\t\tinitialYaw: this.initialConfig.yaw,\n\t\t\tinitialPitch: this.initialConfig.pitch,\n\t\t});\n\n\t\tthis.deviceOrientationControls.connect();\n\t}\n\n\tif(this._needPointerControl) {\n\t\tthis.pointerControls = new PointerControls(\n\t\t\tthis.targetElement,\n\t\t\t{\n\t\t\t\tinitialYaw: this.initialConfig.yaw,\n\t\t\t\tinitialPitch: this.initialConfig.pitch,\n\t\t\t\tinitialFieldOfView: this.initialConfig.fieldOfView,\n\t\t\t\tcontrolMode: controlMode,\n\t\t\t\tallowPinchZoom: allowPinchZoom,\n\t\t\t\tminFieldOfView: this.initialConfig.minFieldOfView,\n\t\t\t\tmaxFieldOfView: this.initialConfig.maxFieldOfView\n\t\t\t}\n\t\t);\n\n\t\tthis.pointerControls.connect();\n\t\tthis.pointerControls.setTo({\n\t\t\tfieldOfView: this.fieldOfView\n\t\t}, 0);\n\t}\n\n\tthis._bindChangeHandler();\n\n\tthis._triggerChange();\n};\n\nControlComposer.prototype._triggerChange = function() {\n\tthis._update();\n\n\tvar event = {\n\t\tfieldOfView: this.fieldOfView,\n\t\tcontrolMode: this.controlMode,\n\t\ttargetElement: this.targetElement\n\t};\n\n\tevent.yaw = this.yaw = this._yaw;\n\tevent.pitch = this.pitch = this._pitch;\n\tevent.quaternion = this._quaternion;\n\n\tthis.trigger(EVENTS.CHANGE, event);\n};\n\nControlComposer.prototype.connect = function() {\n\tthis.pointerControls && this.pointerControls.connect();\n\tthis.deviceOrientationControls && this.deviceOrientationControls.connect();\n};\n\nControlComposer.prototype.resetOrientation = function() {\n\tthis._yaw = this.initialConfig.yaw;\n\tthis._pitch = this.initialConfig.pitch;\n\tthis.fieldOfView = this.initialConfig.fieldOfView;\n};\n\nControlComposer.prototype.disconnect = function(persistOrientation) {\n\tif(!persistOrientation) {\n\t\tthis.resetOrientation();\n\t}\n\n\t//      \n\tthis.pointerControls && this.pointerControls.disconnect();\n\tthis.deviceOrientationControls && this.deviceOrientationControls.disconnect();\n};\n\nControlComposer.prototype._update = function() {\n\tif(this.controlMode === ControlMode.VR) {\n\t\tthis._updateWithVR();\n\t} else if(this.controlMode === ControlMode.VR_YAW) {\n\t\tthis._updateWithVRYaw();\n\t} else {\n\t\tquat.copy(this._quaternion,\n\t\t\tutil.getQuaternionWithYawPitch(\n\t\t\t\tthis._yaw,\n\t\t\t\tthis._pitch\n\t\t\t)\n\t\t);\n\t}\n};\n\nControlComposer.prototype._updateWithYawPitch = function() {\n\tquat.copy(this._quaternion,\n\t\tutil.getQuaternionWithYawPitch(\n\t\t\tthis._yaw,\n\t\t\tthis._pitch\n\t\t)\n\t);\n};\n\nControlComposer.prototype._updateWithVRYawPitch = function() {\n\tvar baseQ = quat.create();\n\tquat.rotateY(baseQ, baseQ, glMatrix.toRadian(this._yaw));\n\tquat.multiply(baseQ, baseQ, this._deviceOrientationQ);\n\tquat.rotateX(baseQ, baseQ, glMatrix.toRadian(this._pitch));\n\tquat.copy( this._quaternion, baseQ );\n};\n\nControlComposer.prototype._updateWithVRYaw = function() {\n\tvar baseQ = quat.create();\n\tquat.rotateY(baseQ, baseQ, glMatrix.toRadian(this._yaw));\n\tquat.multiply(baseQ, baseQ, this._deviceOrientationQ);\n\tquat.rotateX(baseQ, baseQ, glMatrix.toRadian(this._pitch));\n\tquat.copy( this._quaternion, baseQ );\n};\n\nControlComposer.prototype._updateWithVR = function() {\n\tvar baseQ = quat.create();\n\tquat.multiply(baseQ, baseQ, this._deviceOrientationQ);\n\tquat.copy( this._quaternion, baseQ );\n};\n\nControlComposer.prototype.updateControlScale = function() {\n\tthis._updatePitchRange(this._centerPolePoint, this.fieldOfView, this.verticalAngleOfImage);\n\tthis._updateYawRange(this.fieldOfView, this.aspectRatio, this.horizontalAngleOfImage)\n\n\tif( this._pitch  < this._pitchMax\n\t\t&& this._pitch  > this._pitchMin ) {\n\t} else if ( this._pitch > this._pitchMax ) {\n\t\tthis._pitch = this._pitchMax;\n\t} else if ( this._pitch < this._pitchMin ) {\t\t\t\t\n\t\tthis._pitch = this._pitchMin;\n\t}\n\n\tif( this._yawMax && this._yawMin ) {\n\t\tif( this._yaw  < this._yawMax\n\t\t\t&& this._yaw  > this._yawMin ) {\n\t\t} else if ( this._yaw > this._yawMax ) {\n\t\t\tthis._yaw = this._yawMax;\n\t\t} else if ( this._yaw < this._yawMin ) {\t\t\t\t\n\t\t\tthis._yaw = this._yawMin;\n\t\t}\n\t}\n\tthis.pointerControls.updateMovableCoordScale();\n};\n\nControlComposer.prototype.lookAt = function(sphericalConfig, duration, noSkip) {\n\t// lookAt    \n\tif (this.isAnimating) {\n\t\treturn;\n\t}\n\n\t//    \n\tif (\n\t\tnoSkip === false &&\n\t\tquat.exactEquals(\n\t\t\tthis._quaternion,\n\t\t\tutil.getQuaternionWithYawPitch(\n\t\t\t\tsphericalConfig.yaw,\n\t\t\t\tsphericalConfig.pitch\n\t\t\t)\n\t\t) && sphericalConfig.fieldOfView === this.fieldOfView\n\t) {\n\t\treturn;\n\t}\n\n\tvar yaw = this._yaw;\n\tvar pitch = this._pitch;\n\tvar fov = this.fieldOfView;\n\n\t// TODO :   !\n\tthis._ignoreDelta = true;\n\n\tif(this.deviceOrientationControls) {\n\t\tthis._deviceOrientationQ = quat.create();\n\t}\n\n\t// TODO :     TC  .\n\t// !!    !! \n\tthis.pointerControls && this.pointerControls.setTo({\n\t\tyaw: yaw,\n\t\tpitch: pitch,\n\t\tfov: fov\n\t}, 0);\n\n\tthis._ignoreDelta = false;\n\n\tthis.pointerControls && this.pointerControls.setTo(sphericalConfig, duration);\n};\n\nControlComposer.prototype.destroy = function() {\n\tthis.pointerControls && this.pointerControls.destroy();\n\tthis.deviceOrientationControls && this.deviceOrientationControls.destroy();\n\n\tthis.pointerControls = null;\n\tthis.deviceOrientationControls = null;\n};\n\nmodule.exports = ControlComposer;\n\n},{"./ControlMode":10,"./controls/DeviceOrientationControls.js":16,"./controls/PointerControls.js":18,"./eg.js":19,"./utils/math-util.js":27,"inherits":1}],10:[function(_dereq_,module,exports){\nmodule.exports = {\n\tYAW_PITCH: "yaw_pitch",\n\tYAW: "yaw",\n\tVR: "vr",\n\tVR_YAW: "vr_yaw",\n\tGALLERY: "gallery",\n\tGALLERY_YAW: "gallery_yaw",\n\tGALLERY_PITCH: "gallery_pitch",\n\tGALLERY_YAW_PITCH: "gallery_yaw_pitch"\n};\n},{}],11:[function(_dereq_,module,exports){\n/**\n * @fileoverview inherits\n * @author isaacs\n * @version 2.0.1\n */\n\n/* The ISC License\n\nCopyright (c) Isaac Z. Schlueter\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted, provided that the above\ncopyright notice and this permission notice appear in all copies.\n\nTHE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE. */\n\n\n\'use strict\';\nvar util = _dereq_("./utils/math-util.js").util;\nvar vec3 = _dereq_("./utils/math-util.js").vec3;\nvar quat = _dereq_("./utils/math-util.js").quat;\nvar glMatrix = _dereq_("./utils/math-util.js").glMatrix;\nvar objectAssign = _dereq_(\'object-assign\');\n\nvar ns = _dereq_("./eg.js");\nvar eg = ns.eg;\nvar Agent = eg.agent();\n\nvar inherits = _dereq_("inherits");\n\nvar PhotoSphereRenderer = _dereq_("./PhotoSphereRenderer.js");\nvar ControlComposer = _dereq_("./ControlComposer.js");\nvar ProjectionType = _dereq_("./ProjectionType.js");\nvar ControlMode = _dereq_("./ControlMode");\nvar consts = _dereq_("./consts");\n\ninherits(Photo360Viewer, eg.Component);\n\n// TODO: resume  resume \n// suspend  suspend     \n\n// define custom events name\nvar EVENTS = {\n\tRESUMESTART: "resumestart",\n\tRESUME: "resume",\n\tSUSPEND: "suspend",\n\tIMAGE_LOADED: "imageLoaded",\n\tVIEWPORT_CHANGE: "viewportChange",\n\tANIMATION_END: "animationEnd",\n\tERROR: "error",\n\tINIT: "init"\n};\n\n/**\n * @class\n * @name Photo360Viewer\n * @extends eg.Component\n *\n * @param {HTMLElement} rootNode    \n * @param {Object} config -      \n * @param {String|Element} config.image - 360   url ,    img \n * @param {Number} [config.width=rootNode  width] -     (px)\n * @param {Number} [config.height=rootNode  height] -     (px)\n * @param {String} [config.controlMode=gallery_yaw_pitch] -   \n * @param {Number} [config.fieldOfView=65] -  field of view (degree)\n * @param {Number} [config.yaw=0] -   yaw  (degree)\n * @param {Number} [config.pitch=0] -   pitch  (degree)\n * @param {String} [config.projectionType=vertival_cubestrip] - 360    \n * @param {Boolean} [config.centerPolePoint=false] -    \n * @param {Boolean} [config.allowPinchZoom=false] -      \n * @param {Boolean} [config.disableDeviceWhitelisting=false] -       \n * @param {Number} [config.minFieldOfView=20]\n * @param {Number} [config.maxFieldOfView=110] \n * @param {Number} [config.horizontalAngleOfImage=360] \n * @param {Number} [config.verticalAngleOfImage=180] \n * @param {Function} [config.checkSupport] -      (      )\n */\nfunction Photo360Viewer( rootNode, config ) {\n\t// Super constructor\n\tPhoto360Viewer.super_.call(this);\n\n\t//      error  \n\tif(config.checkSupport && !config.checkSupport()) {\n\t\tsetTimeout(function() {\n\t\t\tthis.trigger(EVENTS.ERROR, {\n\t\t\t\ttype: Photo360Viewer.INVALID_DEVICE,\n\t\t\t\tmessage: "invalid device"\n\t\t\t});\n\t\t}.bind(this), 0);\n\t\treturn this;\n\t}\n\n\t// webgl     \n\tif(!Photo360Viewer.isWebGLAvailable()) {\n\t\tsetTimeout(function() {\n\t\t\tthis.trigger(EVENTS.ERROR, {\n\t\t\t\ttype: Photo360Viewer.NO_WEBGL,\n\t\t\t\tmessage: "no webgl support"\n\t\t\t});\n\t\t}.bind(this), 0);\n\t\treturn this;\n\t}\n\n\t//   \n\tif(!config.disableDeviceWhitelisting && !Photo360Viewer.isStableWebGL()) {\n\t\tsetTimeout(function() {\n\t\t\tthis.trigger(EVENTS.ERROR, {\n\t\t\t\ttype: Photo360Viewer.INVALID_DEVICE,\n\t\t\t\tmessage: "invalid device"\n\t\t\t});\n\t\t}.bind(this), 0);\n\t\treturn this;\n\t}\n\n\tthis.rootNode = rootNode;\n\tthis.image = config.image;\n\n\tthis.width = config.width || parseInt(window.getComputedStyle(rootNode).width, 10);\n\tthis.height = config.height || parseInt(window.getComputedStyle(rootNode).height, 10);\n\tthis.controlMode = config.controlMode || ControlMode.GALLERY_YAW_PITCH;\n\tthis.projectionType = config.projectionType || ProjectionType.VERTICAL_CUBESTRIP;\n\n\tthis.allowPinchZoom = !!( config.allowPinchZoom || false );\n\n\tthis.verticalFieldOfView = config.fieldOfView || 65;\n\tif(config.verticalAngleOfImage && config.verticalAngleOfImage < this.verticalFieldOfView) {\n\t\tthis.verticalFieldOfView = config.verticalAngleOfImage;\n\t}\n\n\tthis.isResumed = false;\n\n\tthis.aspectRatio = this.width / this.height;\n\n\tthis.isVR =\n\t\tthis.controlMode === ControlMode.VR ||\n\t\tthis.controlMode === ControlMode.VR_YAW;\n\n\tthis.isInitialized = false;\n\n\tthis.quaternion = quat.create();\n\n\ttry {\n\t\tthis._initRenderer(config.yaw, config.pitch, this.verticalFieldOfView, this.projectionType);\n\t} catch(e) {\n\t\tsetTimeout(function() {\n\t\t\tthis.photoSphereRenderer && this.photoSphereRenderer.destroy();\n\t\t\tthis.trigger(EVENTS.ERROR, {\n\t\t\t\ttype: Photo360Viewer.NO_WEBGL,\n\t\t\t\tmessage: "no webgl support"\n\t\t\t});\n\t\t}.bind(this), 0);\n\t\treturn this;\n\t}\n\n//\tthis._initControlComposer(config.yaw, config.pitch, this.verticalFieldOfView, this.projectionType);\n\n\tthis.controlComposer = new ControlComposer(\n\t\trootNode,\n\t\t{\n\t    \tinitialYaw: config.yaw || 0,\n\t    \tinitialPitch: config.pitch || 0,\n\t    \tfieldOfView: this.verticalFieldOfView,\n\t    \tcenterPolePoint: config.centerPolePoint || false,\n\t    \tcontrolMode: this.controlMode,\n\t\t\tallowPinchZoom: this.allowPinchZoom,\n\t\t\tminFieldOfView: config.minFieldOfView || 20,\n\t\t\tmaxFieldOfView: config.maxFieldOfView || 110,\n\t\t\thorizontalAngleOfImage: config.horizontalAngleOfImage || 360,\n\t\t\tverticalAngleOfImage: config.verticalAngleOfImage || 180,\n\t\t\taspectRatio: this.aspectRatio\n\t\t}\n\t);\n\n\tthis._init();\n}\n\nPhoto360Viewer.prototype.setImage = function(image) {\n\tthis.image = image;\n\tthis.photoSphereRenderer && this.photoSphereRenderer.setImage(image);\n};\n\nPhoto360Viewer.prototype._initRenderer = function(yaw, pitch, fov, projectionType) {\n\tif(this.photoSphereRenderer) {\n\t\tthis.photoSphereRenderer.destroy();\n\t}\n\n    this.photoSphereRenderer = new PhotoSphereRenderer(\n    \tthis.image,\n    \tthis.width,\n    \tthis.height,\n    \t{\n\t    \tinitialYaw: yaw,\n\t    \tinitialPitch: pitch,\n\t    \tfieldOfView: fov,\n\t    \tprojectionType: projectionType\n\t    }\n    );\n    this._bindRendererHandler();\n};\n\nPhoto360Viewer.prototype._bindRendererHandler = function() {\n\tthis.photoSphereRenderer.on(EVENTS.ERROR, function(e) {\n\t\tthis.trigger(EVENTS.ERROR, {\n\t\t\ttype: Photo360Viewer.NO_WEBGL,\n\t\t\tmessage: "no webgl support"\n\t\t});\n\t}.bind(this));\n\n\tthis.photoSphereRenderer.on(EVENTS.IMAGE_LOADED, function(e) {\n\t\tthis._triggerEvent(EVENTS.IMAGE_LOADED, e);\n\t}.bind(this));\n\n\tthis.photoSphereRenderer.on("bindTexture", function(e) {\n\t\tPhoto360Viewer.isGyroSensorAvailable(function(hasGyroSensor) {\n\t\t\tthis.hasGyroSensor = hasGyroSensor;\n\t\n\t\t\tif(this.isInitialized || !this.photoSphereRenderer) { // init  suspend    \n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isInitialized = true;\n\t\t\tthis._triggerEvent(EVENTS.INIT, e);\n\t\t}.bind(this));\n\t}.bind(this));\n\n\tthis.photoSphereRenderer.on("renderingContextLost", function(e) {\n\t\tthis.suspend();\n\t}.bind(this));\n\n\tthis.photoSphereRenderer.on("renderingContextRestore", function(e) {\n\t\tthis.resume();\n\t}.bind(this));\n};\n\n// bind event\nPhoto360Viewer.prototype._init = function() {\n\tthis.controlComposer.on(EVENTS.ANIMATION_END, function(e) {\n\t\tthis._triggerEvent(EVENTS.ANIMATION_END, e);\n\t}.bind(this));\n\n\tthis.controlComposer.on("change", function(e) {\n\t\tthis.quaternion = e.quaternion;\n\t\tthis.verticalFieldOfView = e.fieldOfView;\n\t\tthis._triggerEvent(EVENTS.VIEWPORT_CHANGE, this.getOrientation());\n\t}.bind(this));\n};\n\nPhoto360Viewer.prototype._triggerEvent = function(name, param) {\n\tvar evt = param || {};\n\tevt.hasGyroSensor = this.hasGyroSensor;\n\treturn this.trigger(name, evt);\n};\n\n/**\n *    \n * @method Photo360Viewer#resize\n * @param {String} controlMode\n * @param {Boolean} allowPinchZoom\n */\nPhoto360Viewer.prototype.setControlMode = function(controlMode, allowPinchZoom) {\n\tthis.controlMode = controlMode;\n\n\tif(!(allowPinchZoom === undefined)) {\n\t\tthis.allowPinchZoom = allowPinchZoom;\n\t}\n\n\tthis.controlComposer.setControlMode(controlMode, this.allowPinchZoom);\n};\n\n/**\n *    \n * @method Photo360Viewer#setFieldOfViewRange\n * @param {Object} range\n * @param {Number} range.minFieldOfView\n * @param {Number} range.maxFieldOfView\n */\nPhoto360Viewer.prototype.setFieldOfViewRange = function(range) {\n\tthis.controlComposer.setFieldOfViewRange(range.minFieldOfView, range.maxFieldOfView);\n};\n\n/**\n *    \n * @method Photo360Viewer#updateViewportDimensions\n * @param {Object} [size]\n * @param {Number} [size.width=rootNode  width]\n * @param {Number} [size.height=rootNode  height]\n */\nPhoto360Viewer.prototype.updateViewportDimensions = function(size) {\n\tif( !this.isResumed ) {\n\t\treturn;\n\t}\n\tthis.width = size && size.width || parseInt(window.getComputedStyle(this.rootNode).width, 10);\n\tthis.height = size && size.height || parseInt(window.getComputedStyle(this.rootNode).height, 10);\n\n\tthis.aspectRatio = this.width / this.height;\n\tthis.photoSphereRenderer.updateViewportDimensions(this.width, this.height);\n\n\tthis.controlComposer.setAspectRatio(this.aspectRatio);\n\tthis.controlComposer.updateControlScale();\n\n\tvar noSkip = true;\n\tthis.lookAt({}, 0, noSkip);\n};\n\n/**\n *    \n * @method Photo360Viewer#getAspectRatio\n * @return {Number} aspect ratio of viewer canvas\n */\nPhoto360Viewer.prototype.getAspectRatio = function() {\n    return this.aspectRatio;\n};\n\n/**\n *   \n * @method Photo360Viewer#getVerticalFieldOfView\n * @return {Number} verticalFieldOfView (degree)\n */\nPhoto360Viewer.prototype.getVerticalFieldOfView = function() {\n\treturn this.verticalFieldOfView;\n};\n\n/**\n *   \n * @method Photo360Viewer#getHorizontalFieldOfView\n * @return {Number} verticalFieldOfView (degree)\n */\nPhoto360Viewer.prototype.getHorizontalFieldOfView = function() {\n    return glMatrix.toDegree( 2 * Math.atan( this.getAspectRatio() * Math.tan( glMatrix.toRadian(this.verticalFieldOfView) / 2 )));\n};\n\n /**\n *    field of view  \n * @method Photo360Viewer#getOrientation\n * @return {Object} orientation\n * @return {Object} orientation.yaw\n * @return {Object} orientation.pitch\n * @return {Object} orientation.fieldOfView - vertical vield of view\n */\nPhoto360Viewer.prototype.getOrientation = function() {\n\tvar orientation = util.quatToYawPitch(this.quaternion);\n\torientation.fieldOfView = this.verticalFieldOfView;\n\treturn orientation;\n};\n\nPhoto360Viewer.prototype.getAngleOfImage = function() {\n\treturn this.controlComposer.getAngleOfImage();\n};\n\n\n/**\n *     \n * @method Photo360Viewer#lookAt\n * @param {Object} orientation\n * @param {Number} orientation.yaw\n * @param {Number} orientation.pitch\n * @param {Number} orientation.fieldOfView\n * @param {Number} duration  \n */\nPhoto360Viewer.prototype.lookAt = function(orientation, duration, noSkip) { // deg\n\tif( !this.isResumed ) {\n\t\treturn;\n\t}\n\t\n\tvar _orientation = this.getOrientation();\n\n\tvar yaw = orientation.yaw !== undefined ? orientation.yaw : _orientation.yaw;\n\tvar pitch = orientation.pitch !== undefined ? orientation.pitch : _orientation.pitch;\n\tvar fieldOfView = orientation.fieldOfView !== undefined ? orientation.fieldOfView : _orientation.fieldOfView;\n\n\tvar angleOfImage = this.getAngleOfImage();\n\tif( angleOfImage.verticalAngleOfImage < fieldOfView ) {\n\t\tfieldOfView = angleOfImage.verticalAngleOfImage;\n\t}\n\n\tthis.controlComposer.lookAt({\n\t\tyaw: yaw,\n\t\tpitch: pitch,\n\t\tfieldOfView: fieldOfView\n\t}, duration, noSkip);\n\n\t// fieldOfView          . \n\t// duration  0    \n\t// if(duration === 0) {\n\t// \tthis.photoSphereRenderer.render(yaw, pitch, fieldOfView);\n\t// }\n};\n\n/**\n *   360   canvas     .\n * @method Photo360Viewer#resume\n */\nPhoto360Viewer.prototype.resume = function() {\n\t// resumed  resume   \n\tif( this.isResumed || !this.controlComposer ) {\n\t\treturn;\n\t}\n\n\t// photoSphereRenderer  !\n\tif(!this.photoSphereRenderer) {\n\t\tthis._initRenderer(this.controlComposer.yaw, this.controlComposer.pitch, this.verticalFieldOfView, this.projectionType);\n\t}\n\n\tsetTimeout(function() {\n\t\tif(this.isResumed || !this.photoSphereRenderer) {\n\t\t\treturn;\n\t\t}\n\t\tthis._triggerEvent(EVENTS.RESUMESTART);\n\n\t\tif(this.photoSphereRenderer.isImageLoaded()) {\n\t\t\tthis._resume();\n\t\t} else {\n\t\t\tthis.once("imageLoaded", function() {\n\t\t\t\tthis._resume();\n\t\t\t}.bind(this));\n\n\t\t\tthis.photoSphereRenderer.loadImage();\n\t\t}\n\t}.bind(this), 0);\n};\n\nPhoto360Viewer.prototype._resume = function() {\n\t// raf     \n\tif(!this.isInitialized) {\n\t\tthis.once(EVENTS.INIT, function() {\n\t\t\tthis.photoSphereRenderer.attachTo(this.rootNode);\n\t\t\tthis.controlComposer.connect();\n\n\t\t\t// suspend     resume    .\n\t\t\tthis.updateViewportDimensions();\n\n\t\t\tthis.isResumed = true;\n\t\t\tthis._triggerEvent(EVENTS.RESUME);\n\t\t\tthis._startRender();\n\t\t}.bind(this));\n\t} else {\n\t\tthis.photoSphereRenderer.attachTo(this.rootNode);\n\t\tthis.controlComposer.connect();\n\n\t\t// suspend     resume    .\n\t\tthis.isResumed = true;\n\t\tthis._triggerEvent(EVENTS.RESUME);\n\t\tthis.updateViewportDimensions();\n\t\tthis._startRender();\n\t}\n};\n/**\n *    _renderLoop   raf  \n */\nPhoto360Viewer.prototype._startRender = function() {\n\tthis._renderLoop = this._renderLoop.bind(this);\n\tthis._rafId = window.requestAnimationFrame(this._renderLoop);\n};\n\nPhoto360Viewer.prototype._renderLoop = function() {\n\tvar quaternion = quat.clone(this.quaternion);\n\tif( this.photoSphereRenderer && this.photoSphereRenderer.isImageLoaded() ) {\n\t\tthis.photoSphereRenderer.renderWithQuaternion(quaternion, this.verticalFieldOfView);\n\t}\n\tthis._rafId = window.requestAnimationFrame(this._renderLoop);\n};\n\nPhoto360Viewer.prototype._stopRender = function() {\n\tif(this._rafId) {\n\t\twindow.cancelAnimationFrame(this._rafId);\n\t\tdelete this._rafId;\n\t}\n};\n\nPhoto360Viewer.prototype.startRender = Photo360Viewer.prototype._startRender;\nPhoto360Viewer.prototype.stopRender = Photo360Viewer.prototype._stopRender;\n\n/**\n * canvas     \n * @method Photo360Viewer#suspend\n * @param {Boolean} persistOrientation resume        true  \n */\nPhoto360Viewer.prototype.suspend = function(persistOrientation) {\t\n\tif(this.photoSphereRenderer) {\n\t\tthis.photoSphereRenderer.cancelLoadImage();\n\n\t\tthis.photoSphereRenderer.destroy();\n\t\tthis.photoSphereRenderer = null;\n\n\t\tif( this.isResumed ) {\n\t\t\tthis.controlComposer.disconnect(persistOrientation);\n\n\t\t\t// raf \n\t\t\tthis._stopRender();\n\n\t\t\tthis.isResumed = false;\n\t\t}\n\n\t\tthis._triggerEvent(EVENTS.SUSPEND);\n\t}\n};\n\n/**\n *    \n * @method Photo360Viewer#connect\n */\nPhoto360Viewer.prototype.connect = function() {\n\tthis.controlComposer.connect();\n};\n\n/**\n *   \n * @method Photo360Viewer#disconnect\n */\nPhoto360Viewer.prototype.disconnect = function(persistOrientation) {\n\tthis.controlComposer.disconnect(persistOrientation);\n};\n\n/**\n *       .\n * @method Photo360Viewer#destroy\n */\nPhoto360Viewer.prototype.destroy = function() {\n\tthis._stopRender();\n\n\tif(this.controlComposer) {\n\t\tthis.controlComposer.destroy();\n\t\tthis.controlComposer = null;\n\t}\n\n\tif(this.photoSphereRenderer) {\n\t\tthis.photoSphereRenderer.destroy();\n\t\tthis.photoSphereRenderer = null;\n\t}\n\n\tthis.isResumed = false;\n};\n\n/**\n *   webgl     .\n * @method Photo360Viewer#isStableWebGL\n * @retuen {Boolean} isStableWebGL\n */\nPhoto360Viewer.isStableWebGL = function() {\n\tvar isStableWebgl = true;\n\tif(Agent.os.name === "android" && parseFloat(Agent.os.version) <= 4.3) {\n\t\tisStableWebgl = false;\n\t} else if(Agent.os.name === "android" && parseFloat(Agent.os.version) === 4.4) {\n\t\tif(Agent.browser.name !== "chrome") {\n\t\t\tisStableWebgl = false;\n\t\t}\n\t} else if(Agent.os.name === "ios" && parseInt(Agent.os.version, 10) <= 7) {\n\t\tisStableWebgl = false;\n\t}\n\n\treturn isStableWebgl;\n};\n\n\n/**\n *   webgl  \n * @method Photo360Viewer#isWebGLAvailable\n * @retuen {Boolean} isWebGLAvailable\n */\nPhoto360Viewer.isWebGLAvailable = function() {\n\tvar canvas = document.createElement("canvas");\n\tvar webglContext = PhotoSphereRenderer.getWebglContext(canvas);\n\tvar webglAvailability = !!webglContext;\n\t\n\t// webglContext    \n\tif(webglContext) {\n\t\tvar loseContextExtension = webglContext.getExtension(\'WEBGL_lose_context\');\n\t\tloseContextExtension && loseContextExtension.loseContext();\n\t}\n\n\treturn webglAvailability;\n};\n\n/**\n *     \n * @method Photo360Viewer#isSupported\n * @retuen {Boolean} isSupported\n */\nPhoto360Viewer.isSupported = function() {\n\treturn Photo360Viewer.isWebGLAvailable() && Photo360Viewer.isStableWebGL();\n};\n\n/**\n *     \n * @method Photo360Viewer#isGyroSensorAvailable\n * @param {Function} fallback\n */\nPhoto360Viewer.isGyroSensorAvailable = function(fallback) {\n\tif(typeof window.ondevicemotion === "undefined" ) {\n\t\tfallback && fallback(false);\n\t\treturn;\n\t}\n\n\twindow.addEventListener(\'devicemotion\', onDeviceMotionChange);\n\tfunction onDeviceMotionChange(deviceMotion) {\n\t\tvar isGyroSensorAvailable = deviceMotion.rotationRate.alpha !== null;\n\t\t//window.removeEventListener(\'devicemotion\', onDeviceMotionChange);\n\t\tfallback && fallback(isGyroSensorAvailable);\n\t\tclearTimeout(_gyroTimer);\n\t\tPhoto360Viewer.isGyroSensorAvailable = function(fallback) {\n\t\t\tfallback && fallback(isGyroSensorAvailable);\n\t\t\treturn isGyroSensorAvailable;\n\t\t};\n\t}\n\n\tvar _gyroTimer = setTimeout(function() {\n  \t\tfallback && fallback(false);\n\t\tPhoto360Viewer.isGyroSensorAvailable = function(fallback) {\n\t\t\tfallback && fallback(false);\n\t\t\treturn false;\n\t\t};\n  \t\twindow.removeEventListener(\'devicemotion\', onDeviceMotionChange);\n\t}, 1000);\n};\n\n// TODO  .\n/**\n *    dataURI \n *       cover   \n * @method Photo360Viewer#getScreenshot\n * @param {Object} options\n * @param {Number} [options.width=rootNode  width]   (px)\n * @param {Number} [options.height=rootNode  height]   (px)\n * @param {String} [options.type=image/png] dataURI  \n * @param {Number} [options.encoderOptions=0.92]  . 0  1  \n * @return {String} dataURL\n */\n// Photo360Viewer.prototype.getScreenshot = function(options) {\n// \tvar dataURL = this.photoSphereRenderer ?\n//     \tthis.photoSphereRenderer.getScreenshotDataURL(options) : null;\n//     return dataURL;\n// };\n\n/**\n *        .\n *  0,0.    null \n * @method Photo360Viewer#getHotspotOffset\n * @param {Number} yaw\n * @param {Number} pitch\n * @return {Object} position\n * @return {Object} position.top        (px)\n * @return {Object} position.left        (px)\n */\nPhoto360Viewer.prototype.getHotspotOffset = function(yaw, pitch) {\n\tvar orientation = this.getOrientation();\n\tvar deltaYaw = yaw - orientation.yaw;\n\tif(deltaYaw > 180 || deltaYaw < -180 ) {\n\t\tif(yaw < orientation.yaw) {\n\t\t\tdeltaYaw = (yaw + 360) - orientation.yaw;\n\t\t}else {\n\t\t\tdeltaYaw = yaw - (orientation.yaw + 360);\n\t\t}\n\t}\n\n\tvar deltaPitch = (90 + pitch) - ( 90 + orientation.pitch);\n\n\tif(Math.abs(deltaYaw) > 90) {\n\t\treturn null;\n\t}\n\n\treturn this._getHotspotOffsetRelativeFromViewportCenter(deltaYaw, deltaPitch);\n};\n\nPhoto360Viewer.prototype._getHotspotOffsetRelativeFromViewportCenter = function(deltaYaw, deltaPitch) {\n\t//    1     \n\tvar point = util.yawPitchToPoint( glMatrix.toRadian(deltaYaw), glMatrix.toRadian(deltaPitch) );\n\n\tvar viewportHeightHalfSize = Math.tan( glMatrix.toRadian( this.verticalFieldOfView ) / 2 );\n\tvar viewportWidthHalfSize = Math.tan( glMatrix.toRadian( this.getHorizontalFieldOfView() ) / 2 );\n\n\treturn {\n\t\tleft:  (viewportWidthHalfSize - point[0]) / viewportWidthHalfSize *  this.width / 2,\n\t\ttop: (viewportHeightHalfSize - point[1]) / viewportHeightHalfSize * this.height / 2\n\t};\n};\n\n\nPhoto360Viewer.ERROR_TYPE = objectAssign({}, consts.ERROR_TYPE);\n\n// below will deprecate\nPhoto360Viewer.INVALID_DEVICE = consts.ERROR_TYPE.INVALID_DEVICE;\nPhoto360Viewer.NO_WEBGL = consts.ERROR_TYPE.NO_WEBGL;\n\nPhoto360Viewer.VERSION = "1.2.4";\n\nwindow.Photo360Viewer = Photo360Viewer;// VER 1.1.2< compatibility\nmodule.exports = Photo360Viewer;\n\n},{"./ControlComposer.js":9,"./ControlMode":10,"./PhotoSphereRenderer.js":12,"./ProjectionType.js":13,"./consts":14,"./eg.js":19,"./utils/math-util.js":27,"inherits":1,"object-assign":2}],12:[function(_dereq_,module,exports){\nvar util = _dereq_("./utils/math-util.js").util;\nvar glMatrix = _dereq_("./utils/math-util.js").glMatrix;\nvar quat = _dereq_("./utils/math-util.js").quat;\nvar mat4 = _dereq_("./utils/math-util.js").mat4;\nvar ns = _dereq_("./eg.js");\nvar eg = ns.eg;\nvar inherits = _dereq_("inherits");\n\nvar ProjectionType = _dereq_("./ProjectionType");\nvar getErrorNameFromWebGLErrorCode = _dereq_("./getErrorNameFromWebGLErrorCode");\n\nvar DEVICE_PIXEL_RATIO = window.devicePixelRatio || 1;\n\n// DEVICE_PIXEL_RATIO  2     2 .\nif( DEVICE_PIXEL_RATIO > 2 ) {\n    DEVICE_PIXEL_RATIO = 2;\n}\n\ninherits(PhotoSphereRenderer, eg.Component);\n\n// define custom events name\nvar EVENTS = {\n\tBIND_TEXTURE: "bindTexture",\n\tIMAGE_LOADED: "imageLoaded",\n    ERROR: "error"\n};\n\n\nfunction PhotoSphereRenderer( image, width, height, sphericalConfig ) {\n\n\t// Super constructor\n\tPhotoSphereRenderer.super_.call(this);\n\n    this.sphericalConfig = sphericalConfig;\n    this.fieldOfView = sphericalConfig.fieldOfView;\n    this.autoUpdateTexture= true;\n\n    this.width = width;\n    this.height = height;\n\n    if(typeof image === "string"){\n\t    this.image = new Image();\n\t\tthis._imageURL = image;\n    } else if(typeof image === "object") { // img element  image object  \n\t    this.image = image;\n    }\n\n\tthis._lastQuaternion = null;\n\tthis._lastYaw = null;\n\tthis._lastPitch = null;\n\tthis._lastFieldOfView = null;\n\n    this.pMatrix = mat4.create();\n    this.mvMatrix = mat4.create();\n\n    this.textureCoordBuffer  = null;\n    this.vertexBuffer = null ;\n    this.indexBuffer= null ;\n\n    this.isCubeStrip = sphericalConfig.projectionType === ProjectionType.VERTICAL_CUBESTRIP ||\n        sphericalConfig.projectionType === ProjectionType.CUBEMAP;\n\n    this.canvas = null;\n    this.canvas = document.createElement(\'canvas\');\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.canvas.style.bottom = 0;\n    this.canvas.style.left = 0;\n    this.canvas.style.right = 0;\n    this.canvas.style.top = 0;\n    this.canvas.style.margin = \'auto\';\n    this.canvas.style.maxHeight = \'100%\';\n    this.canvas.style.maxWidth = \'100%\';\n    this.canvas.style.outline = \'none\';\n    this.canvas.style.position = \'absolute\';\n\n\t// webgl context lost & restore   \n\t// TODO :      \n    this._onWebglcontextlost = this._onWebglcontextlost.bind(this);\n    this._onWebglcontextrestored = this._onWebglcontextrestored.bind(this);\n\n    this.canvas.addEventListener(\'webglcontextlost\', this._onWebglcontextlost);\n    this.canvas.addEventListener(\'webglcontextrestored\', this._onWebglcontextrestored);\n\n    this._bindOnImageLoadHandler();\n}\n\nPhotoSphereRenderer.prototype.isImageLoaded = function() {\n\treturn !!this.image.src && !!this.image.complete;\n};\n\nPhotoSphereRenderer.prototype.cancelLoadImage = function() {\n    if(!!this.image.src && !this.isImageLoaded()) {\n        this.image.src = \'\';\n    }\n};\n\nPhotoSphereRenderer.prototype.loadImage = function() {\n\tif(this._imageURL && !this.isImageLoaded()) {\n        this.image.setAttribute(\'crossorigin\', \'anonymous\');\n\t\tthis.image.src = this._imageURL;\n\t}\n};\n\n\nPhotoSphereRenderer.prototype.setImage = function(image) { // img element or img url \n    if(typeof image === "string"){\n\t    this.image = new Image();\n\t\tthis._imageURL = image;\n    } else if(typeof image === "object") { // img element  image object  \n\t    this.image = image;\n    }\n    this._bindOnNewImageLoadHandler();\n};\n\n\nPhotoSphereRenderer.prototype._bindOnImageLoadHandler = function() {\n    if (this.isImageLoaded()) {\n\t    setTimeout(function() {\n\t\t\tthis._onImageLoad();\n\t    }.bind(this), 0);\n    } else {\n        this.image.onload = function() {\n            return this._onImageLoad();\n        }.bind(this);\n    }\n};\n\nPhotoSphereRenderer.prototype._bindOnNewImageLoadHandler = function() {\n    if (this.isImageLoaded()) {\n\t    setTimeout(function() {\n\t\t\tthis._onNewImageLoad();\n\t    }.bind(this), 0);\n    } else {\n        this.image.onload = function() {\n            return this._onNewImageLoad();\n        }.bind(this);\n    }\n};\n\nPhotoSphereRenderer.prototype._onNewImageLoad = function() {\n    // render     - webgl .\n    //this._init();\n\n\t//   .\n\tthis.imageWidth = this.image.width;\n\tthis.imageHeight = this.image.height;\n\n    this.setAutoUpdateTexture(true);\n\n\tthis.render(this.sphericalConfig.initialYaw, this.sphericalConfig.initialPitch , this.sphericalConfig.fieldOfView);\n    //this.updateViewportDimensions(this.canvas.width, this.canvas.height);\n\n\t//     _draw  texture  bind  .\n    this.setAutoUpdateTexture(false);\n\n\t//  .   render   .\n    this.trigger(\'imageLoaded\');\n};\n\nPhotoSphereRenderer.prototype._onImageLoad = function() {\n    // render     - webgl .\n    this._init();\n\n\t//   .\n\tthis.imageWidth = this.image.width;\n\tthis.imageHeight = this.image.height;\n\n    this.setAutoUpdateTexture(true);\n\n\tthis.render(this.sphericalConfig.initialYaw, this.sphericalConfig.initialPitch , this.sphericalConfig.fieldOfView);\n\n\t//     _draw  texture  bind  .\n    setTimeout(function(){\n        this.setAutoUpdateTexture(false);\n    }.bind(this), 0);\n\t//  .   render   .\n    this.trigger(\'imageLoaded\');\n};\n\n//   canvas  \nPhotoSphereRenderer.prototype.attachTo = function(parentElement) {\n    this.detach();\n    parentElement.appendChild(this.canvas);\n};\n\nPhotoSphereRenderer.prototype.forceContextLoss = function() {\n    if(this.hasRenderingContext()) {\n        var loseContextExtension = this.context.getExtension(\'WEBGL_lose_context\');\n        if(loseContextExtension) {\n            loseContextExtension.loseContext();\n        }\n    }\n};\n\n\n//   canvas  \nPhotoSphereRenderer.prototype.detach = function() {\n    if (this.canvas.parentElement)\n        this.canvas.parentElement.removeChild(this.canvas);\n};\n\nPhotoSphereRenderer.prototype.isAttached = function() {\n    return this.isImageLoaded()  && this.canvas && this.canvas.parentNode;\n};\n\n\nPhotoSphereRenderer.prototype.destroy = function() {\n    this.detach();\n    this.forceContextLoss();\n\n    this.off();\n\n    this.canvas.removeEventListener(\'webglcontextlost\', this._onWebglcontextlost);\n    this.canvas.removeEventListener(\'webglcontextrestored\', this._onWebglcontextrestored);\n};\n\nPhotoSphereRenderer.prototype.hasRenderingContext = function() {\n    if(!this.context) {\n        return false;\n    } else if(!this.context.getProgramParameter(this.shaderProgram, this.context.LINK_STATUS) && !this.context.isContextLost()) {\n        return false\n    }\n    return true;\n};\n\nPhotoSphereRenderer.prototype._onWebglcontextlost = function(e) {\n    e.preventDefault();\n    this.trigger(\'renderingContextLost\');\n};\n\nPhotoSphereRenderer.prototype._onWebglcontextrestored = function(e) {\n\tthis._init();\n    this.trigger(\'renderingContextRestore\');\n};\n\nPhotoSphereRenderer.prototype.setAutoUpdateTexture = function(autoUpdateTexture) {\n    this.autoUpdateTexture = autoUpdateTexture;\n};\n\nPhotoSphereRenderer.prototype.updateFieldOfView = function(fieldOfView) {\n    this.fieldOfView = fieldOfView;\n    this._updateViewport();\n};\n\nPhotoSphereRenderer.prototype.updateViewportDimensions = function(width, height) {\n    this.canvas.width = width * DEVICE_PIXEL_RATIO;\n    this.canvas.height = height * DEVICE_PIXEL_RATIO;\n\n    this._updateViewport();\n    this._shouldForceDraw = true;\n};\n\nPhotoSphereRenderer.prototype._updateViewport = function() {\n    mat4.perspective(this.pMatrix, glMatrix.toRadian(this.fieldOfView), this.canvas.width / this.canvas.height, .1, 100);\n    this.context.viewport(0, 0, this.context.drawingBufferWidth, this.context.drawingBufferHeight);\n};\n\nPhotoSphereRenderer.prototype._init = function() {\n    try {\n        this._initRenderingContext();\n        this.updateViewportDimensions(this.canvas.width, this.canvas.height);\n        if (!this._initShaderProgram())\n            throw new Error(\'Failed to intialize shaders: \' + getErrorNameFromWebGLErrorCode(this.context.getError()));\n    } catch (e) {\n        this.trigger(EVENTS.ERROR);\n\t    this.destroy(); \n        return;\n    }\n    //   .\n    this.context.clearColor(0, 0, 0, 0);\n    this._initTexture();\n};\n\n// PhotoSphereRenderer.prototype.getScreenshotDataURL = function(options) {\n//     if (!this.hasRenderingContext())\n//         return \'\';\n\n//     var newCanvas = document.createElement(\'canvas\');\n\n//     //set dimensions\n//     newCanvas.width = (options && options.width) || this.canvas.width;\n//     newCanvas.height = (options && options.height) || this.canvas.height;\n\n//     var canvasAspectRatio = this.canvas.width / this.canvas.height;\n\n//     var aspectRatio = newCanvas.width / newCanvas.height;\n//     var context = newCanvas.getContext(\'2d\');\n\n//     //apply the old canvas to the new one\n//     var srcX = aspectRatio > canvasAspectRatio ? 0 : (this.canvas.width - this.canvas.height * aspectRatio) / 2; //  \n//     var srcY = aspectRatio > canvasAspectRatio ? (this.canvas.height - this.canvas.width / aspectRatio) / 2 : 0;\n//     var srcHeight = aspectRatio > canvasAspectRatio ? this.canvas.width / aspectRatio : this.canvas.height;\n//     var srcWidth = aspectRatio > canvasAspectRatio ? this.canvas.height : this.canvas.height * aspectRatio ;\n//     debugger;\n//     context.drawImage(this.canvas,\n//     \tsrcX, srcY, srcWidth, srcHeight, // src start point and size\n// \t\t0, 0, newCanvas.width, newCanvas.height // target start point and size\n// \t);\n\n// \tvar dataURL = newCanvas.toDataURL(options && options.type , options && options.encoderOptions);\n\n//     return dataURL; // "image/jpeg", 1.0\n// };\n\nPhotoSphereRenderer.getWebglContext = function(canvas) {\n\tvar webglIdentifiers = [\'webgl\', \'experimental-webgl\', \'webkit-3d\', \'moz-webgl\'];\n\tvar context = null;\n\tvar statusMessage = null;\n\tcanvas.addEventListener(\'webglcontextcreationerror\', onWebglcontextcreationerror);\n\n    function onWebglcontextcreationerror(e) {\n        return statusMessage = e.statusMessage;\n    }\n\n\tfor (var i = 0; i < webglIdentifiers.length; i++) {\n        try {\n\t        // preserveDrawingBuffer: true   s6   \n            context = canvas.getContext(webglIdentifiers[i], {preserveDrawingBuffer: false});\n        } catch (t) {}\n        if (context)\n            break;\n    }\n\n    canvas.removeEventListener(\'webglcontextcreationerror\', onWebglcontextcreationerror);\n\n    return context;\n};\n\nPhotoSphereRenderer.prototype._initRenderingContext = function() {\n    if (this.hasRenderingContext())\n        return;\n\n    if (!window.WebGLRenderingContext)\n        throw new Error(\'WebGLRenderingContext not available.\');\n\n    this.context = PhotoSphereRenderer.getWebglContext(this.canvas);\n\n\tif (!this.context)\n        throw new Error(\'Failed to acquire 3D rendering context\');\n};\n\nPhotoSphereRenderer.prototype._initShaderProgram = function() {\n    var vertexShader = this._getVertexShader();\n    if (!vertexShader)\n        return false;\n    var fragmentShader = this._getFragmentShader();\n    if (!fragmentShader)\n        return false;\n    this.shaderProgram = this.context.createProgram();\n    this.context.attachShader(this.shaderProgram, vertexShader);\n    this.context.attachShader(this.shaderProgram, fragmentShader);\n    this.context.linkProgram(this.shaderProgram);\n    if (!this.context.getProgramParameter(this.shaderProgram, this.context.LINK_STATUS))\n        return false;\n    this.context.useProgram(this.shaderProgram);\n    this.shaderProgram.vertexPositionAttribute = this.context.getAttribLocation(this.shaderProgram, \'aVertexPosition\');\n    this.context.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute);\n    this.shaderProgram.pMatrixUniform = this.context.getUniformLocation(this.shaderProgram, \'uPMatrix\');\n    this.shaderProgram.mvMatrixUniform = this.context.getUniformLocation(this.shaderProgram, \'uMVMatrix\');\n    this.shaderProgram.samplerUniform = this.context.getUniformLocation(this.shaderProgram, \'uSampler\');\n    if (!this.isCubeStrip) {\n        this.shaderProgram.textureCoordAttribute = this.context.getAttribLocation(this.shaderProgram, \'aTextureCoord\');\n        this.context.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute);\n    }\n    return true;\n};\n\nPhotoSphereRenderer.prototype._initTexture = function() {\n    this.texture = this.context.createTexture();\n    //this.texture.image = this.image;\n    var TEXTURE_TARGET = this.isCubeStrip ? this.context.TEXTURE_CUBE_MAP : this.context.TEXTURE_2D;\n    this.context.bindTexture(TEXTURE_TARGET, this.texture);\n    this.context.texParameteri(TEXTURE_TARGET, this.context.TEXTURE_MAG_FILTER, this.context.LINEAR);\n    this.context.texParameteri(TEXTURE_TARGET, this.context.TEXTURE_MIN_FILTER, this.context.LINEAR);\n    this.context.texParameteri(TEXTURE_TARGET, this.context.TEXTURE_WRAP_S, this.context.CLAMP_TO_EDGE);\n    this.context.texParameteri(TEXTURE_TARGET, this.context.TEXTURE_WRAP_T, this.context.CLAMP_TO_EDGE);\n    this.context.bindTexture(TEXTURE_TARGET, null );\n};\n\nPhotoSphereRenderer.prototype._initBuffersForSphere = function() {\n    var latitudeBands = 60, longitudeBands = 60, radius = 2,\n    textureCoordData = [], vertexPositionData = [], latIdx, lngIdx;\n    var indexData = [];\n    for (latIdx = 0; latIdx <= latitudeBands; latIdx++) {\n        var theta = (latIdx / latitudeBands - .5) * Math.PI\n          , sinTheta = Math.sin(theta)\n          , cosTheta = Math.cos(theta);\n        for (lngIdx = 0; lngIdx <= longitudeBands; lngIdx++) {\n            var phi = (lngIdx / longitudeBands - .5) * 2 * Math.PI;\n            var sinPhi = Math.sin(phi);\n            var cosPhi = Math.cos(phi);\n            var x = cosPhi * cosTheta;\n            var y = sinTheta;\n            var z = sinPhi * cosTheta;\n            var u = lngIdx / longitudeBands;\n            var v = latIdx / latitudeBands;\n\n            textureCoordData.push(u, v);\n            vertexPositionData.push(radius * x, radius * y, radius * z);\n\n\t\t\tif(lngIdx !== longitudeBands && latIdx !== latitudeBands) {\n\t            var a = latIdx * (longitudeBands + 1) + lngIdx;\n\t            var b = a + longitudeBands + 1;\n\t            indexData.push(a, b, a + 1, b, b + 1, a + 1);\n\t        }\n        }\n    }\n    this.textureCoordBuffer = this.context.createBuffer();\n    this.context.bindBuffer(this.context.ARRAY_BUFFER, this.textureCoordBuffer);\n    this.context.bufferData(this.context.ARRAY_BUFFER, new Float32Array(textureCoordData), this.context.STATIC_DRAW);\n    this.textureCoordBuffer.itemSize = 2;\n    this.textureCoordBuffer.numItems = textureCoordData.length / 2;\n    this.vertexBuffer = this.context.createBuffer();\n    this.context.bindBuffer(this.context.ARRAY_BUFFER, this.vertexBuffer);\n    this.context.bufferData(this.context.ARRAY_BUFFER, new Float32Array(vertexPositionData), this.context.STATIC_DRAW);\n    if (this.vertexBuffer) {\n        this.vertexBuffer.itemSize = 3;\n        this.vertexBuffer.numItems = vertexPositionData.length / 3;\n    }\n    this.indexBuffer= this.context.createBuffer();\n    this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n    this.context.bufferData(this.context.ELEMENT_ARRAY_BUFFER, new Uint16Array(indexData), this.context.STATIC_DRAW);\n    if (this.indexBuffer) {\n        this.indexBuffer.itemSize = 1;\n        this.indexBuffer.numItems = indexData.length;\n    }\n};\n\nPhotoSphereRenderer.prototype._initBuffersForCube = function() {\n\tvar vertexPositionData = [\n\t\t// back\n\t\t 1, -1, 1,\n\t\t-1, -1, 1,\n\t\t-1,  1, 1,\n\t\t 1,  1, 1,\n\n\t\t// front\n\t\t-1, -1, -1,\n\t\t 1, -1, -1,\n\t\t 1,  1, -1,\n\t\t-1,  1, -1,\n\n\t\t// top\n\t\t 1, 1, -1,\n\t\t 1, 1,  1,\n\t\t-1, 1,  1,\n\t\t-1, 1, -1,\n\n\t\t// bottom\n\t\t-1, -1, -1,\n\t\t-1, -1,  1,\n\t\t 1, -1,  1,\n\t\t 1, -1, -1,\n\n\t\t// right\n\t\t1, -1, -1,\n\t\t1, -1,  1,\n\t\t1,  1,  1,\n\t\t1,  1, -1,\n\n\t\t// left\n\t\t-1, -1,  1,\n\t\t-1, -1, -1,\n\t\t-1,  1, -1,\n\t\t-1,  1,  1\n\t];\n\n    this.vertexBuffer = this.context.createBuffer();\n    this.context.bindBuffer(this.context.ARRAY_BUFFER, this.vertexBuffer);\n    this.context.bufferData(this.context.ARRAY_BUFFER, new Float32Array(vertexPositionData), this.context.STATIC_DRAW);\n    if (this.vertexBuffer) {\n        this.vertexBuffer.itemSize = 3;\n        this.vertexBuffer.numItems = vertexPositionData.length / 3;\n    }\n    var indexData = [];\n\n    for (var i = 0; i < (vertexPositionData.length / 3); i += 4) {\n        indexData.push(\n        \ti,\n        \ti + 2,\n        \ti + 1,\n        \ti,\n        \ti + 3,\n        \ti + 2\n        );\n    }\n    this.indexBuffer= this.context.createBuffer();\n    this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n    this.context.bufferData(this.context.ELEMENT_ARRAY_BUFFER, new Uint16Array(indexData), this.context.STATIC_DRAW);\n    if (this.indexBuffer) {\n        this.indexBuffer.itemSize = 1;\n        this.indexBuffer.numItems = indexData.length;\n    }\n};\n\nPhotoSphereRenderer.prototype._getVertexShader = function() {\n    var shader = this.context.createShader(this.context.VERTEX_SHADER);\n\tvar cubeSrc = \'attribute vec3 aVertexPosition;\' +\n      \t\t\'uniform mat4 uMVMatrix;\' +\n      \t\t\'uniform mat4 uPMatrix;\' +\n      \t\t\'varying highp vec3 vVertexDirectionVector;\' +\n      \t\t\'void main(void) {\' +\n      \t\t\t\'gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\' +\n\t  \t\t\t\'vVertexDirectionVector = aVertexPosition;\' +\n      \t\t\'}\';\n\tvar equiSrc = \'attribute vec3 aVertexPosition;\' +\n      \t\t\'attribute vec2 aTextureCoord;\' +\n      \t\t\'uniform mat4 uMVMatrix;\' +\n      \t\t\'uniform mat4 uPMatrix;\' +\n      \t\t\'varying highp vec2 vTextureCoord;\' +\n      \t\t\'void main(void) {\' +\n      \t\t\t\'gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\' +\n\t  \t\t\t\'vTextureCoord = aTextureCoord;\' +\n      \t\t\'}\';\n\tvar source = this.isCubeStrip ? cubeSrc : equiSrc;\n    this.context.shaderSource(shader, source);\n    this.context.compileShader(shader);\n    if (!this.context.getShaderParameter(shader, this.context.COMPILE_STATUS))\n        return null ;\n    return shader;\n};\n\nPhotoSphereRenderer.prototype._getFragmentShader = function() {\n    var shader = this.context.createShader(this.context.FRAGMENT_SHADER);\n\tvar cubeSrc = \'varying highp vec3 vVertexDirectionVector;\' +\n  \t\t\t\'uniform samplerCube uSampler;\' +\n  \t\t\t\'void main(void) {\' +\n  \t\t\t\t\'gl_FragColor = textureCube(uSampler, vVertexDirectionVector);\' +\n  \t\t\t\'}\';\n\tvar equiSrc = \'varying highp vec2 vTextureCoord;\' +\n  \t\t\t\'uniform sampler2D uSampler;\' +\n  \t\t\t\'void main(void) {\' +\n\t  \t\t\t\'gl_FragColor = texture2D(\' +\n\t  \t\t\t\t\'uSampler,\' +\n\t  \t\t\t\t\'vec2(vTextureCoord.s, vTextureCoord.t)\' +\n\t  \t\t\t\');\' +\n  \t\t\t\'}\';\n\tvar source = this.isCubeStrip ? cubeSrc : equiSrc;\n    this.context.shaderSource(shader, source);\n    this.context.compileShader(shader);\n    if (!this.context.getShaderParameter(shader, this.context.COMPILE_STATUS))\n        return null ;\n    return shader;\n};\n\nPhotoSphereRenderer.prototype._bindTexture = function() {\n    if (this.isCubeStrip) {\n        this._bindCubeStripTexture();\n    } else {\n\t\tthis._bindEquirectangularTexture();\n    }\n};\n\nPhotoSphereRenderer.prototype.renderWithQuaternion = function(quaternion, fieldOfView) {\n    if (!this.hasRenderingContext()) {\n        return;\n    }\n\n    //     ...   \n    this._shouldForceDraw = true;\n\n\tif( this._lastQuaternion && quat.exactEquals(this._lastQuaternion, quaternion)\n\t\t&& this.fieldOfView && this.fieldOfView === fieldOfView\n\t\t&& this._shouldForceDraw === false\n\t) {\n\t\treturn;\n    }\n\n    if (this.autoUpdateTexture)\n        this._bindTexture();\n\n\n\t// fieldOfView        \n\tif(fieldOfView !== undefined && fieldOfView !== this.fieldOfView) {\n\t\tthis.updateFieldOfView(fieldOfView);\n\t}\n\n\tvar adgustedQ;\n\t// equirectangular     0,0      yaw  .\n\tif(!this.isCubeStrip) {\n\t\tvar adjustYaw = quat.rotateY(quat.create(), quat.create(), glMatrix.toRadian(-90));\n\t\tadgustedQ = this.isCubeStrip ? quaternion : quat.multiply(quat.create(), adjustYaw, quaternion);\n\t} else {\n\t\tadgustedQ = quaternion;\n\t}\n\n    this.mvMatrix = mat4.fromQuat(mat4.create(), quat.conjugate(quat.create(), adgustedQ));\n\n    this._draw();\n\n\tthis._lastQuaternion = quat.clone(quaternion);\n\n\tif(this._shouldForceDraw) {\n\t\tthis._shouldForceDraw = false;\n\t}\n};\n\nPhotoSphereRenderer.prototype.render = function(yaw, pitch, fieldOfView) {\n    if (!this.hasRenderingContext())\n        return;\n\n\tif( this._lastYaw && this._lastYaw === yaw\n\t\t&& this._lastPitch && this._lastPitch === pitch\n\t\t&& this.fieldOfView && this.fieldOfView === fieldOfView\n\t\t&& this._shouldForceDraw === false\n\t)\n\t\treturn;\n\n    if (this.autoUpdateTexture) {\n        this._bindTexture();\n    }\n\n\t// fieldOfView        \n\tif(fieldOfView !== undefined && fieldOfView !== this.fieldOfView) {\n\t\tthis.updateFieldOfView(fieldOfView);\n\t}\n\n    mat4.identity(this.mvMatrix);\n\tmat4.rotateX(this.mvMatrix, this.mvMatrix, -glMatrix.toRadian(pitch));\n    mat4.rotateY(this.mvMatrix, this.mvMatrix, -glMatrix.toRadian(yaw - (this.isCubeStrip ? 0 : 90)));\n\n    this._draw();\n\n    this._lastYaw = yaw;\n    this._lastPitch = pitch;\n\tif(this._shouldForceDraw) {\n\t\tthis._shouldForceDraw = false;\n\t}\n};\n\nPhotoSphereRenderer.prototype._draw = function() {\n    this.context.clear(this.context.COLOR_BUFFER_BIT | this.context.DEPTH_BUFFER_BIT);\n    this.context.activeTexture(this.context.TEXTURE0);\n    if (this.isCubeStrip) {\n        this.context.bindTexture(this.context.TEXTURE_CUBE_MAP, this.texture);\n        if (this.vertexBuffer === null )\n            this._initBuffersForCube(this.sphericalConfig.projectionType, this.sphericalConfig.expansionCoef || 0, 0);\n    } else {\n       this.context.bindTexture(this.context.TEXTURE_2D, this.texture);\n        this._initBuffersForSphere(0);\n        this.context.bindBuffer(this.context.ARRAY_BUFFER, this.textureCoordBuffer);\n        this.context.vertexAttribPointer(this.shaderProgram.textureCoordAttribute, this.textureCoordBuffer.itemSize, this.context.FLOAT, false, 0, 0);\n    }\n    this.context.uniform1i(this.shaderProgram.samplerUniform, 0);\n\n\n    this.context.bindBuffer(this.context.ARRAY_BUFFER, this.vertexBuffer);\n    if (this.vertexBuffer)\n        this.context.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute, this.vertexBuffer.itemSize, this.context.FLOAT, false, 0, 0);\n\n\n    this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n\n    this.context.uniformMatrix4fv(this.shaderProgram.pMatrixUniform, false, this.pMatrix);\n    this.context.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform, false, this.mvMatrix);\n\n    if (this.indexBuffer)\n        this.context.drawElements(this.context.TRIANGLES, this.indexBuffer.numItems, this.context.UNSIGNED_SHORT, 0);\n\n    if (this.isCubeStrip) {\n        this.context.bindTexture(this.context.TEXTURE_CUBE_MAP, null);\n    } else {\n    \tthis.context.bindTexture(this.context.TEXTURE_2D, null );\n    }\n\n};\n\nPhotoSphereRenderer.prototype._getMaxCubeMapTextureSize = function(imageWidth) {\n    var maxCubeMapTextureSize = this.context.getParameter(this.context.MAX_CUBE_MAP_TEXTURE_SIZE);\n    var _imageWidth = imageWidth;\n\n  \tvar agent = eg.agent();\n \tif(agent.browser.name === "ie" && parseInt(agent.browser.version, 10) === 11) {\n\t    if(!util.isPowerOfTwo(_imageWidth)) {\n\t\t    for(var i = 1; i <  maxCubeMapTextureSize ; i = i * 2) {\n\t\t\t    if(i < _imageWidth) {\n\t\t\t    \tcontinue;\n\t\t\t    } else {\n\t\t\t\t\t_imageWidth = i;\n\t\t\t\t\tbreak;\n\t\t\t    }\n\t\t    }\n\t    }\n\t}\n    // ios 9     1024 .\n    if(agent.os.name === "ios" && parseInt(agent.os.version, 10) === 9) {\n        _imageWidth = 1024;\n    }\n    // ios 8     512 .\n    if(agent.os.name === "ios" && parseInt(agent.os.version, 10) === 8) {\n        _imageWidth = 512;\n    }\n    // maxCubeMapTextureSize  , imageWidth   2     \n    return this.isImageLoaded() ? Math.min(maxCubeMapTextureSize, _imageWidth) : maxCubeMapTextureSize;\n};\n\nPhotoSphereRenderer.prototype._bindEquirectangularTexture = function() {\n\tif(!this.isImageLoaded()) {\n\t\treturn;\n\t}\n\tvar maxTextureSize = this.context.getParameter(this.context.MAX_TEXTURE_SIZE);\n\n\tvar width = this.imageWidth;\n\tvar height = this.imageHeight;\n\n\tvar aspectRatio = height / width;\n\tvar canvas = document.createElement(\'canvas\');\n\tif(aspectRatio <= 1) {\n\t\tcanvas.width = Math.min(width, maxTextureSize);\n\t\tcanvas.height = canvas.width * aspectRatio;\n\t} else {\n\t\tcanvas.height = Math.min(height, maxTextureSize);\n\t\tcanvas.width = canvas.height / aspectRatio;\n\t}\n    this.context.bindTexture(this.context.TEXTURE_2D, this.texture);\n    this.context.pixelStorei(this.context.UNPACK_FLIP_Y_WEBGL, true);\n    var context = canvas.getContext(\'2d\');\n    context.drawImage(this.image, 0, 0, width, height, 0, 0, canvas.width, canvas.height);\n    var data = new Uint8Array(context.getImageData(0, 0, canvas.width, canvas.height).data);\n    this.context.texImage2D(this.context.TEXTURE_2D, 0, this.context.RGBA, canvas.width, canvas.height, 0, this.context.RGBA, this.context.UNSIGNED_BYTE, data);\n    this.trigger(EVENTS.BIND_TEXTURE);\n    this.context.bindTexture(this.context.TEXTURE_2D, null );\n};\n\nPhotoSphereRenderer.prototype._bindCubeStripTexture = function() {\n\tif( !this.isImageLoaded() ) {\n\t\treturn;\n\t}\n\n \tvar agent = eg.agent();\n\n    var image = this.image; \n\n    var hasDrawImageBug = false;\n\n    if (agent.browser.name === "sbrowser" && parseFloat(window.navigator.userAgent.split("SamsungBrowser/")[1].split(\' \')[0]) < 5 //   5 \n        || (agent.os.name === "ios" && (parseInt(agent.os.version, 10) <= 9))) {\n        hasDrawImageBug = true;\n    }\n\n\tvar width = this.imageWidth;\n\n    var maxCubeMapTextureSize = this._getMaxCubeMapTextureSize(width);\n\n\t//  4.3    5.0.2      \n\t//  : https://code.google.com/p/android/issues/detail?id=5141\n \tvar heightScale = 1;\n\n    // TODO :  S drawImage  , height       .\n    //  drawImage            .\n    if ( agent.os.name === "android" ) {\n        if ((parseFloat(agent.os.version) <= 4.3 && agent.browser.name === "chrome") ||\n            (agent.os.version === "5.0.2" && agent.browser.name === "sbrowser") ||\n            (agent.os.version === "5.1.1" && agent.browser.name === "sbrowser"\n                && window.navigator.userAgent.indexOf("SM-N920") !== -1\n                && parseFloat(window.navigator.userAgent.split("SamsungBrowser/")[1].split(\' \')[0]) < 4) //   4 \n        ) {\n            heightScale = 768 / width;\n        }\n        else if (agent.os.version === "5.0" && agent.browser.name === "sbrowser"\n            && window.navigator.userAgent.indexOf("SM-G900") !== -1\n        ) {\n            heightScale = 1344 / width;\n        }\n    }\n\n    try {\n        this.context.pixelStorei(this.context.UNPACK_FLIP_Y_WEBGL, false);\n        this.context.bindTexture(this.context.TEXTURE_CUBE_MAP, this.texture);\n\n        if(!hasDrawImageBug) {\n            var canvas = document.createElement(\'canvas\');\n            canvas.width = maxCubeMapTextureSize;\n            canvas.height = maxCubeMapTextureSize;\n            var context = canvas.getContext(\'2d\');\n\n            for(var surfaceIdx = 0; surfaceIdx < 6; surfaceIdx++) {\n                context.drawImage(this.image, 0, surfaceIdx * (width * heightScale), width, width * heightScale, 0, 0, maxCubeMapTextureSize, maxCubeMapTextureSize);\n                var texImageData = new Uint8Array(context.getImageData(0, 0, maxCubeMapTextureSize, maxCubeMapTextureSize).data);\n                this.context.texImage2D(this.context.TEXTURE_CUBE_MAP_POSITIVE_X + surfaceIdx, 0, this.context.RGBA, maxCubeMapTextureSize, maxCubeMapTextureSize, 0, this.context.RGBA, this.context.UNSIGNED_BYTE, texImageData);\n            }\n        } else {\n            // #288, drawImage bug\n            var halfCanvas = document.createElement(\'canvas\');\n            var context = halfCanvas.getContext(\'2d\');\n            halfCanvas.width = maxCubeMapTextureSize * 3;\n            halfCanvas.height = maxCubeMapTextureSize;\n\n            var tileCanvas = document.createElement(\'canvas\');\n            var tileContext = tileCanvas.getContext(\'2d\');\n            tileCanvas.width = maxCubeMapTextureSize;\n            tileCanvas.height = maxCubeMapTextureSize;\n\n            for(var i=0;i<2;i++) {\n                context.save();\n                context.translate(0, maxCubeMapTextureSize);\n                context.rotate(-Math.PI/2);\n                context.scale(1/3, 3)\n                context.drawImage(this.image, 0, width * 3 * i * heightScale, this.image.width, this.image.height/2 * heightScale, 0, 0, halfCanvas.width, halfCanvas.height); \n                context.restore();\n                for(var j=0;j<3;j++) {\n                    tileContext.save();\n                    tileContext.translate(maxCubeMapTextureSize, 0);\n                    tileContext.rotate(Math.PI/2);        \n                    tileContext.drawImage(halfCanvas, j * width, 0, width, width, 0, 0, maxCubeMapTextureSize, maxCubeMapTextureSize);\n                    tileContext.restore(); \n                    var texImageData = new Uint8Array(tileContext.getImageData(0, 0, maxCubeMapTextureSize, maxCubeMapTextureSize).data);\n                    this.context.texImage2D(this.context.TEXTURE_CUBE_MAP_POSITIVE_X + i * 3 + j, 0, this.context.RGBA, maxCubeMapTextureSize, maxCubeMapTextureSize, 0, this.context.RGBA, this.context.UNSIGNED_BYTE, texImageData);\n               }\n            }     \n        }\n    } catch(e) {\n\n    }\n    this.trigger(EVENTS.BIND_TEXTURE);\n    this.context.bindTexture(this.context.TEXTURE_CUBE_MAP, null );\n};\n\nmodule.exports = PhotoSphereRenderer;\n\n},{"./ProjectionType":13,"./eg.js":19,"./getErrorNameFromWebGLErrorCode":20,"./utils/math-util.js":27,"inherits":1}],13:[function(_dereq_,module,exports){\nmodule.exports = {\n\tEQUIRECTANGULAR: "equirectangular",\n\tVERTICAL_CUBESTRIP: "vertical_cubestrip"\n};\n\n},{}],14:[function(_dereq_,module,exports){\nvar errorType = {\n\tINVALID_DEVICE: 10,\n\tNO_WEBGL: 11\n};\n\nmodule.exports = {\n\tERROR_TYPE: errorType\n};\n},{}],15:[function(_dereq_,module,exports){\nvar vec3 = _dereq_("../utils/math-util.js").vec3;\nvar ns = _dereq_("../eg.js");\nvar eg = ns.eg;\nvar inherits = _dereq_("inherits");\n\ninherits(DeviceMotion, eg.Component);\n\nvar STILLNESS_THRESHOLD = 200; // millisecond\n\n//     \nfunction DeviceMotion() {\n    DeviceMotion.super_.call(this);\n    this._onDeviceMotion = this._onDeviceMotion.bind(this);\n    this._onDeviceOrientation = this._onDeviceOrientation.bind(this);\n \t\n    this.isAndroid = false;\n    var agent = eg.agent();\n    if ( agent.os.name === "android" ) {\n        this.isAndroid = true;\n    }\n\n    this.stillGyroVec = vec3.create();\n    this.rawGyroVec = vec3.create();\n    this.adjustedGyroVec = vec3.create();\n\n    this._timer = null;\n\n    this.lastDevicemotionTimestamp = 0;\n}\n\nDeviceMotion.prototype._onDeviceOrientation = function(e) {\n    var self = this;\n\n    this._timer && clearTimeout(this._timer);\n    this._timer = setTimeout(function() {\n        if((new Date().getTime() - self.lastDevicemotionTimestamp) < STILLNESS_THRESHOLD) {\n            vec3.copy(self.stillGyroVec, self.rawGyroVec);\n        }\n    }, STILLNESS_THRESHOLD);\n};\n\nDeviceMotion.prototype._onDeviceMotion = function(e) {\n    if(this.isAndroid) {\n        vec3.set(\n            this.rawGyroVec,\n            e.rotationRate.alpha || 0,\n            e.rotationRate.beta || 0,\n            e.rotationRate.gamma || 0\n        );\n        vec3.subtract(this.adjustedGyroVec, this.rawGyroVec, this.stillGyroVec);\n        this.lastDevicemotionTimestamp = new Date().getTime();\n\n        //this.emit("devicemotion", e);\n        e.adjustedRotationRate = {\n            alpha: this.adjustedGyroVec[0],\n            beta: this.adjustedGyroVec[1],\n            gamma: this.adjustedGyroVec[2]\n        };\n    }\n\n    this.trigger("devicemotion", e);\n};\n\nDeviceMotion.prototype.connect = function() {   \n    if(this.isAndroid) {\n        window.addEventListener(\'deviceorientation\', this._onDeviceOrientation);\n    }\n    window.addEventListener(\'devicemotion\', this._onDeviceMotion);\n};\n\nDeviceMotion.prototype.disconnect = function() {\n    if(this.isAndroid) {\n        window.removeEventListener(\'deviceorientation\', this._onDeviceOrientation);\n    }\n    window.removeEventListener(\'devicemotion\', this._onDeviceMotion);\n};\n\nmodule.exports = DeviceMotion;\n},{"../eg.js":19,"../utils/math-util.js":27,"inherits":1}],16:[function(_dereq_,module,exports){\n/**\n * Originaly from https://github.com/mrdoob/three.js/blob/master/examples/js/controls/DeviceOrientationControls.js\n * glmatrix   \n */\nvar util = _dereq_("../utils/math-util.js").util;\nvar vec3 = _dereq_("../utils/math-util.js").vec3\nvar quat = _dereq_("../utils/math-util.js").quat;\nvar glMatrix = _dereq_("../utils/math-util.js").glMatrix;\n\nvar ControlMode = _dereq_("../ControlMode");\nvar ns = _dereq_("../eg.js");\nvar eg = ns.eg;\nvar inherits = _dereq_(\'inherits\');\n\nvar FusionPoseSensor = _dereq_(\'./FusionPoseSensor.js\');\n\ninherits( DeviceOrientationControls, eg.Component);\n\nfunction DeviceOrientationControls( controlMode , spericalConfig ) {\n\n\t// Super constructor\n\tDeviceOrientationControls.super_.call(this);\n\t\n\tthis.controlMode = controlMode;\n\n\tthis.quaternion = quat.create();\n\tthis.prevQuaternion = quat.create();\n\tthis.relativeQuaternion = quat.create();\n\n\t// initialPitch    .\n\tthis.pitch = spericalConfig.initialPitch; // degree\n\tthis.yaw = spericalConfig.initialYaw; // degree\n\tthis.fieldOfView = spericalConfig.initialFieldOfView; // degree\n\n\t// TODO:  .\n\t// this._pitchRange = {\n\t// \tmin: -(90 - this.fieldOfView/2),\n\t// \tmax: (90 - this.fieldOfView/2)\n\t// };\n\n\t// this._pitchRangeOffset = 0;\n\t\n\tthis.offsetQuaternion = null;\n\t//this.offsetQuaternion_ = null;\n\t\n\tthis.enabled = true;\n\n\tthis.deviceOrientation = {};\n\tthis.screenOrientation = 0;\n\n\t// this.alpha = 0;\n\t// this.alphaOffsetAngle = 0;\n\t\n\tthis._initFusionPoseSensor();\n};\n\nDeviceOrientationControls.prototype._initFusionPoseSensor = function() {\n\tthis.fusionPoseSensor = new FusionPoseSensor();\n\n\tthis.fusionPoseSensor.on("change", function() {\n\t\tthis.update();\n\t\t\n\t\t//    delta yaw pitch  \t\t\t\t\t\n\t\tvar deltaYaw = this.prevYaw !== undefined ? (180 + this.yaw) - (180 + this.prevYaw) : 0;\n\t\tvar deltaPitch = this.prevPitch !== undefined ? (90 + this.pitch) - (90 + this.prevPitch) : 0;\n\t\t\n\t\tswitch(this.controlMode) {\n\t\t\tcase ControlMode.VR:\n\t\t\tcase ControlMode.VR_YAW:\n\t\t\t\tthis.trigger("change", {\n\t\t\t\t\tquaternion: this.quaternion,\n\t\t\t\t\tdeltaYaw: deltaYaw,\n\t\t\t\t\tdeltaPitch: deltaPitch\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase ControlMode.GALLERY:\t\n\t\t\tcase ControlMode.GALLERY_YAW:\n\t\t\tcase ControlMode.GALLERY_PITCH:\n\t\t\tcase ControlMode.GALLERY_YAW_PITCH:\t\n\t\t\t\tthis.trigger("change", {\n\t\t\t\t\tquaternion: this.relativeQuaternion,\n\t\t\t\t\tdeltaYaw: deltaYaw,\n\t\t\t\t\tdeltaPitch: deltaPitch\n\t\t\t\t});\n\t\t\t\tbreak;\t\t\t\t\n\t\t}\n\t\t\n\t\tthis.prevYaw = this.yaw;\n\t\tthis.prevPitch = this.pitch;\n\t}.bind(this));\t\n};\n\n\nDeviceOrientationControls.prototype.connect = function() {\n\tthis._initFusionPoseSensor();\n\tthis.fusionPoseSensor.connect();\n\tthis.enabled = true;\t\n};\n\nDeviceOrientationControls.prototype.disconnect = function() {\n\tthis.fusionPoseSensor && this.fusionPoseSensor.disconnect();\n\tthis.fusionPoseSensor = null;\n\n\tthis.quaternion = quat.create();\n\tthis.prevQuaternion = quat.create();\n\tthis.relativeQuaternion = quat.create();\n\t\n\tthis.offsetQuaternion = null;\n\t//this.offsetQuaternion_ = null;\n\n\tthis.enabled = false;\n};\n\nDeviceOrientationControls.prototype.destroy = function() {\n\tthis.disconnect();\n};\n\nDeviceOrientationControls.prototype.update = function() {\n\tif ( this.enabled === false ) return;\n\n\t// update absolute quaternion\n\tvar quaternion = quat.normalize(quat.create(), this.fusionPoseSensor.getOrientation());\n\n\tif(this.offsetQuaternion === null) {\t\t\n\t\tthis.offsetQuaternion = quat.clone(quaternion);\n\t}\n\n\tquat.copy(this.prevQuaternion, this.quaternion);\n\n\tquat.copy(this.quaternion, quaternion);\n\n\t// update relative quaternion\n\tthis._computeRelativeQuaternion();\n};\n\n//   : http://www.gisdeveloper.co.kr/entry/-\n//  ,  (,)  : http://darkpgmr.tistory.com/121\n//      \n// targetAxis of phone.\n// meshPoint2\nvar ROTATE_CONSTANT = {\n\tPITCH_DELTA: 1,\n\tYAW_DELTA_BY_ROLL: 2,\n\tYAW_DELTA_BY_YAW: 3\n};\n\nROTATE_CONSTANT[ROTATE_CONSTANT.PITCH_DELTA] = {\n\ttargetAxis: [0, 1, 0],\n\tmeshPoint: [0, 0, 1]\n};\nROTATE_CONSTANT[ROTATE_CONSTANT.YAW_DELTA_BY_ROLL] = {\n\ttargetAxis: [0, 1, 0],\n\tmeshPoint: [1, 0, 0]\n};\nROTATE_CONSTANT[ROTATE_CONSTANT.YAW_DELTA_BY_YAW] = {\n\ttargetAxis: [1, 0, 0],\n\tmeshPoint: [0, 0, 1]\n};\n\nfunction getRotationDelta(prevQuaternion_, curQuaternion_, rotateKind) {\n\tvar targetAxis_ = ROTATE_CONSTANT[rotateKind].targetAxis;\n\tvar meshPoint_ = ROTATE_CONSTANT[rotateKind].meshPoint;\n\t\n\tvar prevQuaternion = quat.clone(prevQuaternion_);\n\tquat.normalize(prevQuaternion, prevQuaternion)\n\tvar curQuaternion = quat.clone(curQuaternion_);\n\tquat.normalize(curQuaternion, curQuaternion )\n\n\t//    product      dot product  value   -> yaw   \n\tvar prevPoint = vec3.fromValues(0,0,1);\n\tvar curPoint = vec3.fromValues(0,0,1);\n\tvar targetAxis = vec3.fromValues(targetAxis_[0], targetAxis_[1], targetAxis_[2]); \n\n\tvec3.transformQuat(prevPoint, prevPoint, prevQuaternion);\n\tvec3.transformQuat(curPoint, curPoint, curQuaternion);\t\t\n\tvec3.transformQuat(targetAxis, targetAxis, curQuaternion);\t\t\n\t\t\n\tvar rotateDistance = vec3.dot(targetAxis, vec3.cross(vec3.create(), prevPoint, curPoint));\n\tvar rotateDirection = rotateDistance > 0 ? 1 : -1;\n\t\n\t//     vec3.fromValues(0,1,0);    vec3.fromValues(0,-1,0);   .\n\tvar meshPoint1 = vec3.fromValues(0, 0, 0);\n\tvar meshPoint2 = vec3.fromValues(meshPoint_[0], meshPoint_[1], meshPoint_[2]);\n\tif(rotateKind !== ROTATE_CONSTANT.YAW_DELTA_BY_YAW) {\n\t\tvar meshPoint3 = vec3.fromValues(0, rotateDirection, 0);\n\t} else {\n\t\tvar meshPoint3 = vec3.fromValues(rotateDirection, 0, 0);\n\t}\n\n\tvec3.transformQuat(meshPoint2, meshPoint2, curQuaternion);\n\tvec3.transformQuat(meshPoint3, meshPoint3, curQuaternion);\t\n\t\n\tvar vecU = meshPoint2;\n\tvar vecV = meshPoint3;\n\tvar vecN = vec3.create();\n\tvec3.cross(vecN, vecU, vecV);\n\tvec3.normalize(vecN, vecN)\n\t\n\tvar coefficientA = vecN[0];\n\tvar coefficientB = vecN[1];\n\tvar coefficientC = vecN[2];\n\tvar coefficientD = -1 * vec3.dot(vecN, meshPoint1);\n\n\t//     \n\tvar curPoint = vec3.fromValues(meshPoint_[0], meshPoint_[1], meshPoint_[2]);\n\tvec3.transformQuat(curPoint, curPoint, curQuaternion);\n\t\n\t//       \n\tvar prevPoint = vec3.fromValues(meshPoint_[0], meshPoint_[1], meshPoint_[2]);\n\tvec3.transformQuat(prevPoint, prevPoint, prevQuaternion);\n\t\n\t// prevPoint     \n\tvar distance = Math.abs(\n\t\tprevPoint[0] * coefficientA\n\t\t+ prevPoint[1] * coefficientB\n\t\t+ prevPoint[2] * coefficientC\n\t);\t\n\t\n\tvar projectedPrevPoint = vec3.create();\n\tvec3.subtract(projectedPrevPoint, prevPoint, vec3.scale(vec3.create(), vecN, distance));\n\n\tvar trigonometricRatio = ( projectedPrevPoint[0] * curPoint[0] +  projectedPrevPoint[1] * curPoint[1] +  projectedPrevPoint[2] * curPoint[2] )\n\t\t/ \n\t\t( vec3.length(projectedPrevPoint) * vec3.length(curPoint) );\n\n\t// 1  . \n\tif(trigonometricRatio > 1) {\n\t\ttrigonometricRatio = 1;\n\t}\n\n\tvar theta = Math.acos(trigonometricRatio);\n\n\tvar crossVec = vec3.create();\n\tvec3.cross(crossVec, curPoint, projectedPrevPoint);\n\t\n\tvar distance = coefficientA * crossVec[0] + coefficientB * crossVec[1]+ coefficientC * crossVec[2];\n\n\tif(rotateKind !== ROTATE_CONSTANT.YAW_DELTA_BY_YAW) {\n\t\tvar thetaDirection = distance > 0 ? 1 : -1;\n\t} else {\n\t\tvar thetaDirection = distance < 0 ? 1 : -1;\n\t}\n\t\n\tvar deltaRadian = theta * thetaDirection * rotateDirection;\n\n\treturn glMatrix.toDegree(deltaRadian);\n}\n\n// TODO:  .\n// DeviceOrientationControls.prototype.setPitchRangeOffset = function( offset ) { // offset: degree\n// \tthis._pitchRangeOffset = offset;\n\n// \tthis._pitchRange = {\n// \t\tmin: -(90 - this.fieldOfView/2) + offset,\n// \t\tmax: (90 - this.fieldOfView/2) + offset\n// \t};\n// };\n\n// DeviceOrientationControls.prototype.getPitchRange = function( ) { // offset: degree\n// \treturn this._pitchRange;\n// }\n\n\nDeviceOrientationControls.prototype._computeRelativeQuaternion = function(  ) {\t\n\tif(this.offsetQuaternion === null) {\t\n\t\treturn;\t\t\t\n\t}\n\t// TODO: ??      TC   \n\tif(\t\t\n\t\tquat.exactEquals(\n\t\t\tquat.fromValues(this.prevQuaternion[0], this.prevQuaternion[1], this.prevQuaternion[2], this.prevQuaternion[3]),\n\t\t\tquat.create()\n\t\t) || util.extractYawFromQuat(this.prevQuaternion) === 0\n\t) {\n\t\treturn;\n\t}\n\t\n\tif(!this._skippedFirst) {\t\n\t\tthis._skippedFirst = true;\n\t\treturn;\n\t}\n\t\n\t// this.offsetQuaternion :    \n    // this.quaternion :   \n\tvar quaternionQ = quat.create();\n\tquat.normalize(quaternionQ, this.quaternion);\n\t\n\tvar offsetQuaternionQ = quat.create();\n\tquat.normalize(offsetQuaternionQ, this.offsetQuaternion);\n\t\t\n\tvar relativeQuaternionQ = quat.create();\n\n\tvar pitchDelta = getRotationDelta(this.prevQuaternion,  this.quaternion, ROTATE_CONSTANT.PITCH_DELTA);\n\tvar yawDeltaByRoll = getRotationDelta(this.prevQuaternion,  this.quaternion, ROTATE_CONSTANT.YAW_DELTA_BY_ROLL);\n\tyawDeltaByRoll = Math.sin(util.extractPitchFromQuat(quaternionQ)) * yawDeltaByRoll;\t\t\t\n\tvar yawDeltaByYaw = getRotationDelta(this.prevQuaternion,  this.quaternion, ROTATE_CONSTANT.YAW_DELTA_BY_YAW);\n\n\tif(!isNaN(yawDeltaByRoll) && !isNaN(yawDeltaByYaw)) {\n\t\tthis.yaw = this.yaw + yawDeltaByRoll + yawDeltaByYaw;\n\t}\n\n\tif(this.yaw < -180) {\n\t\tthis.yaw = 360 + this.yaw;\n\t}\n\tif(this.yaw > 180) {\n\t\tthis.yaw = this.yaw - 360;\n\t}\n\t\n\t// PITCH \n\tthis.pitch = this.pitch + pitchDelta;\n\t\t\n\tquat.rotateY(relativeQuaternionQ, relativeQuaternionQ, glMatrix.toRadian(this.yaw)); \n\tquat.rotateX(relativeQuaternionQ, relativeQuaternionQ, glMatrix.toRadian(this.pitch));\n\tquat.copy(this.relativeQuaternion, relativeQuaternionQ);\n};\n\nDeviceOrientationControls.prototype.updateOffsetQuaternion = function(  ) {\n\n\tquat.copy(this.offsetQuaternion, this.quaternion);\n\tthis.update();\n\n};\n\nmodule.exports = DeviceOrientationControls;\n},{"../ControlMode":10,"../eg.js":19,"../utils/math-util.js":27,"./FusionPoseSensor.js":17,"inherits":1}],17:[function(_dereq_,module,exports){\n/*\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// IE9   Float32Array      \nwindow.Float32Array = (typeof Float32Array !== \'undefined\') ? Float32Array : Array;\n\nvar ComplementaryFilter = _dereq_(\'../../node_modules/webvr-polyfill/src/sensor-fusion/complementary-filter.js\');\nvar PosePredictor = _dereq_(\'../../node_modules/webvr-polyfill/src/sensor-fusion/pose-predictor.js\');\nvar MathUtil = _dereq_(\'../../node_modules/webvr-polyfill/src/math-util.js\');\n\nvar Util = _dereq_(\'../../node_modules/webvr-polyfill/src/util.js\');\n\nvar quat = _dereq_("../utils/math-util.js").quat;\nvar glMatrix = _dereq_("../utils/math-util.js").glMatrix;\nvar DeviceMotion = _dereq_("./DeviceMotion.js");\nvar ns = _dereq_("../eg.js");\nvar eg = ns.eg;\nvar inherits = _dereq_("inherits");\n\nvar K_FILTER = 0.98;\nvar PREDICTION_TIME_S = 0.020;\n\ninherits(FusionPoseSensor, eg.Component);\n\n/**\n * The pose sensor, implemented using DeviceMotion APIs.\n */\nfunction FusionPoseSensor() {\n  FusionPoseSensor.super_.call(this);\n\t\n  this.deviceId = \'webvr-polyfill:fused\';\n  this.deviceName = \'VR Position Device (webvr-polyfill:fused)\';\n\n  this.deviceMotion = new DeviceMotion();\n\n  this.accelerometer = new MathUtil.Vector3();\n  this.gyroscope = new MathUtil.Vector3();\n\n  this.onDeviceMotionChange_ = this.onDeviceMotionChange_.bind(this);\n  this.onScreenOrientationChange_ = this.onScreenOrientationChange_.bind(this);\n\n  this.filter = new ComplementaryFilter(K_FILTER);\n  this.posePredictor = new PosePredictor(PREDICTION_TIME_S);\n\n  this.filterToWorldQ = new MathUtil.Quaternion();\n\n  // Set the filter to world transform, depending on OS.\n  if (Util.isIOS()) {\n    this.filterToWorldQ.setFromAxisAngle(new MathUtil.Vector3(1, 0, 0), Math.PI / 2);\n  } else {\n    this.filterToWorldQ.setFromAxisAngle(new MathUtil.Vector3(1, 0, 0), -Math.PI / 2);\n  }\n\n  this.inverseWorldToScreenQ = new MathUtil.Quaternion();\n  this.worldToScreenQ = new MathUtil.Quaternion();\n  this.originalPoseAdjustQ = new MathUtil.Quaternion();\n  this.originalPoseAdjustQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1),\n                                           -window.orientation * Math.PI / 180);\n\n  this.setScreenTransform_();\n  // Adjust this filter for being in landscape mode.\n  if (Util.isLandscapeMode()) {\n    this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);\n  }\n\n  // Keep track of a reset transform for resetSensor.\n  this.resetQ = new MathUtil.Quaternion();\n\n  this.isFirefoxAndroid = Util.isFirefoxAndroid();\n  this.isIOS = Util.isIOS();\n\n  this.orientationOut_ = new glMatrix.ARRAY_TYPE(4);\n\n  this.deviceMotion.on("devicemotion", this.onDeviceMotionChange_);\n}\n\nFusionPoseSensor.prototype.connect = function() {\n  this.deviceMotion.connect();\n  //window.addEventListener(\'devicemotion\', this.onDeviceMotionChange_);\n  window.addEventListener(\'orientationchange\', this.onScreenOrientationChange_);\n};\n\nFusionPoseSensor.prototype.disconnect = function() {\n  this.deviceMotion.disconnect();\n  //window.removeEventListener(\'devicemotion\', this.onDeviceMotionChange_);\n  window.removeEventListener(\'orientationchange\', this.onScreenOrientationChange_);\n};\n\n\nFusionPoseSensor.prototype._emitChange = function() {\n\tthis.trigger("change");\n};\n\n\nFusionPoseSensor.prototype._emitConnected= function() {\n\tthis.isConnected = true;\n\tthis.trigger("connected");\n\t\n};\n\n\nFusionPoseSensor.prototype.getPosition = function() {\n  // This PoseSensor doesn\'t support position\n  return null;\n};\n\nFusionPoseSensor.prototype.getOrientation = function() {\n  // Convert from filter space to the the same system used by the\n  // deviceorientation event.\n  var orientation = this.filter.getOrientation();\n\n\n  // Predict orientation.\n  var out = this._convertFusionToPredicted(orientation);\n\n//  var out = orientation;\n\n  this.orientationOut_[0] = out.x;\n  this.orientationOut_[1] = out.y;\n  this.orientationOut_[2] = out.z;\n  this.orientationOut_[3] = out.w;\n\n  return this.orientationOut_;\n};\n\nFusionPoseSensor.prototype._convertFusionToPredicted = function(orientation) {\n  // Predict orientation.\n  this.predictedQ = this.posePredictor.getPrediction(orientation, this.gyroscope, this.previousTimestampS);\n \n  // Convert to THREE coordinate system: -Z forward, Y up, X right.\n  var out = new MathUtil.Quaternion();\n  out.copy(this.filterToWorldQ);\n  out.multiply(this.resetQ);\n\n  out.multiply(this.predictedQ);\n\n  out.multiply(this.worldToScreenQ);\n\n  return out;\n};\n\nFusionPoseSensor.prototype.resetPose = function() {\n  // Reduce to inverted yaw-only.\n  this.resetQ.copy(this.filter.getOrientation());\n  this.resetQ.x = 0;\n  this.resetQ.y = 0;\n  this.resetQ.z *= -1;\n  this.resetQ.normalize();\n\n  // Take into account extra transformations in landscape mode.\n  if (Util.isLandscapeMode()) {\n    this.resetQ.multiply(this.inverseWorldToScreenQ);\n  }\n\n  // Take into account original pose.\n  this.resetQ.multiply(this.originalPoseAdjustQ);\n};\n\nFusionPoseSensor.prototype.onDeviceMotionChange_ = function(deviceMotion) {\n  var accGravity = deviceMotion.accelerationIncludingGravity;\n  var rotRate = deviceMotion.adjustedRotationRate || deviceMotion.rotationRate;\n  var timestampS = deviceMotion.timeStamp / 1000;\n\n  // Firefox Android timeStamp returns one thousandth of a millisecond.\n  if (this.isFirefoxAndroid) {\n    timestampS /= 1000;\n  }\n\n  var deltaS = timestampS - this.previousTimestampS;\n  if (deltaS <= Util.MIN_TIMESTEP || deltaS > Util.MAX_TIMESTEP) {\n    console.warn(\'Invalid timestamps detected. Time step between successive \' +\n                 \'gyroscope sensor samples is very small or not monotonic\');\n    this.previousTimestampS = timestampS;\n    return;\n  }\n  \n  this.accelerometer.set(-accGravity.x, -accGravity.y, -accGravity.z);\n  this.gyroscope.set(rotRate.alpha, rotRate.beta, rotRate.gamma);\n\n  // With iOS and Firefox Android, rotationRate is reported in degrees,\n  // so we first convert to radians.\n  if (this.isIOS || this.isFirefoxAndroid) {\n    this.gyroscope.multiplyScalar(Math.PI / 180);\n  }\n\n  this.filter.addAccelMeasurement(this.accelerometer, timestampS);\n  this.filter.addGyroMeasurement(this.gyroscope, timestampS);\n\n  if(this.previousTimestampS === undefined) {\n\t  this._emitConnected();\n  } \n  \n  this._emitChange();\n   \n  this.previousTimestampS = timestampS;\n};\n\nFusionPoseSensor.prototype.onScreenOrientationChange_ =\n    function(screenOrientation) {\n  this.setScreenTransform_(window.orientation);\n};\n\nFusionPoseSensor.prototype.setScreenTransform_ = function( ) {\n  this.worldToScreenQ.set(0, 0, 0, 1);\n  switch (window.orientation) {\n    case 0:\n      break;\n    case 90:\n      this.worldToScreenQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1), 90 / -180 * Math.PI );\n      break;\n    case -90:\n      this.worldToScreenQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1), -90 / -180 * Math.PI);\n      break;\n    case 180:\n      this.worldToScreenQ.setFromAxisAngle(new MathUtil.Vector3(0, 0, 1), 180 / -180 * Math.PI);\n      break;\n  }\n  this.inverseWorldToScreenQ.copy(this.worldToScreenQ);\n  this.inverseWorldToScreenQ.inverse();\n};\n\t\nmodule.exports = FusionPoseSensor;\n},{"../../node_modules/webvr-polyfill/src/math-util.js":4,"../../node_modules/webvr-polyfill/src/sensor-fusion/complementary-filter.js":5,"../../node_modules/webvr-polyfill/src/sensor-fusion/pose-predictor.js":6,"../../node_modules/webvr-polyfill/src/util.js":8,"../eg.js":19,"../utils/math-util.js":27,"./DeviceMotion.js":15,"inherits":1}],18:[function(_dereq_,module,exports){\nvar glMatrix = _dereq_("../utils/math-util.js").glMatrix;\nvar inherits = _dereq_("inherits");\nvar ns = _dereq_("../eg.js");\nvar eg = ns.eg;\nvar Hammer = ns.Hammer || window.Hammer;\n\nvar ControlMode = _dereq_("../ControlMode");\n\ninherits(PointerControls, eg.Component);\n\n// \nvar MC_DECELERATION = 0.0014;\n\n//  \nvar MC_MAXIMUM_DURATION = 1000;\n\n//   \nvar MC_BIND_SCALE = [0.20, 0.20];\n\nvar MAX_FIELD_OF_VIEW = 110;\nvar MIN_FIELD_OF_VIEW = 20;\n\nvar PAN_SCALE = 320;\n\nfunction easeOutCubic (x) {\n\treturn 1 - Math.pow(1 - x, 3);\n}\n\nfunction PointerControls(\n\ttargetElement,\n\toptions\n/*\n\t\t\t\tinitialYaw: this.initialConfig.yaw,\n\t\t\t\tinitialPitch:  this.initialConfig.pitch,\n\t\t\t\tinitialFieldOfView: this.initialConfig.fieldOfView,\n\t\t\t\tcontrolMode: options.controlMode,\n\t\t\t\tallowPinchZoom: options.allowPinchZoom,\n\t\t\t\tminFieldOfView: options.minFieldOfView,\n\t\t\t\tmaxFieldOfView: options.minFieldOfView\n*/\n) {\n\tPointerControls.super_.call(this);\n\tthis.targetElement = targetElement;\n\tthis.controlMode = options.controlMode;\n\tthis.allowPinchZoom = options.allowPinchZoom;\n\n\tthis.isConnected = false;\n\n\tthis.yaw = options.initialYaw;\n\tthis.pitch = options.initialPitch;\n\tthis.fieldOfView = options.initialFieldOfView;\n\tthis.initialFieldOfView = options.initialFieldOfView;\n\n\tthis._triggerChange = this._triggerChange.bind(this);\n\n\t//  min max  this._pos.concat();\n\tthis.movableCoord = new eg.MovableCoord({\n\t\tmin: [-180, -90],\n\t\tmax: [180, 90],\n\t\tbounce: [0, 0, 0, 0],\n\t\tcircular: [true, true, true, true],\n\t\teasing: easeOutCubic,\n\t\tdeceleration: MC_DECELERATION,\n\t\tmaximumDuration: MC_MAXIMUM_DURATION\n\t}).on({\n\t\t"change": function(evt) {\n\t\t\tthis.yaw = evt.pos[0];\n\t\t\tthis.pitch = evt.pos[1];\n\t\t\tthis._triggerChange();\n\t\t}.bind(this),\n\t\t"animationEnd": function(evt) {\n\t\t\tthis.isPanning = false;\n\t\t\tthis.trigger("animationEnd");\n\t\t}.bind(this),\n\t\t"hold": function(evt) {\n\t\t\tthis.isPanning = true;\n\t\t\tthis.trigger("hold");\n\t\t}.bind(this)\n\t});\n\n\t//   \n\tthis.fieldOfViewCoord = new eg.MovableCoord({\n\t\tmin: [options.minFieldOfView | MIN_FIELD_OF_VIEW , 1],\n\t\tmax: [options.maxFieldOfView | MAX_FIELD_OF_VIEW, 1],\n\t\tbounce: [0, 0, 0, 0],\n\t\tcircular: [false, false, false, false],\n\t\teasing: easeOutCubic,\n\t\tdeceleration: MC_DECELERATION,\n\t\tmaximumDuration: MC_MAXIMUM_DURATION\n\t}).on({\n\t\t"change": function(evt) {\n\t\t\tvar fov = evt.pos[0];\n\t\t\tthis.fieldOfView = fov;\n\t\t\tthis.updateMovableCoordScale();\n\t\t\tthis._triggerChange();\n\t\t}.bind(this),\n\t\t"animationEnd": function(evt) {\n\t\t\tthis.trigger("animationEnd");\n\t\t}.bind(this)\n\t});\n\n\tthis.movableCoord.setTo(options.initialYaw, options.initialPitch);\n\tthis.fieldOfViewCoord.setTo(options.initialFieldOfView, 1);\n};\n\nPointerControls.prototype.setFieldOfViewRange = function(minFieldOfView, maxFieldOfView) {\n\tminFieldOfView && this.fieldOfViewCoord.option("min", [minFieldOfView, 1]);\n\tmaxFieldOfView && this.fieldOfViewCoord.option("max", [maxFieldOfView, 1]);\n};\n\nfunction getControlDirection(controlMode) {\n\tif( controlMode === ControlMode.YAW_PITCH ||\n\t\tcontrolMode === ControlMode.GALLERY_YAW_PITCH ) {\n\t\treturn eg.MovableCoord.DIRECTION_ALL;\n\t} else if(\n\t\tcontrolMode === ControlMode.VR ||\n\t\tcontrolMode === ControlMode.GALLERY\n\t) {\n\t\treturn eg.MovableCoord.DIRECTION_NONE;\n\t} else if(\n\t\tcontrolMode === ControlMode.VR_YAW ||\n\t\tcontrolMode === ControlMode.YAW ||\n\t\tcontrolMode === ControlMode.GALLERY_YAW\n\t) {\n\t\treturn eg.MovableCoord.DIRECTION_HORIZONTAL;\n\t} else if(\n\t\tcontrolMode === ControlMode.GALLERY_PITCH\n\t) {\n\t\treturn eg.MovableCoord.DIRECTION_VERTICAL;\n\t}\n}\n\nPointerControls.prototype.setPitch = function(pitch) {\n\tvar orientation = this.movableCoord.get();\n\tthis.movableCoord.setTo(orientation[0], pitch, 0);\n};\n\nPointerControls.prototype.connect = function() {\n\tvar controlDirection = getControlDirection(this.controlMode);\n\n\tthis._originalTouchActionStyle = this.targetElement.style.touchAction;\n\n\tvar areaHeight = parseInt(window.getComputedStyle(this.targetElement).height, 10);\n\tvar scale = MC_BIND_SCALE[0] * this.fieldOfView / this.initialFieldOfView * PAN_SCALE / areaHeight ;\n\n\tthis.movableCoord.bind(this.targetElement, {\n\t\tdirection: controlDirection,\n\t\tscale: [scale, scale]\n\t});\n\n\t// movableCoord  hammer  Pan Recognizer  .\n\t//  Pan \n\t\n\tvar _hammer = this._hammer = this.movableCoord.getHammer(this.targetElement);\n\n\tvar _pan = _hammer.get(\'pan\');\n\tvar _panOptions = _pan.options;\n\t_panOptions.pointers = 0;\n\t_hammer.get(\'pan\').set(_panOptions);\n\n\n\t//    \n\tif(this.allowPinchZoom) {\n\t\tthis._bindFieldOfViewCoordHandler(this.targetElement);\n\t}\n\n\tthis.isConnected = true;\n\n\t// trigger first change event\n\tthis._triggerChange();\n\n\t//this.updateMovableCoordScale();\t\n};\n\nPointerControls.prototype.disconnect = function() {\n\tthis.movableCoord.unbind(this.targetElement);\n\tthis.targetElement.style.touchAction = this._originalTouchActionStyle;\n\tif(this.allowPinchZoom) {\n\t\tthis._unbindFieldOfViewCoordHandler();\n\t}\n\tthis.isConnected = false;\n};\n\n\nPointerControls.prototype._bindFieldOfViewCoordHandler = function(targetElement) {\n\tvar mc = this._hammer;\n    mc.add(new Hammer.Pinch({ threshold: 0 })).recognizeWith([mc.get(\'pan\')]);\n    mc.on("pinchstart pinchmove pinchend", this._onPinch.bind(this));\n};\n\nPointerControls.prototype._onPinch = function(evt) {\n\tif(evt.type === "pinchstart") {\n\t\tthis._pichStartFov = this.fieldOfViewCoord.get()[0];\n\t} else if(evt.type === "pinchmove") {\n\t\tvar fov = this._pichStartFov / evt.scale;\n\t\tif( fov < MIN_FIELD_OF_VIEW ) fov = MIN_FIELD_OF_VIEW;\n\t\telse if( fov > MAX_FIELD_OF_VIEW ) fov = MAX_FIELD_OF_VIEW;\n\t\t\n\t\tthis.fieldOfViewCoord.setTo(fov, 1, 0);\n\t} else if(evt.type === "pinchend") {\n\t\tdelete this._pichStartFov;\n\t}\n};\n\nPointerControls.prototype._unbindFieldOfViewCoordHandler = function(targetElement) {\n//\tthis._hammer.destroy();\n//\tdelete this._hammer;\n};\n\nPointerControls.prototype._triggerChange = function() {\n\tvar deltaYaw = this.prevYaw !== undefined ? (180 + this.yaw) - (180 + this.prevYaw) : 0;\n\tvar deltaPitch = this.prevPitch !== undefined ? (90 + this.pitch) - (90 + this.prevPitch) : 0;\n\n\tthis.trigger("change", {\n\t\tyaw: this.yaw,\n\t\tpitch: this.pitch,\n\t\tfieldOfView: this.fieldOfView,\n\t\tdeltaYaw: deltaYaw,\n\t\tdeltaPitch: deltaPitch\n\t});\n\n\tthis.prevYaw = this.yaw;\n\tthis.prevPitch = this.pitch;\n};\n\n\nPointerControls.prototype.setTo = function(sphericalConfig, duration) {\n\tif(sphericalConfig.fieldOfView !== undefined) {\n\t\t//      \n\t\tthis.fieldOfViewCoord.setTo(sphericalConfig.fieldOfView, 1, duration);\n\t}\n\n\tif(sphericalConfig.yaw !== undefined && sphericalConfig.pitch !== undefined) {\n\t\tthis.movableCoord.setTo(sphericalConfig.yaw, sphericalConfig.pitch, duration);\n\t}\n\n};\n\nPointerControls.prototype.setControlMode = function(controlMode) {\n\tthis.controlMode = controlMode;\n\tif(this.isConnected) {\n\t\tthis.disconnect();\n\t\tthis.connect();\n\t}\n};\n\nPointerControls.prototype.updateMovableCoordScale = function() {\n\tthis._setMovableCoordScale(this.fieldOfView);\n};\n\nPointerControls.prototype._setMovableCoordScale = function(fieldOfView) {\t\n\tvar mvOptions = this.movableCoord._subOptions || this.movableCoord._status.currentOptions;\n\n\t// TODO: movableCoord    .    .\n\tif (mvOptions) {\n\t\tvar areaHeight = parseInt(window.getComputedStyle(this.targetElement).height, 10);\n\t\tvar scale = MC_BIND_SCALE[0] * fieldOfView / this.initialFieldOfView * PAN_SCALE / areaHeight;\n\n\t\tif (mvOptions.scale) {\n\t\t\tmvOptions.scale[0] = scale;\n\t\t\tmvOptions.scale[1] = scale;\n\t\t} else {\n\t\t\tmvOptions.scale = [scale, scale];\n\t\t}\n\t}\n\n\tthis.movableCoord.option("deceleration", MC_DECELERATION * fieldOfView / MAX_FIELD_OF_VIEW);\n};\n\nPointerControls.prototype.destroy = function() {\n\tthis.disconnect();\n\tthis.movableCoord.destroy();\n\tthis.fieldOfViewCoord.destroy();\n};\n\nmodule.exports = PointerControls;\n\n},{"../ControlMode":10,"../eg.js":19,"../utils/math-util.js":27,"inherits":1}],19:[function(_dereq_,module,exports){\n/**\n * If changing namespace is needed,\n * Modify variables NAMESPACE, HAMMER_NAMESPACE as you want\n * \n * For example,\n * var NAMESPACE = "seEg";\n * var HAMMER_NAMESPACE = "seHammer";\n */\nvar NAMESPACE = "eg";\nvar HAMMER_NAMESPACE = "Hammer";\nvar GLOBAL = window;\n\nmodule.exports = {\n  global: GLOBAL,\n  eg: GLOBAL[NAMESPACE],\n  Hammer: GLOBAL[HAMMER_NAMESPACE]\n};\n},{}],20:[function(_dereq_,module,exports){\nvar WEBGL_ERROR_CODE = {\n    \'0\': \'NO_ERROR\',\n    \'1280\': \'INVALID_ENUM\',\n    \'1281\': \'INVALID_VALUE\',\n    \'1282\': \'INVALID_OPERATION\',\n    \'1285\': \'OUT_OF_MEMORY\',\n    \'1286\': \'INVALID_FRAMEBUFFER_OPERATION\',\n    \'37442\': \'CONTEXT_LOST_WEBGL\'\n};\n\nfunction getErrorNameFromWebGLErrorCode(code) {\n    if (!(code in WEBGL_ERROR_CODE))\n        return \'UNKNOWN_ERROR\';\n    return WEBGL_ERROR_CODE[code];\n}\n\nmodule.exports = getErrorNameFromWebGLErrorCode;\n},{}],21:[function(_dereq_,module,exports){\nmodule.exports = config = {\n\tVIEWER: {\n\t\tCLASS_NAME: {\n\t\t\tCONTAINER: "image360_container",\n\t\t\tFULLSCREEN_TOGGLE: "image360_fs_toggle",\n\t\t\tLOADING: "image360_loading",\n\t\t\tICON: "image360_icon",\n\t\t},\n\t\tBASE_HTML: \'<button class="image360_fs_toggle"></button>\' +\n\t\t\t\t\t\'<div class="image360_icon"></div>\' +\n\t\t\t\t\t\'<div class="image360_loading">\' +\n\t\t\t\t\t\t\'<div class="image360_loadingBar"></div>\' +\n\t\t\t\t\t\'</div>\' +\n\t\t\t\t\t\'<div class="image360_navigation"></div>\',\n\t\tSRC_TYPE: {\n\t\t\tIN_CONTENTS: "cube1024",\n\t\t\tFULLSCREEN: "cube1024"\n\t\t},\n\t\tOPTION: {\n\t\t\tPC: {\n\t\t\t\tEMBED: {\n\t\t\t\t\tcontrolMode: "yaw_pitch",\n\t\t\t\t\tfieldOfView: 65,\n\t\t\t\t\tyaw: 0,\n\t\t\t\t\tpitch: 0,\n\t\t\t\t\tprojectionType: "vertical_cubestrip",\n\t\t\t\t\tallowPinchZoom: false,\n\t\t\t\t\tcenterPolePoint: false\n\t\t\t\t},\n\t\t\t\tFULLSCREEN: {\n\t\t\t\t\tcontrolMode: "yaw_pitch",\n\t\t\t\t\tfieldOfView: 65,\n\t\t\t\t\tyaw: 0,\n\t\t\t\t\tpitch: 0,\n\t\t\t\t\tprojectionType: "vertical_cubestrip",\n\t\t\t\t\tallowPinchZoom: true,\n\t\t\t\t\tcenterPolePoint: false\n\t\t\t\t}\n\t\t\t},\n\t\t\tMOBILE: {\n\t\t\t\tEMBED: {\n\t\t\t\t\tcontrolMode: "gallery_yaw_pitch",\n\t\t\t\t\tfieldOfView: 65,\n\t\t\t\t\tyaw: 0,\n\t\t\t\t\tpitch: 0,\n\t\t\t\t\tprojectionType: "vertical_cubestrip",\n\t\t\t\t\tallowPinchZoom: false,\n\t\t\t\t\tcenterPolePoint: false\n\t\t\t\t},\n\t\t\t\tFULLSCREEN: {\n\t\t\t\t\tcontrolMode: "gallery_yaw_pitch",\n\t\t\t\t\tfieldOfView: 65,\n\t\t\t\t\tyaw: 0,\n\t\t\t\t\tpitch: 0,\n\t\t\t\t\tprojectionType: "vertical_cubestrip",\n\t\t\t\t\tallowPinchZoom: true,\n\t\t\t\t\tcenterPolePoint: false\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tNAVIGATION: {\n\t\t\tNAV_SIZE: 35,\n\t\t\tPIE_RADIUS: 11,\n\t\t\tHTML: {\n\t\t\t\tFRAME: \'<svg width="35px" height="35px" viewBox="0 0 35 35">\' +\n\t\t\t\t\t\'<circle fill-opacity="0.3" fill="#000000" cx="17.5" cy="17.5" r="17.5"></circle>\' +\n\t\t\t\t\t\'<path d="M18.8797632,4.06964482 C25.6874761,4.7607336 31,10.5099636 31,17.5 C31,24.9558441 24.9558441,31 17.5,31 C10.0441559,31 4,24.9558441 4,17.5 C4,10.5099636 9.31252385,4.7607336 16.1202368,4.06964482 L17.5,2 L18.8797632,4.06964482 L18.8797632,4.06964482 Z M17.5,30 C24.4035594,30 30,24.4035594 30,17.5 C30,10.5964406 24.4035594,5 17.5,5 C10.5964406,5 5,10.5964406 5,17.5 C5,24.4035594 10.5964406,30 17.5,30 Z" fill-opacity="0.8" fill="#FFFFFF"></path>\' +\n\t\t\t\t\t"</svg>",\n\t\t\t\tPIE: \'<svg class="image360_navPie" width="35px" height="35px" viewBox="0 0 35 35"><path fill-opacity="0.8" fill="#FFFFFF"></path></svg>\'\n\t\t\t},\n\t\t\tCLASS_NAME: "image360_navigation",\n\t\t\tPIE:  {\n\t\t\t\tCLASS_NAME: "image360_navPie"\n\t\t\t},\n\t\t\tDURATION: 600,\n\t\t\tBASE_ORIENTATION: {\n\t\t\t\tyaw: 0,\n\t\t\t\tpitch: 0,\n\t\t\t\tfieldOfView: 65\n\t\t\t}\n\t\t},\n\t\tFULLSCREEN: {\n\t\t\tHTML: {\n\t\t\t\tCLASS_NAME: "image360_pagefull",\n\t\t\t\tCONTAINER: \'<div class="image360_pagefull"></div>\',\n\t\t\t\tTOGGLE_BUTTON: \'<button class="image360_fs_toggle"></button>\'\n\t\t\t}\n\t\t}\n\t}\n}\n},{}],22:[function(_dereq_,module,exports){\nvar config = _dereq_("./config");\nvar screenfull = _dereq_("screenfull");\n\naddFullScreenEvent();\n\nvar fullScreenViewer = null;\nvar isFull = false;\nvar originalWrapper = null;\nvar viewerOption = isMobile() ? config.VIEWER.OPTION.MOBILE : config.VIEWER.OPTION.PC;\n\nfunction addFullScreenEvent() {\n\tif (isFullScreenAPIAvailable()) {\n\t\tdocument.addEventListener(screenfull.raw.fullscreenchange, function () {\n\t\t\tif (!screenfull.isFullscreen) {\n\t\t\t\texitFullScreen();\n\t\t\t} else {\n\t\t\t\tenterFullScreen();\n\t\t\t}\n\t\t});\n\t} else {\n\t\twindow.addEventListener("popstate", function() {\n\t\t\texitFullScreen();\n\t\t});\n\t}\n}\n\nfunction exitFullScreen() {\n\t// FullScreen API   fullscreen      .\n\tif (!fullScreenViewer) {\n\t\treturn;\n\t}\n\n\tif (!isFull) {\n\t\treturn;\n\t}\n\n\t_removeFullscreenHTML();\n\tvar viewer = fullScreenViewer;\n\n\tisFull = false;\n\tviewer.stopRender();\n\n\toriginalWrapper.appendChild(viewer.rootNode);\n\n\tvar option = viewerOption.EMBED;\n\tviewer.setControlMode(option.controlMode, option.allowPinchZoom);\n\tviewer.updateViewportDimensions();\n\tviewer.startRender();\n\n\t// in-contents   PC zoom  , mobile pinch 0 .\n\tvar lookAtOption = {\n\t\tfieldOfView: 65\n\t};\n\tvar duration = 0;\n\tif (isMobile()) {\n\t\tlookAtOption.pitch = 0;\n\t\tduration = 100;\n\t}\n\tviewer.lookAt(lookAtOption, duration);\n\n\tfullScreenViewer = null;\n}\n\nfunction enterFullScreen() {\n\t// FullScreen API   fullscreen      .\n\tif (!fullScreenViewer) {\n\t\treturn;\n\t}\n\n\tdocument.body.insertAdjacentHTML("beforeEnd", config.VIEWER.FULLSCREEN.HTML.CONTAINER);\n\t//  wrapper element  .\n\tvar fullscreenWrapper =\n\t\tdocument.body.getElementsByClassName(\n\t\t\tconfig.VIEWER.FULLSCREEN.HTML.CLASS_NAME\n\t\t)[0];\n\tvar viewer = fullScreenViewer;\n\n\tviewer.stopRender();\n\tfullscreenWrapper.appendChild(viewer.rootNode);\n\n\tvar option = viewerOption.FULLSCREEN;\n\tviewer.setControlMode(option.controlMode, option.allowPinchZoom);\n\tviewer.updateViewportDimensions();\n\tviewer.startRender();\n\n\t// PC      \n\tif (!isMobile()) {\n\t\t// exit  wrapper   remove  \n\t\t_addScrollZoom(fullscreenWrapper);\n\t}\n\n\tisFull = true;\n}\n\nfunction toggleFullScreen(originalWrap, viewer) {\n\tif (isFullScreenAPIAvailable()) {\n\t\tif (isFull) {\n\t\t\tscreenfull.exit();\n\t\t} else {\n\t\t\t// TODO:    ,\n\t\t\t//    FULL   , 360   Full       ?\n\t\t\toriginalWrapper = originalWrap;\n\t\t\tfullScreenViewer = viewer;\n\n\t\t\tscreenfull.request();\n\t\t}\n\t} else {\n\t\tif (isFull) {\n\t\t\t// [SMRTEDITOR-9193]    history back\n\t\t\t// window popstate  exit \n\t\t\twindow.history.back();\n\t\t} else {\n\t\t\toriginalWrapper = originalWrap;\n\t\t\tfullScreenViewer = viewer;\n\n\t\t\t// [SMRTEDITOR-9193]    history push\n\t\t\twindow.history.pushState({}, "");\n\n\t\t\tenterFullScreen();\n\t\t}\n\t}\n};\n\nfunction isFullScreen() {\n\treturn isFull;\n}\n\nfunction isMobile(){\n\tvar u = window.navigator.userAgent;\n\tvar f = function(s,h){\n\t\t\treturn ((h || "").indexOf(s) > -1);\n\t};\n\treturn (f("Mobile", u) || f("Android", u) || f("Nokia", u) || f("webOS", u) || f("Opera Mini", u) || f("BlackBerry", u) || (f("Windows", u) && f("PPC", u)) || f("Smartphone", u) || f("IEMobile", u) || f("iPad", u) || f("iPhone", u));\n}\n\nfunction isFullScreenAPIAvailable() {\n\tif (isMobile()) {\n\t\treturn false;\n\t}\n\treturn screenfull.enabled;\n}\n\nfunction _appendFullscreenHTML() {\n\tdocument.body.insertAdjacentHTML("beforeEnd", config.VIEWER.FULLSCREEN.HTML.CONTAINER);\n}\n\nfunction _removeFullscreenHTML() {\n\tvar fullscreenWrapper = document.getElementsByClassName(config.VIEWER.FULLSCREEN.HTML.CLASS_NAME)[0];\n\tfullscreenWrapper.parentNode.removeChild(fullscreenWrapper);\n}\n\nfunction _addScrollZoom(element) {\n\tif (!element) {\n\t\treturn;\n\t}\n\n\telement.addEventListener("mousewheel", _onScroll);\n\telement.addEventListener("DOMMouseScroll", _onScroll);\n}\n\nfunction _onScroll(e) {\n\te.preventDefault();\n\tvar delta = 0;\n\tif (e.detail) {\n\t\tdelta = e.detail * -40;\n\t} else {\n\t\tdelta = e.wheelDelta;\n\t}\n\n\tvar fov = _getCurrentViewerDirection(fullScreenViewer).verticalFov;\n\tfullScreenViewer.lookAt({\n\t\tfieldOfView: fov - delta / 10\n\t}, 100);\n}\n\nfunction _getCurrentViewerDirection(viewer) {\n\tvar orientation = viewer.getOrientation();\n\tvar verticalFov = viewer.getVerticalFieldOfView();\n\tvar horizontalFov = viewer.getHorizontalFieldOfView();\n\treturn {\n\t\tyaw: orientation.yaw,\n\t\tpitch: orientation.pitch,\n\t\tverticalFov: verticalFov,\n\t\thorizontalFov: horizontalFov\n\t};\n}\n\nmodule.exports = {\n\ttoggleFullScreen: toggleFullScreen,\n\tisFullScreen: isFullScreen\n};\n},{"./config":26,"screenfull":3}],23:[function(_dereq_,module,exports){\n/**\n * @fileoverview inherits\n * @author isaacs\n * @version 2.0.1\n */\n\n/* The ISC License\n\nCopyright (c) Isaac Z. Schlueter\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted, provided that the above\ncopyright notice and this permission notice appear in all copies.\n\nTHE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE. */\n\n\n\'use strict\';\nvar Config = _dereq_("./Config.js");\nvar Photo360Viewer = _dereq_("../Photo360Viewer.js");\nvar Navigator = _dereq_("./Navigator.js");\nvar Rotate = _dereq_("./Rotate.js");\nvar FullScreen = _dereq_("./FullScreen.js");\nvar ns = _dereq_("../eg.js");\nvar eg = ns.eg;\n\n/**\n * Component compatibility for below egjs 1.5\n */\nif (eg.Component && !eg.Component.prototype.once) {\n\teg.Component.prototype.once = function(eventName, listener) {\n\t\tvar onceListener = function() {\n\t\t\tlistener.apply(this, arguments);\n\t\t\tthis.off(eventName, onceListener);\n\t\t}.bind(this);\n\n\t\tthis.on(eventName, onceListener);\n\t};\n}\n\nvar consts = _dereq_("../consts");\n\nvar inherits = _dereq_("inherits");\nvar objectAssign = _dereq_(\'object-assign\');\n\ninherits(Image360Service, eg.Component);\n\n/**\n * @class\n * @name Image360Service\n * @extends eg.Component\n *\n * @param {HTMLElement} rootNode    \n * @param {Object} config -      \n * @param {String|Element} config.image - 360   url ,    img \n * @param {String} [config.projectionType=vertival_cubestrip] - 360    \n * @param {Function} [config.checkSupport] -      (      )\n */\nfunction Image360Service(rootNode, option) {\n\t// Super constructor\n\tImage360Service.super_.call(this);\n\tvar self = this;\n\tvar option = option;\n\n\tvar wrapperEl = rootNode;\n\tvar containerEl = wrapperEl.getElementsByClassName(Config.VIEWER.CLASS_NAME.CONTAINER)[0];\n\tcontainerEl.insertAdjacentHTML("beforeEnd", Config.VIEWER.BASE_HTML);\n\tvar fullscreenToggleBtn = wrapperEl.getElementsByClassName(Config.VIEWER.CLASS_NAME.FULLSCREEN_TOGGLE)[0];\n\tvar navEl = containerEl.getElementsByClassName(Config.VIEWER.NAVIGATION.CLASS_NAME)[0];\n \n\tvar photo360viewer = null;\n\tvar navigation = null;\n\n\tthis.destroy = function() {\n\t\t_unregisterResizeHandler();\n\n\t\tdocument.getElementsByClassName(Config.VIEWER.CLASS_NAME.FULLSCREEN_TOGGLE)[0].remove();\n\t\tdocument.getElementsByClassName(Config.VIEWER.CLASS_NAME.LOADING)[0].remove();\n\t\tdocument.getElementsByClassName(Config.VIEWER.CLASS_NAME.ICON)[0].remove();\n\t\tdocument.getElementsByClassName(Config.VIEWER.NAVIGATION.CLASS_NAME)[0].remove();\n\n\t\tphoto360viewer && photo360viewer.destroy();\n\t\tphoto360viewer = null;\n\t}\n\n\tfunction _resume() {\n\t\tif (photo360viewer === null) {\n\t\t\t_createPhoto360Viewer();\n\t\t}\n\n\t\tphoto360viewer.resume();\n\t}\n\n\t/**\n\t * Photo360Viewer  \n\t * @private\n\t */\n\tfunction _createPhoto360Viewer() {\n\t\tphoto360viewer = new Photo360Viewer(containerEl, option);\n\t\t_addViewerCallbacks();\n\t\t_attachEventHandlers();\n\t}\n\n\tfunction _attachEventHandlers() {\n\t\tfullscreenToggleBtn.addEventListener("click", function() {\t\n\t\t\tFullScreen.toggleFullScreen(wrapperEl, photo360viewer);\n\t\t});\n\t\tnavEl.addEventListener("click", function() {\n\t\t\tphoto360viewer.lookAt(\n\t\t\t\tConfig.VIEWER.NAVIGATION.BASE_ORIENTATION, \n\t\t\t\tConfig.VIEWER.NAVIGATION.DURATION\n\t\t\t);\n\t\t});\n\t}\n\n\tfunction _addViewerCallbacks() {\n\t\tvar beforeHook = {\n\t\t\t"init": function() {\n\t\t\t\t_initNavigation();\n\t\t\t},\n\t\t\t"resumestart": function() {\n\t\t\t\t_setLoading(true);\n\t\t\t},\n\t\t\t"resume": function() {\n\t\t\t\t_registerResizeHandler();\n\t\t\t\t_updateNavigation();\n\t\t\t\t_setLoading(false);\n\t\t\t\t// [SMRTEDITOR-8839] PC  canvas   \n\t\t\t},\n\t\t\t"suspend": function() {\n\t\t\t\t_unregisterResizeHandler();\n\t\t\t\t_setSuspend();\n\t\t\t},\n\t\t\t"error": function() {\n\t\t\t\t_setNotSupport();\n\t\t\t}\n\t\t}\n\n\t\tvar afterHook = {\n\t\t\t"viewportChange": function() {\n\t\t\t\t_updateNavigation();\n\t\t\t},\n\t\t}\n\n\t\tvar events = ["resumestart", "imageLoaded", "init", "resume", "suspend", "animationEnd", "viewportChange", "error"];\n\t\tevents.forEach(function(eventName) {\n\t\t\tphoto360viewer.on(eventName, function(e) {\n\t\t\t\tbeforeHook[eventName] && beforeHook[eventName]();\n\t\t\t\tif(eventName == "resume") {\n\t\t\t\t\te.eventType = "ready";\n\t\t\t\t\tself.trigger("ready", e);\n\t\t\t\t} else if(eventName == "error") {\n\t\t\t\t\tself.trigger(eventName, e);\n\t\t\t\t}\n\t\t\t\tafterHook[eventName] && afterHook[eventName]();\n\t\t\t});\n\t\t});\n\t}\n\n\tvar resizeHandler = debounce(function(e) {\n\t\tphoto360viewer.updateViewportDimensions();\n\t}, isIOS10_3_1() ? 400 : 100);\n\n\tfunction _registerResizeHandler() {\n\t\twindow.addEventListener("resize", resizeHandler);\n\t}\n\n\tfunction _unregisterResizeHandler() {\n\t\twindow.removeEventListener("resize", resizeHandler);\n\t}\n\n\tfunction _initNavigation() {\n\t\tvar state = _getCurrentViewerDirection();\n\t\tvar direction = state.yaw;\n\t\tvar fov = state.horizontalFov;\n\n\t\tnavigation = new Navigator(navEl);\n\t\tnavigation.render(direction, fov);\n\t}\n\n\tfunction _setLoading(makeLoading) {\n\t\tif (makeLoading) {\n\t\t\t_removeAddClass("is-ready is-notSupport is-default", "is-loading");\n\t\t} else {\n\t\t\t_removeAddClass("is-loading is-notSupport is-default", "is-ready");\n\t\t}\n\t}\n\n\tfunction _setSuspend() {\n\t\t_removeAddClass("is-loading is-notSupport is-ready", "is-default");\n\t}\n\n\tfunction _setNotSupport() {\n\t\t_removeAddClass("is-loading is-default is-ready", "is-notSupport");\n\t}\n\n\tfunction _removeAddClass(removeClass, addClass) {\n\t\t_classListRemove(containerEl, removeClass);\n\t\tcontainerEl.classList.add(addClass);\n\t}\n\n\tfunction _classListRemove(element, classes) {\n\t\tvar classList = classes.split(" ");\n\t\tvar classListLength = classList.length;\n\t\tfor (var i = 0; i < classListLength; i++) {\n\t\t\telement.classList.remove(classList[i]);\n\t\t}\n\t};\n\n\t/**\n\t *      \n\t */\n\tfunction _updateNavigation() {\n\t\tif (photo360viewer && navigation) {\n\t\t\tvar currentDirection = _getCurrentViewerDirection();\n\t\t\tvar yaw = currentDirection.yaw;\n\t\t\tvar horizontalFov = currentDirection.horizontalFov;\n\n\t\t\tnavigation.render(yaw * -1, horizontalFov);\n\t\t}\n\t}\n\n\n\t/**\n\t *      \n\t * @returns {{yaw: Number, pitch: Number, verticalFov: Number, horizontalFov: Number}}\n\t * @private\n\t */\n\tfunction _getCurrentViewerDirection() {\n\t\tvar orientation = photo360viewer.getOrientation();\n\t\tvar verticalFov = photo360viewer.getVerticalFieldOfView();\n\t\tvar horizontalFov = photo360viewer.getHorizontalFieldOfView();\n\t\treturn {\n\t\t\tyaw: orientation.yaw,\n\t\t\tpitch: orientation.pitch,\n\t\t\tverticalFov: verticalFov,\n\t\t\thorizontalFov: horizontalFov\n\t\t};\n\t}\n\n\t_resume();\n\n\treturn this;\n}\n\nfunction isIOS10_3_1() {\n\tvar ua = navigator.userAgent;\n\tvar osVersionRegex =\n\t\tnew RegExp(\n\t\t\t\'(iPhone OS)\\\\s([\\\\d_\\\\.]+|\\\\d_0)\',\n\t\t\t"i"\n\t\t);\n\n\tvar osVersionRegexResult = osVersionRegex.exec(ua);\n\t\n\tif(!osVersionRegexResult) return false;\n\n\tvar osVersion = osVersionRegexResult[2].replace(/_/g, ".").replace(/;|\\)/g, "");\n\n\treturn /(iPad|iPhone|iPod)/g.test(ua) && osVersion === "10.3.1";\n};\n\nfunction debounce(func, wait, immediate) {\n\tvar timeout;\n\treturn function() {\n\t\tvar context = this;\n\t\tvar args = arguments;\n\t\tvar later = function() {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) {\n\t\t\t\tfunc.apply(context, args);\n\t\t\t}\n\t\t};\n\t\tvar callNow = immediate && !timeout;\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\t\tif (callNow) {\n\t\t\tfunc.apply(context, args);\n\t\t}\n\t};\n}\n\n/**\n *     \n * @method Image360Service#isSupported\n * @retuen {Boolean} isSupported\n */\nImage360Service.isSupported = function() {\n\treturn Photo360Viewer.isSupported();\n};\n\nImage360Service.ERROR_TYPE = objectAssign({}, consts.ERROR_TYPE);\n\nImage360Service.VERSION = "1.2.4";\n\neg.Image360Service = Image360Service;\nwindow.Image360Service = Image360Service; // VER 1.1.2< compatibility\nmodule.exports = Image360Service;\n},{"../Photo360Viewer.js":11,"../consts":14,"../eg.js":19,"./Config.js":21,"./FullScreen.js":22,"./Navigator.js":24,"./Rotate.js":25,"inherits":1,"object-assign":2}],24:[function(_dereq_,module,exports){\nvar Config = _dereq_("./Config.js");\n\nfunction Navigator(element, state) {\t\n\telement.insertAdjacentHTML("beforeend", Config.VIEWER.NAVIGATION.HTML.FRAME);\n\telement.insertAdjacentHTML("beforeend", Config.VIEWER.NAVIGATION.HTML.PIE);\n\tvar pieEl = element.getElementsByClassName(Config.VIEWER.NAVIGATION.PIE.CLASS_NAME)[0];\n\tvar piePathEl = pieEl.getElementsByTagName("path")[0];\n\n\tvar navSize = Config.VIEWER.NAVIGATION.NAV_SIZE;\n\n\tsetPieStyle({"position": "absolute", "top": 0, "left": 0});\n\tsetPathAttr("transform", "translate(" + navSize / 2 + ", " + navSize / 2 + ")");\n\n\tfunction render(direction, fov) {\n\t\tvar radius = Config.VIEWER.NAVIGATION.PIE_RADIUS;\n\t\tvar r = (fov * Math.PI / 180);\n\t\tvar x = Math.sin(r) * radius;\n\t\tvar y = Math.cos(r) * radius * (-1);\n\t\tvar mid = (fov > 180) ? 1 : 0;\n\t\tvar anim = "M 0 0 v -" + radius + " A " + radius + " " + radius + " 1 " + mid + " 1 " + x + " " + y + " z";\n\n\t\tsetPathAttr("d", anim);\n\t\tsetPieStyle({transform: "rotateZ(" + (direction - fov / 2) + "deg)"});\n\t}\n\n\tfunction setPieStyle(style) {\n\t\tfor (var prop in style) {\n\t\t\tpieEl.style[prop] = style[prop];\n\t\t}\n\t}\n\n\tfunction setPathAttr(key, value) {\n\t\tpiePathEl.setAttribute(key, value);\n\t}\n\n\treturn {\n\t\trender: render\n\t};\n}\n\nmodule.exports = Navigator;\n},{"./Config.js":21}],25:[function(_dereq_,module,exports){\n/**\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n\n/**\n * Tiny custom rotate event binder\n *\n * @ko    rotate   \n * @name eg#rotate\n * @event\n * @param {Event} e Native event object<ko>  </ko>\n * @param {Object} info The object of data to be sent when the event is fired<ko>     </ko>\n * @param {Boolean} info.isVertical The orientation of the device (true: portrait, false: landscape) <ko>  (true:  , false:  )</ko>\n * @support { "ios" : "7+", "an" : "2.1+ (except 3.x)"}\n * @example\n * // bind\n * eg.rotate.on(function(e, info){\n *      info.isVertical;\n * });\n * // unbind\n * eg.rotate.off();\n */\nvar beforeScreenWidth = -1;\nvar beforeVertical = null;\nvar USER_LISTENERS = [];   // user\'s event listener\n\nvar agent = (function() {\n    var ua = window.navigator.userAgent;\n    var match = ua.match(/(iPhone OS|CPU OS|Android)\\s([^\\s;-]+)/);  // fetch Android & iOS env only\n    var res = {\n        os: "",\n        version: ""\n    };\n\n    if (match) {\n        res.os = match[1].replace(/(?:CPU|iPhone)\\sOS/, "ios").toLowerCase();\n        res.version = match[2].replace(/\\D/g, ".");\n    }\n\n    return res;\n})();\n\nvar isMobile = /android|ios/.test(agent.os);\n\n// if (!isMobile) {\n//     return undefined;\n// }\n\n/**\n * Return event name string for orientationChange according browser support\n */\nvar ORIENTATION_CHANGE_EVENT = (function() {\n    var type;\n\n    /**\n     * Some platform/broswer returns previous widht/height state value. For workaround, give some delays.\n     *\n     * Android bug:\n     * - Andorid 2.3 - Has orientationchange with bug. Needs 500ms delay.\n     *\n     *   Note: Samsung\'s branded Android 2.3\n     *   When check orientationchange using resize event, could cause browser crash if user binds resize event on window\n     *\n     * - Android 2.2 - orientationchange fires twice(at first time width/height are not updated, but second returns well)\n     * - Lower than 2.2 - use resize event\n     *\n     * InApp bug:\n     * - Set 200ms delay\n     */\n    if ((agent.os === "android" && agent.version === "2.1")) {\n        type = "resize";\n    } else {\n        type = "onorientationchange" in window ? "orientationchange" : "resize";\n    }\n\n    return type;\n})();\n\n/**\n * When viewport orientation is portrait, return true otherwise false\n */\nfunction isVertical() {\n    var screenWidth;\n    var degree;\n    var vertical;\n\n    if (ORIENTATION_CHANGE_EVENT === "resize") {\n        screenWidth = document.documentElement.clientWidth;\n\n        if (beforeScreenWidth === -1) { // first call isVertical\n            vertical = screenWidth < document.documentElement.clientHeight;\n        } else {\n            if (screenWidth < beforeScreenWidth) {\n                vertical = true;\n            } else if (screenWidth === beforeScreenWidth) {\n                vertical = beforeVertical;\n            } else {\n                vertical = false;\n            }\n        }\n    } else {\n        degree = window.orientation;\n\n        if (degree === 0 || degree === 180) {\n            vertical = true;\n        } else if (degree === 90 || degree === -90) {\n            vertical = false;\n        }\n    }\n    return vertical;\n}\n\n/**\n * Trigger rotate event\n */\nfunction triggerRotate(e) {\n    var currentVertical = isVertical();\n\n    if (isMobile) {\n        if (beforeVertical !== currentVertical) {\n            beforeVertical = currentVertical;\n            beforeScreenWidth = document.documentElement.clientWidth;\n\n            USER_LISTENERS.forEach(function(v) { \n                return v(e, {\n                    isVertical: beforeVertical\n                });\n            });\n        }\n    }\n}\n\n/**\n * Trigger event handler\n */\nfunction handler(e) {\n    var rotateTimer = null;\n\n    if (ORIENTATION_CHANGE_EVENT === "resize") {\n        window.setTimeout(function() {return triggerRotate(e)}, 0);\n    } else {\n        if (agent.os === "android") {\n            var screenWidth = document.documentElement.clientWidth;\n\n            if (e.type === "orientationchange" && screenWidth === beforeScreenWidth) {\n                window.setTimeout(function() {return handler(e)}, 500);\n\n                // When width value wasn\'t changed after firing orientationchange, then call handler again after 300ms.\n                return false;\n            }\n        }\n\n        rotateTimer && window.clearTimeout(rotateTimer);\n        rotateTimer = window.setTimeout(function() {return  triggerRotate(e)}, 300);\n    }\n\n    return undefined;\n}\n\nmodule.exports = {\n    /**\n     * Bind rotate event\n     * @param {Function} listener listener function\n     */\n    on: function(listener) {\n        if (typeof(listener) !== "function") {\n            return;\n        }\n\n        beforeVertical = isVertical();\n        beforeScreenWidth = document.documentElement.clientWidth;\n        USER_LISTENERS.push(listener);\n\n        // only attach once\n        USER_LISTENERS.length === 1 &&\n            window.addEventListener(ORIENTATION_CHANGE_EVENT, handler);\n    },\n\n    /**\n     * Unbind rotate event\n     * Without param, will unbind all binded listeners\n     * @param {Function} [listener] listener function\n     */\n    off: function(listener) {\n        if (typeof(listener) === "function") {\n            // remove given listener from list\n            for (var i = 0, el; (el = USER_LISTENERS[i]); i++) {\n                if (el === listener) {\n                    USER_LISTENERS.splice(i, 1);\n                    break;\n                }\n            }\n        }\n\n        // detach when the condition is met\n        if (!listener || USER_LISTENERS.length === 0) {\n            USER_LISTENERS.splice(0);\n            window.removeEventListener(ORIENTATION_CHANGE_EVENT, handler);\n        }\n    },\n\n    /**\n     * Native event name used to detect rotate\n     */\n    orientationChange: ORIENTATION_CHANGE_EVENT,\n\n    /**\n     * Get device is in vertical mode\n     * @return {Boolean)\n     */\n    isVertical: isVertical,\n\n    /**\n     * Trigger rotate event\n     */\n    triggerRotate: triggerRotate,\n\n    /**\n     * Event handler function\n     */\n    handler: handler\n};\n\n},{}],26:[function(_dereq_,module,exports){\narguments[4][21][0].apply(exports,arguments)\n},{"dup":21}],27:[function(_dereq_,module,exports){\n/**\n * @fileoverview gl-matrix - High performance matrix and vector operations\n * @author Brandon Jones\n * @author Colin MacKenzie IV\n * @version 2.3.2\n */\n\n/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\n// Some minimal math functionality borrowed from gl-Matrix and stripped down\n// for the purposes of this library.\nvar vec3 = _dereq_("./mathUtil/vec3.js");\nvar glMatrix = _dereq_("./mathUtil/common.js");\nvar quat = _dereq_("./mathUtil/quat.js");\n\nfunction quatToVec3(quaternion) {\n\tvar baseV = vec3.fromValues(0,0,1);\n\tvec3.transformQuat(baseV, baseV, quaternion);\n\treturn baseV;\n}\n\nvar util = {};\nutil.isPowerOfTwo = function (n) {\n\tif (typeof n !== \'number\') \n    \treturn \'Not a number\';\n    return n && (n & (n - 1)) === 0;\n};\n\nutil.extractYawFromQuat = function (quaternion) {\n\tvar baseV = quatToVec3(quaternion);\n\treturn 1 * Math.atan2(baseV[0], baseV[2]);\n};\n\nutil.extractPitchFromQuat =  function (quaternion) {\n\tvar baseV = quatToVec3(quaternion);\n\treturn -1 * Math.atan2(\n\t\tbaseV[1],\n\t\tMath.sqrt(Math.pow(baseV[0], 2) + Math.pow(baseV[2], 2))\n\t);\t\t\n};\n\nutil.getQuaternionWithYawPitch = function (yaw, pitch) {\n\tvar q = quat.create();\n\tquat.rotateY(q, q, glMatrix.toRadian(yaw));\n\tquat.rotateX(q, q, glMatrix.toRadian(pitch));\n\treturn q;\t\n};\n\nutil.quatToYawPitch = function (quaternion) {\n\treturn {\n\t\tyaw: glMatrix.toDegree(util.extractYawFromQuat(quaternion)), \n\t\tpitch: glMatrix.toDegree(util.extractPitchFromQuat(quaternion))\n\t};\n};\n\nutil.yawPitchToPoint = function (yaw, pitch) { // rad, rad\n\treturn [\n\t\tMath.tan(yaw) /  Math.cos(pitch),\n\t\tMath.tan(pitch),\n\t];\n};\n\nexports.util = util;\nexports.glMatrix = _dereq_("./mathUtil/common.js");\nexports.mat4 = _dereq_("./mathUtil/mat4.js");\nexports.quat = _dereq_("./mathUtil/quat.js");\nexports.vec3 = _dereq_("./mathUtil/vec3.js");\n\n},{"./mathUtil/common.js":28,"./mathUtil/mat4.js":29,"./mathUtil/quat.js":30,"./mathUtil/vec3.js":31}],28:[function(_dereq_,module,exports){\nvar glMatrix = {};\n\nglMatrix.ARRAY_TYPE = (typeof Float32Array !== \'undefined\') ? Float32Array : Array;\n\nvar degree = Math.PI / 180;\n\nglMatrix.toRadian = function(a){\n     return a * degree;\n}\n\nglMatrix.toDegree = function(a){\n     return a / degree;\n}\n\nmodule.exports = glMatrix;\n},{}],29:[function(_dereq_,module,exports){\nvar glMatrix = _dereq_("./common.js");\n\n/**\n * @class 4x4 Matrix\n * @name mat4\n */\nvar mat4 = {};\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nmat4.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(16);\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n};\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nmat4.identity = function(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the X axis not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.rotateX = function (out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\n        out[0]  = a[0];\n        out[1]  = a[1];\n        out[2]  = a[2];\n        out[3]  = a[3];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    out[4] = a10 * c + a20 * s;\n    out[5] = a11 * c + a21 * s;\n    out[6] = a12 * c + a22 * s;\n    out[7] = a13 * c + a23 * s;\n    out[8] = a20 * c - a10 * s;\n    out[9] = a21 * c - a11 * s;\n    out[10] = a22 * c - a12 * s;\n    out[11] = a23 * c - a13 * s;\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the Y axis not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.rotateY = function (out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\n        out[4]  = a[4];\n        out[5]  = a[5];\n        out[6]  = a[6];\n        out[7]  = a[7];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    out[0] = a00 * c - a20 * s;\n    out[1] = a01 * c - a21 * s;\n    out[2] = a02 * c - a22 * s;\n    out[3] = a03 * c - a23 * s;\n    out[8] = a00 * s + a20 * c;\n    out[9] = a01 * s + a21 * c;\n    out[10] = a02 * s + a22 * c;\n    out[11] = a03 * s + a23 * c;\n    return out;\n};\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nmat4.fromQuat = function (out, q) {\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        yx = y * x2,\n        yy = y * y2,\n        zx = z * x2,\n        zy = z * y2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    out[0] = 1 - yy - zz;\n    out[1] = yx + wz;\n    out[2] = zx - wy;\n    out[3] = 0;\n\n    out[4] = yx - wz;\n    out[5] = 1 - xx - zz;\n    out[6] = zy + wx;\n    out[7] = 0;\n\n    out[8] = zx + wy;\n    out[9] = zy - wx;\n    out[10] = 1 - xx - yy;\n    out[11] = 0;\n\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n\n    return out;\n};\n\n/**\n * Generates a perspective projection matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nmat4.perspective = function (out, fovy, aspect, near, far) {\n    var f = 1.0 / Math.tan(fovy / 2),\n        nf = 1 / (near - far);\n    out[0] = f / aspect;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = f;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = (far + near) * nf;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = (2 * far * near) * nf;\n    out[15] = 0;\n    return out;\n};\n\nmodule.exports = mat4;\n\n},{"./common.js":28}],30:[function(_dereq_,module,exports){\nvar glMatrix = _dereq_("./common.js");\n\n/**\n * @class Quaternion\n * @name quat\n */\nvar quat = {};\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\nquat.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    return out;\n};\n\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {quat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\nquat.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\nquat.fromValues = function(x, y, z, w) {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    out[3] = w;\n    return out;\n};;\n\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the source quaternion\n * @returns {quat} out\n * @function\n */\nquat.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Multiplies two quat\'s\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @returns {quat} out\n */\nquat.multiply = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        bx = b[0], by = b[1], bz = b[2], bw = b[3];\n\n    out[0] = ax * bw + aw * bx + ay * bz - az * by;\n    out[1] = ay * bw + aw * by + az * bx - ax * bz;\n    out[2] = az * bw + aw * bz + ax * by - ay * bx;\n    out[3] = aw * bw - ax * bx - ay * by - az * bz;\n    return out;\n};\n\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {quat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nquat.rotateX = function (out, a, rad) {\n    rad *= 0.5; \n\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        bx = Math.sin(rad), bw = Math.cos(rad);\n\n    out[0] = ax * bw + aw * bx;\n    out[1] = ay * bw + az * bx;\n    out[2] = az * bw - ay * bx;\n    out[3] = aw * bw - ax * bx;\n    return out;\n};\n\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {quat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nquat.rotateY = function (out, a, rad) {\n    rad *= 0.5; \n\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        by = Math.sin(rad), bw = Math.cos(rad);\n\n    out[0] = ax * bw - az * by;\n    out[1] = ay * bw + aw * by;\n    out[2] = az * bw + ax * by;\n    out[3] = aw * bw - ay * by;\n    return out;\n};\n\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a quat to calculate conjugate of\n * @returns {quat} out\n */\nquat.conjugate = function (out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\nquat.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2],\n        w = a[3];\n    var len = x*x + y*y + z*z + w*w;\n    if (len > 0) {\n        len = 1 / Math.sqrt(len);\n        out[0] = x * len;\n        out[1] = y * len;\n        out[2] = z * len;\n        out[3] = w * len;\n    }\n    return out;\n};\n\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {quat} a The first quaternion.\n * @param {quat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nquat.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n};\n\nmodule.exports = quat;\n\n},{"./common.js":28}],31:[function(_dereq_,module,exports){\nvar glMatrix = _dereq_("./common.js");\n\n/**\n * @class 3 Dimensional Vector\n * @name vec3\n */\nvar vec3 = {};\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nvec3.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nvec3.fromValues = function(x, y, z) {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\nvec3.set = function(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\nvec3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nvec3.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n};\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec3.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nvec3.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    var len = x*x + y*y + z*z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec3\'s\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n/**\n * Computes the cross product of two vec3\'s\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.cross = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nvec3.transformQuat = function(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return out;\n};\n\nmodule.exports = vec3;\n\n},{"./common.js":28}]},{},[23]);\n'},function(t,n){t.exports='<div class="api_common_viewer animation" style="display:none;z-index:19999;">\n    <div class="scroll_wrap">\n        \x3c!--    --\x3e\n        <div class="flick_view">\n            <div style="width:100%;height:100%;">\n                <div class="panzoom"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"></div>\n            </div>\n            <div style="width:100%;height:100%;">\n                <div class="panzoom"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"></div>\n            </div>\n            <div style="width:100%;height:100%;">\n                <div class="panzoom"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"></div>\n            </div>\n        </div>\n\n        <div class="image360_wrapper" style="width:100%;height:100%">\n            <div class="image360_container is-default image360_preview"></div>\n        </div>\n\n        \x3c!-- VR  --\x3e\n        <button class="btn_view_360 _vr-toggle" style="display:none;z-index:2001"><span class="blind">360VR  </span></button>\n\n        \x3c!--   --\x3e\n        <a href="#" class="btn_view_video" style="display:none;z-index:2001;pointer-events:none"><span class="blind"> </span></a>\n\n        \x3c!-- /   --\x3e\n        <div class="btn_area" style="touch-action:none">\n            <a href="#" class="btn btn_prev"><span class="spcv"> </span></a>\n            <a href="#" class="btn btn_next"><span class="spcv"> </span></a>\n        </div>\n        <div class="group_info" style="touch-action:none">\n            \x3c!--    --\x3e\n            <div class="header_info">\n                <a href="#" class="go_total"><span class="spcv"></span></a>\n            </div>\n\n            <div class="content_info">\n                <div class="view_notice" style="display:none">\n                    <span class="notice_txt"></span>\n                </div>\n\n                \x3c!--    --\x3e\n                <div class="view_basic">\n\n                    \x3c!--   --\x3e\n                    <a href="#" class="btn_more _toolbar-toggle" data-type="task">\n                        <span class="spcv ico_more">  </span>\n                    </a>\n\n                    \x3c!--  _  --\x3e\n                    <a href="#" class="view_desc">\n                        <span class="txt_etc _etc"></span>\n                        <span class="tit"></span>\n                        <span class="desc"></span>\n                        <span class="detail">\n                            <span class="txt _source"></span>\n                            <span class="txt _dimension"><span class="_width"></span>&times;<span class="_height"></span></span>\n                            <time class="txt _timestamp"></time>\n                        </span>\n                    </a>\n\n                    \x3c!--  _    --\x3e\n                    <div class="view_desc" style="display:none">\n                        <span class="txt_etc _etc"></span>\n                        <span class="tit"></span>\n                        <span class="desc"></span>\n                        <span class="detail">\n                            <span class="txt _source"></span>\n                            <span class="txt _dimension"><span class="_width"></span>&times;<span class="_height"></span></span>\n                            <time class="txt _timestamp"></time>\n                        </span>\n                    </div>\n                </div>\n\n                \x3c!--    --\x3e\n                <div class="view_function _toobar-hide">\n                    <div class="function_list">\n                        <a href="#" class="item _like" style="display:none"><span class="like_box"><span class="spcv ico like"></span><em class="blind"></em><span class="num _count">0</span></span></a>\n                        <a href="#" class="item _social spcv_af share naver-splugin" style="display:none"></a>\n                        <a href="#" class="item _original"><span class="spcv ico original"> </span></a>\n                        <a href="#" class="item _toolbar-toggle" data-type="details"><span class="spcv ico close"> </span></a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(t,n){t.exports=function(t){function n(t){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",t)}try{"undefined"!=typeof execScript&&function(){return"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener}()?execScript(t):"undefined"!=typeof eval?eval.call(null,t):n("EvalError: No eval function available")}catch(t){n(t)}}},function(t,n,e){e(30)(e(28))},function(t,n,e){var i=e(22);"string"==typeof i&&(i=[[t.i,i,""]]);e(4)(i,{});i.locals&&(t.exports=i.locals)},function(t,n,e){var i=e(23);"string"==typeof i&&(i=[[t.i,i,""]]);e(4)(i,{});i.locals&&(t.exports=i.locals)},function(t,n,e){t.exports=e(6)}])});